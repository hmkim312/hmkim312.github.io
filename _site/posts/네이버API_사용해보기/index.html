<!DOCTYPE html><html lang="ko" mode="light" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Naver API 사용해보기 | Data Include Me</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="Naver API 사용해보기" /><meta name="author" content="HyunMin Kim" /><meta property="og:locale" content="ko" /><meta name="description" content="1. Naver API 1.1 API API : Application Programming Interface 네이버, 페이스북, 구글 등 IT 거대 기업들과 같은 많은 SW관련 회사들이 자사 서비스와 관련한 API를 제공함 웹 크롤링에 대한 법적 문제가 대두되고 있는 상황에 따라 해당 회사에서 제공하는 API를 사용하는것이 바람직 할수 있다 우리는 점점 API의 사용에 익숙해 질 필요가 있다" /><meta property="og:description" content="1. Naver API 1.1 API API : Application Programming Interface 네이버, 페이스북, 구글 등 IT 거대 기업들과 같은 많은 SW관련 회사들이 자사 서비스와 관련한 API를 제공함 웹 크롤링에 대한 법적 문제가 대두되고 있는 상황에 따라 해당 회사에서 제공하는 API를 사용하는것이 바람직 할수 있다 우리는 점점 API의 사용에 익숙해 질 필요가 있다" /><link rel="canonical" href="https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/" /><meta property="og:url" content="https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/" /><meta property="og:site_name" content="Data Include Me" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-15T09:10:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Naver API 사용해보기" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@HyunMin Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HyunMin Kim"},"dateModified":"2020-10-15T09:10:00+09:00","datePublished":"2020-10-15T09:10:00+09:00","description":"1. Naver API 1.1 API API : Application Programming Interface 네이버, 페이스북, 구글 등 IT 거대 기업들과 같은 많은 SW관련 회사들이 자사 서비스와 관련한 API를 제공함 웹 크롤링에 대한 법적 문제가 대두되고 있는 상황에 따라 해당 회사에서 제공하는 API를 사용하는것이 바람직 할수 있다 우리는 점점 API의 사용에 익숙해 질 필요가 있다","headline":"Naver API 사용해보기","mainEntityOfPage":{"@type":"WebPage","@id":"https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/"},"url":"https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/"}</script><meta property="og:image" content="https://datainclude.me/assets/img/sample/avatar.jpg" /> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="36x36" href="/assets/img/favicons/android-icon-36x36.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicons/android-icon-48x48.png"><link rel="icon" type="image/png" sizes="72x72" href="/assets/img/favicons/android-icon-72x72.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/android-icon-96x96.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/android-icon-144x144.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="70x70" href="/assets/img/favicons/ms-icon-70x70.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/ms-icon-144x144.png"><link rel="icon" type="image/png" sizes="150x150" href="/assets/img/favicons/ms-icon-150x150.png"><link rel="icon" type="image/png" sizes="310x310" href="/assets/img/favicons/ms-icon-310x310.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-MW9VRMW9" as="script"> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MW9VRMW9');</script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> </noscript> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9VRMW9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Data Include Me</a></div><div class="site-subtitle font-italic">Data Science Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hmkim312" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sanarial312','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Naver API 사용해보기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <script type="text/javascript"> var lazyloadads = false; function loadAds() { if (!lazyloadads) { var script = document.createElement("script"); script.type = "text/javascript"; script.async = true; script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7594406644928408"; document.body.appendChild(script); lazyloadads = true; } } window.addEventListener("mousemove", loadAds, { once: true }); window.addEventListener('touchstart', loadAds, { once: true }); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Naver API 사용해보기</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Oct 15, 2020, 9:10 AM +0900" > Oct 15, 2020 <i class="unloaded">2020-10-15T09:10:00+09:00</i> </span> by <span class="author"> HyunMin Kim </span></div><a href="https://hits.seeyoufarm.com"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/%2F&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="페이지 조회수 뱃지", width: 100%;, height: 100%;/> </a></div><div class="post-content"><h2 id="1-naver-api">1. Naver API</h2><hr /><h3 id="11-api">1.1 API</h3><ul><li>API : Application Programming Interface</li><li>네이버, 페이스북, 구글 등 IT 거대 기업들과 같은 많은 SW관련 회사들이 자사 서비스와 관련한 API를 제공함</li><li>웹 크롤링에 대한 법적 문제가 대두되고 있는 상황에 따라 해당 회사에서 제공하는 API를 사용하는것이 바람직 할수 있다</li><li>우리는 점점 API의 사용에 익숙해 질 필요가 있다</li></ul><p><br /></p><h3 id="12-naver-개발자-센터">1.2 Naver 개발자 센터</h3><ul><li><a href="https://developers.naver.com/main/" target="_blank">https://developers.naver.com/main/</a></li><li>네이버 로그인 후 위 링크에서 서비스 API 클릭</li><li>데이터랩 -&gt; Open API 이용 신청</li><li>애플리케이션 이름은 편한대로 등록</li><li>사용 API는 사용할것 등록(검색어트랜드, 쇼핑인사이트 등)</li><li>Web설정은 http://locallhost 로 한 후 등록 (웹사이트가 없으므로)</li><li>내 애플리케이션에서 애플리케이션 정보(Client ID, Client Secreat) 를 잘 보관해야함(API를 받을때 사용함)</li><li>일일 사용량은 정해져 있음</li></ul><p><br /></p><h3 id="13-네이버-블로그-api-호출">1.3 네이버 블로그 API 호출</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">urllib.request</span>

<span class="n">client_id</span> <span class="o">=</span> <span class="s">'Your client_id'</span> <span class="c1"># Your client_id
</span><span class="n">client_secret</span> <span class="o">=</span> <span class="s">'Your client_secret'</span> <span class="c1"># Your client_secret
</span><span class="n">encText</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">'파이썬'</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://openapi.naver.com/v1/search/blog?query="</span> <span class="o">+</span> <span class="n">encText</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">"X-Naver-Client-Id"</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">"X-Naver-Client-Secret"</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>{
"lastBuildDate": "Thu, 15 Oct 2020 15:11:16 +0900",
"total": 176910,
"start": 1,
"display": 10,
"items": [
{
"title": "&lt;b&gt;파이썬&lt;/b&gt;(Phython)이 스타트업에게 인기있는 이유 7가지",
"link": "http://blog.wishket.com/%ED%8C%8C%EC%9D%B4%EC%8D%ACpython%EC%9D%B4-%EC%8A%A4%ED%83%80%ED%8A%B8%EC%97%85%EC%97%90%EA%B2%8C-%EC%9D%B8%EA%B8%B0%EC%9E%88%EB%8A%94-%EC%9D%B4%EC%9C%A0-7%EA%B0%80%EC%A7%80/",
"description": "&lt;b&gt;파이썬&lt;/b&gt;(Python)이 스타트업에게 인기있는 이유 7가지 Facebook Twitter 안녕하세요. 위시켓입니다.... 그렇기 때문에 &lt;b&gt;파이썬&lt;/b&gt;(Python)과 같은 강력하면서도 기반이 튼튼한 기술을 사용하는 것이 가장 좋습니다.... ",
"bloggername": "그린 클라이언트 – Wishket",
"bloggerlink": "http://blog.wishket.com/",
"postdate": "20200831"

},
{
"title": "&lt;b&gt;파이썬&lt;/b&gt; 학원 확연히 다른 스킬 강좌!",
"link": "https:\/\/blog.naver.com\/hmiya00?Redirect=Log&amp;logNo=222114719683",
"description": "오늘은 &lt;b&gt;파이썬&lt;/b&gt; 학원을 소개해 드릴까 합니다. 저는 어렸을 때부터 기계나 컴퓨터에 관심이 많았어요.... 다행히 제가 다녔던 &lt;b&gt;파이썬&lt;/b&gt; 학원은 국비 지원을 통해 금전적인 부담을 조금 덜고 수업을 들을 수 있어서... ",
"bloggername": "한시라도 빨리 떠나시게",
"bloggerlink": "https://blog.naver.com/hmiya00",
"postdate": "20201013"
}
...
]
}
</pre></table></code></div></div><ul><li>url : 네이버 블로그 검색 결과를 가져오는 주소</li><li>urllib : http 프로토콜에 따라서 서버의 요청/응답을 처리하기 위한 모듈</li><li>urllib.request : 클라이언트의 요청을 처리하는 모듈</li><li>urllib.parse : url 주소에 대한 분석</li><li>print(response.read().decode(‘utf-8’)) : 검색 결과 출력, decode를 utf-8로 해야함</li></ul><p><br /></p><h3 id="14-에러코드-확인">1.4 에러코드 확인</h3><ul><li>에러코드 SE01 : 검색 API 요청에 오류가 있음</li><li>에러코드 SE06 : 검색어를 UTF-8로 인코딩</li></ul><p><br /></p><h2 id="2-api-실습">2. API 실습</h2><hr /><h3 id="21-네이버-책-api">2.1 네이버 책 API</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">encText</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">'머신러닝'</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'https://openapi.naver.com/v1/search/book?query='</span> <span class="o">+</span> <span class="n">encText</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Id'</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Secret'</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>{
"lastBuildDate": "Thu, 15 Oct 2020 15:27:12 +0900",
"total": 1046,
"start": 1,
"display": 10,
"items": [
{
"title": "핸즈온 &lt;b&gt;머신러닝&lt;/b&gt;(2판) (사이킷런, 케라스, 텐서플로 2를 활용한 &lt;b&gt;머신러닝&lt;/b&gt;, 딥러닝 완벽 실무)",
"link": "http://book.naver.com/bookdb/book_detail.php?bid=16328592",
"image": "https://bookthumb-phinf.pstatic.net/cover/163/285/16328592.jpg?type=m1&amp;udate=20201005",
"author": "오렐리앙 제롱",
"price": "55000",
"discount": "49500",
"publisher": "한빛미디어",
"pubdate": "20200504",
"isbn": "1162242965 9791162242964",
"description": "컬러판으로 돌아온 아마존 인공지능 분야 부동의 1위 도서\n이 책은 지능형 시스템을 구축하려면 반드시 알아야 할 &lt;b&gt;머신러닝&lt;/b&gt;, 딥러닝 분야 핵심 개념과 이론을 이해하기 쉽게 설명한다. 사이킷런, 케라스, 텐서플로를 이용해 실전에서 바로 활용 가능한 예제로 모델을 훈련하고 신경망을 구축하는 방법을... "

},
{
"title": "파이썬 &lt;b&gt;머신러닝&lt;/b&gt; 완벽 가이드 (다양한 캐글 예제와 함께 기초 알고리즘부터 최신 기법까지 배우는)",
"link": "http://book.naver.com/bookdb/book_detail.php?bid=16238302",
"image": "https://bookthumb-phinf.pstatic.net/cover/162/383/16238302.jpg?type=m1&amp;udate=20200423",
"author": "권철민",
"price": "38000",
"discount": "34200",
"publisher": "위키북스",
"pubdate": "20200207",
"isbn": "1158391927 9791158391928",
"description": "자세한 이론 설명과 파이썬 실습을 통해 &lt;b&gt;머신러닝&lt;/b&gt;을 완벽하게 배울 수 있습니다!《파이썬 &lt;b&gt;머신러닝&lt;/b&gt; 완벽 가이드》는 이론 위주의 &lt;b&gt;머신러닝&lt;/b&gt; 책에서 탈피해 다양한 실전 예제를 직접 구현해 보면서 &lt;b&gt;머신러닝&lt;/b&gt;을 체득할 수 있도록 만들었습니다.  캐글과 UCI &lt;b&gt;머신러닝&lt;/b&gt; 리포지토리에서 난이도가 있는 실습... "

},
...
]
}
</pre></table></code></div></div><ul><li>네이버책에서 머신러닝 제목을 가진 책을 받아옴 총 1046개이다</li><li>display는 10개가 제한으로, 총 10개만 나오게 됨</li><li>위의 블로그 API 검색 url에서 마지막 부분의 blog가 book으로 바뀌었다</li></ul><p><br /></p><h3 id="22-네이버-영화-api">2.2 네이버 영화 API</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">encText</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">'엔드게임'</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'https://openapi.naver.com/v1/search/movie?query='</span> <span class="o">+</span> <span class="n">encText</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Id'</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Secret'</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>{
"lastBuildDate": "Thu, 15 Oct 2020 15:59:22 +0900",
"total": 13,
"start": 1,
"display": 10,
"items": [
{
"title": "이벤트 트렌스파이어링 비포, 듀링, &lt;b&gt;엔드&lt;/b&gt; 애프터 어 하이 스쿨 바스켓볼 &lt;b&gt;게임&lt;/b&gt;",
"link": "https://movie.naver.com/movie/bi/mi/basic.nhn?code=197237",
"image": "https://ssl.pstatic.net/imgmovie/mdi/mit110/1972/197237_P01_111704.jpg",
"subtitle": "Events Transpiring Before, During, and After a High School Basketball Game",
"pubDate": "2020",
"director": "테드 스텐슨|",
"actor": "",
"userRating": "0.00"

},
...
]
}
</pre></table></code></div></div><ul><li>엔드게임이라는 영화제목을 검색해봄</li></ul><p><br /></p><h3 id="23-네이버카페-api">2.3 네이버카페 API</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">encText</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">'파이썬'</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'https://openapi.naver.com/v1/search/cafearticle?query='</span> <span class="o">+</span> <span class="n">encText</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Id'</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Secret'</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>{
"lastBuildDate": "Thu, 15 Oct 2020 16:00:58 +0900",
"total": 90077,
"start": 1,
"display": 10,
"items": [
{
"title": "&lt;b&gt;파이썬&lt;/b&gt; 코딩 빠르게 할려면?",
"link": "http://cafe.naver.com/fx8300/698502",
"description": "지난번에 &lt;b&gt;파이썬&lt;/b&gt; 코딩하는데 자기 놋북으로 10시간 걸린다고 거실 데탑으로 해 보더니 2시간 걸리더라구요. &lt;b&gt;파이썬&lt;/b&gt; 코딩 좀 빠르게 할려면 오버 안한다는 조건으로 어떤걸로 업하면 체감이 될런지.. 현재 라이젠5... ",
"cafename": "AMD 비쉐라 라이젠 컴퓨터 사용자 모임",
"cafeurl": "https://cafe.naver.com/fx8300"

},

]
}
</pre></table></code></div></div><ul><li>파이썬이라는 이름으로 네이버카페를 검색했을때 나오는 내용</li></ul><p><br /></p><h3 id="24-네이버-쇼핑-api">2.4 네이버 쇼핑 API</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">encText</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">'파이썬'</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'https://openapi.naver.com/v1/search/shop?query='</span> <span class="o">+</span> <span class="n">encText</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Id'</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Secret'</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>{
"lastBuildDate": "Thu, 15 Oct 2020 16:02:01 +0900",
"total": 197549,
"start": 1,
"display": 10,
"items": [
{
"title": "글렌다블룸 리얼 &lt;b&gt;파이톤&lt;/b&gt; 미니 보스톤백",
"link": "https://search.shopping.naver.com/gate.nhn?id=24198320022",
"image": "https://shopping-phinf.pstatic.net/main_2419832/24198320022.20200918175522.jpg",
"lprice": "142170",
"hprice": "151370",
"mallName": "네이버",
"productId": "24198320022",
"productType": "1",
"brand": "",
"maker": "",
"category1": "패션잡화",
"category2": "여성가방",
"category3": "토트백",
"category4": ""

},
...
]
}
</pre></table></code></div></div><ul><li>네이버 쇼핑의 파이썬 검색</li></ul><p><br /></p><h3 id="25-백과사전-api">2.5 백과사전 API</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">encText</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="s">'파이썬'</span><span class="p">)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">'https://openapi.naver.com/v1/search/encyc?query='</span> <span class="o">+</span> <span class="n">encText</span>
<span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Id'</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
<span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Secret'</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>{
"lastBuildDate": "Thu, 15 Oct 2020 16:03:08 +0900",
"total": 426,
"start": 1,
"display": 10,
"items": [
{
"title": "&lt;b&gt;파이썬&lt;/b&gt;",
"link": "https://terms.naver.com/entry.nhn?docId=3580815&amp;cid=59088&amp;categoryId=59096",
"description": "‘&lt;b&gt;파이썬&lt;/b&gt;’이다. 간결한 문법으로 입문자가 이해하기 쉽고, 다양한 분야에 활용할 수 있기 때문이다. 이 외에도 &lt;b&gt;파이썬&lt;/b&gt;은 머신러닝, 그래픽, 웹 개발 등 여러 업계에서 선호하는 언어로 꾸준히... ",
"thumbnail": "http://openapi-dbscthumb.phinf.naver.net/4749_000_1/20170118193349632_0CHSSS5Y6.png/01_16.png?type=m160_160"

},

]
}
</pre></table></code></div></div><ul><li>백과사전 검색</li></ul><p><br /></p><h2 id="3-네이버쇼핑-api에서-몰스킨-상품-받아서-저장하기">3. 네이버쇼핑 API에서 몰스킨 상품 받아서 저장하기</h2><hr /><h3 id="31-몰스킨">3.1 몰스킨?</h3><ul><li>창조적인 일을 하는 사람들이, 창조성을 기록하는 책의 이미지</li><li>전세계의 많은 사람들이 몰스킨의 제품으로 기록을 하고 있다.</li></ul><p><br /></p><h3 id="32-순서도">3.2 순서도</h3><ul><li>1) URL 생성</li><li>2) URL을 API에 적용</li><li>3) 데이터프레임으로 변경하여 저장</li><li>4) 여러페이지에 적용</li><li>5) 엑셀로 저장</li><li>순서도를 미리 작성하여 코드의 흐름을 잡고, 체계적으로 개발을 할수 있도록 하자</li></ul><p><br /></p><h3 id="33-검색-url-생성">3.3 검색 URL 생성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_search_url</span><span class="p">(</span><span class="n">api_node</span><span class="p">,</span> <span class="n">search_text</span><span class="p">,</span> <span class="n">start_num</span><span class="p">,</span> <span class="n">disp_num</span><span class="p">):</span>
    <span class="n">base</span> <span class="o">=</span> <span class="s">'https://openapi.naver.com/v1/search'</span>
    <span class="n">node</span> <span class="o">=</span> <span class="s">'/'</span> <span class="o">+</span> <span class="n">api_node</span> <span class="o">+</span> <span class="s">'.json'</span>
    <span class="n">param_query</span> <span class="o">=</span> <span class="s">'?query='</span> <span class="o">+</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="n">quote</span><span class="p">(</span><span class="n">search_text</span><span class="p">)</span>
    <span class="n">param_start</span> <span class="o">=</span> <span class="s">'&amp;start='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">start_num</span><span class="p">)</span>
    <span class="n">param_disp</span> <span class="o">=</span> <span class="s">'&amp;display='</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">disp_num</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">base</span> <span class="o">+</span> <span class="n">node</span> <span class="o">+</span> <span class="n">param_query</span> <span class="o">+</span> <span class="n">param_start</span> <span class="o">+</span> <span class="n">param_disp</span>
</pre></table></code></div></div><ul><li>url에 포함되어야하는 파라미터들의 설명</li></ul><div class="table-wrapper"><table><thead><tr><th style="text-align: left">요청<th style="text-align: left">변수명<th style="text-align: left">타입<th style="text-align: left">필수여부<th style="text-align: left">기본값설명<tbody><tr><td style="text-align: left">query<td style="text-align: left">string<td style="text-align: left">Y<td style="text-align: left">-<td style="text-align: left">검색을 원하는 문자열로서 UTF-8로 인코딩한다.<tr><td style="text-align: left">display<td style="text-align: left">integer<td style="text-align: left">N<td style="text-align: left">10(기본값), 100(최대)<td style="text-align: left">검색 결과 출력 건수 지정<tr><td style="text-align: left">start<td style="text-align: left">integer<td style="text-align: left">N<td style="text-align: left">1(기본값), 1000(최대)<td style="text-align: left">검색 시작 위치로 최대 1000까지 가능<tr><td style="text-align: left">sort<td style="text-align: left">string<td style="text-align: left">N<td style="text-align: left">sim(기본값), date, asc, dsc<td style="text-align: left">정렬 옵션: sim (유사도순), date (날짜순), asc(가격오름차순) ,dsc(가격내림차순)</table></div><ul><li>해당 파라미터들을 포함하는 url 생성기를 함수로 작성</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">get_search_url</span><span class="p">(</span><span class="s">'shop'</span><span class="p">,</span> <span class="s">'test'</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>'https://openapi.naver.com/v1/search/shop.json?query=test&amp;start=10&amp;display=3'
</pre></table></code></div></div><ul><li>네이버 쇼핑(shop), test라는 검색어에 10번째 페이지에서 3개의 데이터만 가져오는 URL을 생성</li></ul><p><br /></p><h3 id="34-url을-api에-적용">3.4 URL을 API에 적용</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">def</span> <span class="nf">get_result_onpage</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Id'</span><span class="p">,</span> <span class="n">client_id</span><span class="p">)</span>
    <span class="n">request</span><span class="p">.</span><span class="n">add_header</span><span class="p">(</span><span class="s">'X-Naver-Client-Secret'</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>
    
    <span class="n">response</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">'[%s] Url Request Success'</span> <span class="o">%</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">())</span>
    
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">))</span>
</pre></table></code></div></div><ul><li>URL을 입력받아, 해당 URL을 API에 적용시켜 json 형태로 저장하는 함수를 작성</li><li>client_id, client_secret은 맨위에 api 신청하며 받은 본인의 것을 넣으면 됨</li></ul><p><br /></p><h3 id="35-중간-테스트">3.5 중간 테스트</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">client_id</span> <span class="o">=</span> <span class="s">'your_id'</span> <span class="c1"># your_id
</span><span class="n">client_secret</span> <span class="o">=</span> <span class="s">'your_secret'</span> <span class="c1"># your_secret
</span>
<span class="n">url</span> <span class="o">=</span> <span class="n">get_search_url</span><span class="p">(</span><span class="s">'shop'</span><span class="p">,</span> <span class="s">'몰스킨'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">one_result</span> <span class="o">=</span> <span class="n">get_result_onpage</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">one_result</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>[2020-10-15 16:31:32.135759] Url Request Success

{'lastBuildDate': 'Thu, 15 Oct 2020 16:31:32 +0900',
 'total': 36615,
 'start': 1,
 'display': 2,
 'items': [{'title': '&lt;b&gt;몰스킨&lt;/b&gt; &lt;b&gt;몰스킨&lt;/b&gt; 2021 데일리 12M 다이어리 소프트커버 라지 사파이어블루',
   'link': 'https://search.shopping.naver.com/gate.nhn?id=24014109279',
   'image': 'https://shopping-phinf.pstatic.net/main_2401410/24014109279.20200903005345.jpg',
   'lprice': '21130',
   'hprice': '38500',
   'mallName': '네이버',
   'productId': '24014109279',
   'productType': '1',
   'brand': '몰스킨',
   'maker': '몰스킨',
   'category1': '생활/건강',
   'category2': '문구/사무용품',
   'category3': '다이어리/플래너',
   'category4': '다이어리'},
  {'title': '&lt;b&gt;몰스킨&lt;/b&gt; 2021 다이어리 데일리 위클리 먼슬리 A5 고급 명품 감성 업무용 회사 기업 각인',
   'link': 'https://search.shopping.naver.com/gate.nhn?id=82635708485',
   'image': 'https://shopping-phinf.pstatic.net/main_8263570/82635708485.jpg',
   'lprice': '24100',
   'hprice': '0',
   'mallName': '에코펜',
   'productId': '82635708485',
   'productType': '2',
   'brand': '몰스킨',
   'maker': '몰스킨',
   'category1': '생활/건강',
   'category2': '문구/사무용품',
   'category3': '다이어리/플래너',
   'category4': '다이어리'}]}
</pre></table></code></div></div><ul><li>몰스킨의 제품 2개를 가져와보았고, 제대로 출력이됨</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">one_result</span><span class="p">[</span><span class="s">'items'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'title'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">one_result</span><span class="p">[</span><span class="s">'items'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'lprice'</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>&lt;b&gt;몰스킨&lt;/b&gt; &lt;b&gt;몰스킨&lt;/b&gt; 2021 데일리 12M 다이어리 소프트커버 라지 사파이어블루
21130
</pre></table></code></div></div><ul><li>API로 받은 데이터는 items에 저장되어있으며, 첫번째 상품의 이름과 가격을 출력해보았음</li></ul><p><br /></p><h3 id="36-데이터프레임으로-변경하여-저장">3.6 데이터프레임으로 변경하여 저장</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>


<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">json_data</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'link'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">lprice</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'lprice'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">hprice</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'hprice'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">mall_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'mallName'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>

    <span class="n">result_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'title'</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s">'lprice'</span><span class="p">:</span> <span class="n">lprice</span><span class="p">,</span> <span class="s">'hprice'</span><span class="p">:</span> <span class="n">hprice</span><span class="p">,</span> <span class="s">'link'</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span>
                              <span class="s">'mall'</span><span class="p">:</span> <span class="n">mall_name</span><span class="p">},</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'lprice'</span><span class="p">,</span> <span class="s">'hprice'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'mall'</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">result_pd</span>
</pre></table></code></div></div><ul><li>json 포멧의 데이터를 데이터프레임으로 변경하는 함수를 작성하였음</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">get_fields</span><span class="p">(</span><span class="n">one_result</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96278476-81e93e80-1010-11eb-9f83-ce8511f3e082.png" /></p><ul><li>실제로 적용해보니 <code class="language-plaintext highlighter-rouge">&lt;b&gt;</code> 태그가 같이 나옴</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">delete_tag</span><span class="p">(</span><span class="n">input_str</span><span class="p">):</span>
    <span class="n">input_str</span> <span class="o">=</span> <span class="n">input_str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'&lt;b&gt;'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="n">input_str</span> <span class="o">=</span> <span class="n">input_str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'&lt;/b&gt;'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">input_str</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">&lt;b&gt;</code> 태그를 없애는 함수를 작성</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>


<span class="k">def</span> <span class="nf">get_fields</span><span class="p">(</span><span class="n">json_data</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="p">[</span><span class="n">delete_tag</span><span class="p">(</span><span class="n">each</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">link</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'link'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">lprice</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'lprice'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">hprice</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'hprice'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>
    <span class="n">mall_name</span> <span class="o">=</span> <span class="p">[</span><span class="n">each</span><span class="p">[</span><span class="s">'mallName'</span><span class="p">]</span> <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">[</span><span class="s">'items'</span><span class="p">]]</span>

    <span class="n">result_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'title'</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s">'lprice'</span><span class="p">:</span> <span class="n">lprice</span><span class="p">,</span> <span class="s">'hprice'</span><span class="p">:</span> <span class="n">hprice</span><span class="p">,</span> <span class="s">'link'</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span>
                              <span class="s">'mall'</span><span class="p">:</span> <span class="n">mall_name</span><span class="p">},</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'lprice'</span><span class="p">,</span> <span class="s">'hprice'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'mall'</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">result_pd</span>
</pre></table></code></div></div><ul><li>위에서 만든 태그 제거기를 title을 만들때 적용</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">url</span> <span class="o">=</span> <span class="n">get_search_url</span><span class="p">(</span><span class="s">'shop'</span><span class="p">,</span> <span class="s">'몰스킨'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">json_result</span> <span class="o">=</span> <span class="n">get_result_onpage</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">pd_result</span> <span class="o">=</span> <span class="n">get_fields</span><span class="p">(</span><span class="n">json_result</span><span class="p">)</span>
<span class="n">pd_result</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[2020-10-15 16:41:44.523438] Url Request Success
</pre></table></code></div></div><p><br /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96278486-844b9880-1010-11eb-9bb3-69823174eb9a.png" /></p><ul><li><code class="language-plaintext highlighter-rouge">&lt;b&gt;</code>태그 없이 잘 나옴</li><li>중간 테스트 완료</li></ul><h3 id="37-여러-페이지에-적용">3.7 여러 페이지에 적용</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>1
101
201
301
401
</pre></table></code></div></div><ul><li>왜 이러냐면은 위의 제한조건을 보면 알겠지만 display는 100개의 제한이 있다.</li><li>따라서 100개 이상의 제품을 API로 받아오려면 여러번 반복해야하고, 이를 for문으로 구현하겠다는 이야기</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">result_mol</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">get_search_url</span><span class="p">(</span><span class="s">'shop'</span><span class="p">,</span> <span class="s">'"몰스킨"'</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">one_result</span> <span class="o">=</span> <span class="n">get_result_onpage</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">pd_result</span> <span class="o">=</span> <span class="n">get_fields</span><span class="p">(</span><span class="n">one_result</span><span class="p">)</span>
    
    <span class="n">result_mol</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd_result</span><span class="p">)</span>
    
<span class="n">result_mol</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">(</span><span class="n">result_mol</span><span class="p">)</span>
<span class="n">result_mol</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>[2020-10-15 16:47:31.030728] Url Request Success
[2020-10-15 16:47:31.290818] Url Request Success
[2020-10-15 16:47:31.444291] Url Request Success
[2020-10-15 16:47:31.747240] Url Request Success
[2020-10-15 16:47:32.036682] Url Request Success
[2020-10-15 16:47:32.185240] Url Request Success
[2020-10-15 16:47:32.346305] Url Request Success
[2020-10-15 16:47:32.487543] Url Request Success
[2020-10-15 16:47:32.635507] Url Request Success
[2020-10-15 16:47:32.781476] Url Request Success
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96278490-84e42f00-1010-11eb-843c-7614ff40ce43.png" /></p><ul><li>총 10번을 진행하여, 1000개의 몰스킨 상품의 정보를 가져왔음</li><li>몰스킨은 꼭 <code class="language-plaintext highlighter-rouge">쌍따옴</code>표로 감싸서 진행해야함</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">result_mol</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 1000 entries, 0 to 99
Data columns (total 5 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   title   1000 non-null   object
 1   lprice  1000 non-null   object
 2   hprice  1000 non-null   object
 3   link    1000 non-null   object
 4   mall    1000 non-null   object
dtypes: object(5)
memory usage: 46.9+ KB
</pre></table></code></div></div><ul><li>1000개의 데이터인데, 인덱스를 보면 0 ~ 99까지로 총 100번 된듯 하다</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">result_mol</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">result_mol</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 5 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   title   1000 non-null   object
 1   lprice  1000 non-null   object
 2   hprice  1000 non-null   object
 3   link    1000 non-null   object
 4   mall    1000 non-null   object
dtypes: object(5)
memory usage: 39.2+ KB
</pre></table></code></div></div><ul><li>reset_index로 바로 잡아줌</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">result_mol</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96278491-86155c00-1010-11eb-8a0a-2026caee799e.png" /></p><ul><li>index가 999로 나오는것을 보니 제대로 바뀐것 같다</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">result_mol</span><span class="p">[</span><span class="s">'lprice'</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_mol</span><span class="p">[</span><span class="s">'lprice'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'float'</span><span class="p">)</span>
<span class="n">result_mol</span><span class="p">[</span><span class="s">'hprice'</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_mol</span><span class="p">[</span><span class="s">'hprice'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'float'</span><span class="p">)</span>
<span class="n">result_mol</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 5 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   title   1000 non-null   object 
 1   lprice  1000 non-null   float64
 2   hprice  1000 non-null   float64
 3   link    1000 non-null   object 
 4   mall    1000 non-null   object 
dtypes: float64(2), object(3)
memory usage: 39.2+ KB
</pre></table></code></div></div><ul><li>가격은 실수형으로 변환</li></ul><p><br /></p><h3 id="38-엑셀로-저장">3.8 엑셀로 저장</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s">'data/molskin_navershopAPI.xlsx'</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s">'xlsxwriter'</span><span class="p">)</span>

<span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">today</span><span class="p">().</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%Y%m%d"</span><span class="p">)</span>
<span class="n">result_mol</span><span class="p">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">today</span><span class="p">)</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">today</span><span class="p">]</span>
<span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'A:A'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'B:B'</span><span class="p">,</span> <span class="mi">65</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'C:C'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'D:D'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'E:E'</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet</span><span class="p">.</span><span class="n">set_column</span><span class="p">(</span><span class="s">'F:F'</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="n">worksheet</span><span class="p">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s">'C2:C1001'</span><span class="p">,</span> <span class="p">{</span><span class="s">'type'</span> <span class="p">:</span> <span class="s">'3_color_scale'</span><span class="p">})</span>

<span class="n">writer</span><span class="p">.</span><span class="n">save</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96093664-61818d00-0f07-11eb-8bad-b6f5920677c4.png" /></p><ul><li>위 처럼 엑셀이 만들어지게 된다.</li><li>today : API를 받아 엑셀을 생성한 날짜를 sheet name으로 설정</li><li>set_column : 각 컬럼의 크기를 셋팅</li><li>conditional_format : 컬럼의 색상을 변경함</li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/python/'>Python</a>, <a href='/categories/api/'>API</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/naver-api/" class="post-tag no-text-decoration" >Naver API</a> <a href="/tags/to-excel/" class="post-tag no-text-decoration" >To Excel</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Naver API 사용해보기 - Data Include Me&url=https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Naver API 사용해보기 - Data Include Me&u=https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Naver API 사용해보기 - Data Include Me&url=https://datainclude.me/posts/%EB%84%A4%EC%9D%B4%EB%B2%84API_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Panel on right side (Desktop views) v2.3 © 2024 Your Name MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li class="recent-item"> <a href="/posts/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85_%EA%B0%80%EC%83%81%ED%99%94/">클라우드 컴퓨팅 - 가상화</a> <span class="text-muted small">2024-10-28</span></li><li class="recent-item"> <a href="/posts/gemini_api_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/">Gemini API 사용해보기</a> <span class="text-muted small">2024-03-12</span></li><li class="recent-item"> <a href="/posts/Ollama%EC%99%80_Python_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC_LLaMa2%EB%A5%BC_%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Ollama와 Python 라이브러리를 이용하여 LLaMa2를 로컬에서 사용하기</a> <span class="text-muted small">2024-02-13</span></li><li class="recent-item"> <a href="/posts/Mistral_7B_Fine_Tuning/">Mistral 7B 파인튜닝(Fine Tuning)하기</a> <span class="text-muted small">2023-10-25</span></li><li class="recent-item"> <a href="/posts/Penn_Fudan%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EA%B0%9D%EC%B2%B4_%ED%83%90%EC%A7%80_%EB%B6%84%ED%95%A0/">Penn-Fudan으로 알아보는 객체 탐지(Object Detection), 분할(Segmentation) with FasterRCNN</a> <span class="text-muted small">2023-10-23</span></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><style> .recent-item { margin-bottom: 0.5rem; } .recent-item a { color: var(--link-color); } .recent-item .small { font-size: 0.75rem; margin-left: 0.5rem; }</style></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/wishket_crawling/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jan 15, 2022 <i class="unloaded">2022-01-15T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>위시켓 프로젝트 크롤링 하기</h3><div class="text-muted small"><p> 위시켓 프로젝트 크롤링 하기 1) 크롤링 동기 위시켓 https://www.wishket.com/은 개발, 디자인 등의 프로젝트를 중계해주는 플랫폼이다. 클라이언트는 진행할 프로젝트를 등록하고, 파트너는 자신이 할수있는 프로젝트를 확인하여 지원하는 방식이다. 파트너의 경우 위시켓에서 매일 오후 5시에 자신이 선택한 프로젝트 분야에 맞춰...</p></div></div></a></div><div class="card"> <a href="/posts/Pandas%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EC%BB%AC%EB%9F%BC_%EB%8D%94%ED%95%98%EA%B8%B0/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Feb 6, 2022 <i class="unloaded">2022-02-06T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pandas를 이용한 Column 더하기</h3><div class="text-muted small"><p> 0. 들어가며 데이터 분석을 하다보면 Pandas를 많이 사용하게 된다. 데이터들의 Column을 더하고 싶을때, 어떻게 하면 좋을까? 만약 Column에 결측치가 있다면 어떻게 처리하면 될까? 1. Pandas를 이용해서 Titanic 데이터 Column 더하기 1 2 3 4 5 import pandas as pd df = pd...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%95%84%EB%82%98%EC%BD%98%EB%8B%A4_%EA%B0%80%EC%83%81%ED%99%98%EA%B2%BD_%EC%A3%BC%ED%94%BC%ED%84%B0%EB%9E%A9%EC%97%90%EC%84%9C_%EC%89%BD%EA%B2%8C_%EC%93%B0%EA%B8%B0/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Jul 10, 2022 <i class="unloaded">2022-07-10T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>아나콘다 가상환경 주피터랩에서 쉽게 쓰기</h3><div class="text-muted small"><p> 0. 들어가며 파이썬을 사용하여 개발이나 데이터분석을 진행한다면 필수로 셋팅하는것 중에 하나가 가상환경 일것이다. 요즘은 도커를 많이 사용하지만, 아직 나는 도커가 익숙하지 않기에 프로젝트를 할때마다 매번 가상환경을 셋팅한다. 하지만 문제점이 하나 있는데 가상환경에 매번 주피터랩을 설치해야 한다는 것이다. 각 가상환경에 주피터랩을 설치하면 가상환...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%ED%81%AC%EB%A1%A4%EB%A7%81(Crawling)_%EA%B8%B0%EC%B4%88(2)/" class="btn btn-outline-primary"><p>크롤링(Crawling) 기초(2)</p></a> <a href="/posts/%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D%EC%9D%84_%EC%9D%B4%EC%9A%A9%ED%95%9C_%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%EC%83%9D%EC%A1%B4%EC%9E%90_%EC%98%88%EC%B8%A1/" class="btn btn-outline-primary"><p>머신러닝을 이용한 타이타닉 생존자 예측</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://datainclude.me{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
