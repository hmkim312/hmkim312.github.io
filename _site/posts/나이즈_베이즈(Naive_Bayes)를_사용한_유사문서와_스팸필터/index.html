<!DOCTYPE html><html lang="ko" mode="light" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터 | Data Include Me</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터" /><meta name="author" content="HyunMin Kim" /><meta property="og:locale" content="ko" /><meta name="description" content="1. 나이브 베이즈를 활용한 유사 문서 검색 1.1 뉴스 문서 Load" /><meta property="og:description" content="1. 나이브 베이즈를 활용한 유사 문서 검색 1.1 뉴스 문서 Load" /><link rel="canonical" href="https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/" /><meta property="og:url" content="https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/" /><meta property="og:site_name" content="Data Include Me" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-19T11:10:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@HyunMin Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HyunMin Kim"},"dateModified":"2020-10-19T11:10:00+09:00","datePublished":"2020-10-19T11:10:00+09:00","description":"1. 나이브 베이즈를 활용한 유사 문서 검색 1.1 뉴스 문서 Load","headline":"나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터","mainEntityOfPage":{"@type":"WebPage","@id":"https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/"},"url":"https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/"}</script><meta property="og:image" content="https://datainclude.me/assets/img/sample/avatar.jpg" /> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="36x36" href="/assets/img/favicons/android-icon-36x36.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicons/android-icon-48x48.png"><link rel="icon" type="image/png" sizes="72x72" href="/assets/img/favicons/android-icon-72x72.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/android-icon-96x96.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/android-icon-144x144.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="70x70" href="/assets/img/favicons/ms-icon-70x70.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/ms-icon-144x144.png"><link rel="icon" type="image/png" sizes="150x150" href="/assets/img/favicons/ms-icon-150x150.png"><link rel="icon" type="image/png" sizes="310x310" href="/assets/img/favicons/ms-icon-310x310.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-MW9VRMW9" as="script"> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MW9VRMW9');</script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> </noscript> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9VRMW9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Data Include Me</a></div><div class="site-subtitle font-italic">Data Science Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hmkim312" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sanarial312','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <script type="text/javascript"> var lazyloadads = false; function loadAds() { if (!lazyloadads) { var script = document.createElement("script"); script.type = "text/javascript"; script.async = true; script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7594406644928408"; document.body.appendChild(script); lazyloadads = true; } } window.addEventListener("mousemove", loadAds, { once: true }); window.addEventListener('touchstart', loadAds, { once: true }); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Oct 19, 2020, 11:10 AM +0900" > Oct 19, 2020 <i class="unloaded">2020-10-19T11:10:00+09:00</i> </span> by <span class="author"> HyunMin Kim </span></div><a href="https://hits.seeyoufarm.com"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/%2F&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="페이지 조회수 뱃지", width: 100%;, height: 100%;/> </a></div><div class="post-content"><h2 id="1-나이브-베이즈를-활용한-유사-문서-검색">1. 나이브 베이즈를 활용한 유사 문서 검색</h2><hr /><h3 id="11-뉴스-문서-load">1.1 뉴스 문서 Load</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>

<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s">'alt.atheism'</span><span class="p">,</span> <span class="s">'soc.religion.christian'</span><span class="p">,</span> <span class="s">'comp.graphics'</span><span class="p">,</span> <span class="s">'sci.med'</span><span class="p">]</span>
<span class="n">twenty_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">'train'</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">twenty_train</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>dict_keys(['data', 'filenames', 'target_names', 'target', 'DESCR'])
</pre></table></code></div></div><ul><li>Sklearn에는 20개의 카테고리의 뉴스 문서를 fetch_20newsgroups 메서드로 제공함</li><li>제공하는 뉴스 중 총 ‘alt.atheism(무신론)’, ‘soc.religion.christian(기독교)’, ‘comp.graphics(컴퓨터)’, ‘sci.med(의약)’ 4개의 주제를 불러옴</li><li>data, filenames, target_names, target, DESCR로 데이터는 이루어져 있음</li></ul><p><br /></p><h3 id="12-데이터셋의-설명">1.2 데이터셋의 설명</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">[</span><span class="s">'DESCR'</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>.. _20newsgroups_dataset:

The 20 newsgroups text dataset
------------------------------

The 20 newsgroups dataset comprises around 18000 newsgroups posts on
20 topics split in two subsets: one for training (or development)
and the other one for testing (or for performance evaluation). The split
between the train and test set is based upon a messages posted before
and after a specific date.
...
</pre></table></code></div></div><ul><li>해당 데이터의 설명과 사용법 등이 저장되어있다.</li></ul><p><br /></p><h3 id="13-타겟-이름과-데이터의-갯수">1.3 타겟 이름과 데이터의 갯수</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">.</span><span class="n">data</span><span class="p">))</span>
<span class="n">twenty_train</span><span class="p">.</span><span class="n">target_names</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>2257
['alt.atheism', 'comp.graphics', 'sci.med', 'soc.religion.christian']
</pre></table></code></div></div><ul><li>아까 지정한 4개의 카테고리가 target name이며 총 2257개의 데이터(뉴스문서)가 있음</li></ul><p><br /></p><h3 id="14-실제-데이터-내용">1.4 실제 데이터 내용</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">[</span><span class="s">'data'</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>From: geb@cs.pitt.edu (Gordon Banks)
Subject: Re: Update (Help!) [was "What is This [Is it Lyme's?]"]
Article-I.D.: pitt.19436
Reply-To: geb@cs.pitt.edu (Gordon Banks)
Organization: Univ. of Pittsburgh Computer Science
Lines: 42

In article &lt;1993Mar29.181958.3224@equator.com&gt; jod@equator.com (John Setel O'Donnell) writes:
&gt;
&gt;I shouldn't have to be posting here.  Physicians should know the Lyme
&gt;literature beyond Steere &amp; co's denial merry-go-round.  Patients
&gt;should get correctly diagnosed and treated.
&gt;

...
-- 
----------------------------------------------------------------------------
Gordon Banks  N3JXP      | "Skepticism is the chastity of the intellect, and
geb@cadre.dsl.pitt.edu   |  it is shameful to surrender it too soon." 
----------------------------------------------------------------------------
</pre></table></code></div></div><ul><li>첫번째 뉴스데이터를 봐보았으며, 의약 분야에 대한 신문 기사이다</li></ul><p><br /></p><h3 id="15-타겟-확인">1.5 타겟 확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">twenty_train</span><span class="p">[</span><span class="s">'target'</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sci.med
</pre></table></code></div></div><ul><li>해당 뉴스 기사의 타겟이름은 sci.med 이다</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="n">twenty_train</span><span class="p">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>['alt.atheism', 'comp.graphics', 'sci.med', 'soc.religion.christian']
array([2, 1, 1, 3, 2, 3, 0, 3, 2, 0])
</pre></table></code></div></div><ul><li>타겟이름의 순서대로 0~3까지 이다.</li></ul><p><br /></p><h3 id="16-count-vectorize">1.6 Count Vectorize</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="n">X_train_counts</span> <span class="o">=</span> <span class="n">count_vect</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">X_train_counts</span><span class="p">.</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(2257, 35788)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">X_train_counts</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>&lt;2257x35788 sparse matrix of type '&lt;class 'numpy.int64'&gt;'
	with 365886 stored elements in Compressed Sparse Row format&gt;
</pre></table></code></div></div><ul><li>전체 2257개의 뉴스 데이터를 카운트 벡터라이즈한 결과 총 35788개의 단어가 생성되었음</li><li>해당 행렬은 2257 x 35788의 거대한 행렬임</li></ul><p><br /></p><h3 id="17-거대한-행렬의-처리">1.7 거대한 행렬의 처리</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train_counts</span><span class="p">.</span><span class="n">toarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">X_train_counts</span><span class="p">.</span><span class="n">toarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>35788
array([0, 0, 0, ..., 0, 0, 0])
</pre></table></code></div></div><ul><li>첫번째 행을 보았으나, 대부분 0으로 이루어져있고, 가끔 1이나 그외의 값으로 입력이 되어있을것</li><li>행은 데이터, 열은 35788개의 단어 이기 때문임</li></ul><p><br /></p><h3 id="18-희소행렬sparse-matrix과-행렬-압축compression">1.8 희소행렬(Sparse matrix)과 행렬 압축(Compression)</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96452430-f829b300-1253-11eb-97b5-d48f2593ba52.png" /></p><ul><li>희소행렬 : 대부분의 값이 0으로 이루어져있는 행렬</li><li>행렬압축 : 행 열 값으로 이루어져, 희소행렬을 압축해놓은 행렬</li></ul><p><br /></p><h3 id="19-값이-0이-아닌것">1.9 값이 0이 아닌것</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">print</span><span class="p">(</span><span class="s">'전체 데이터의 합 : '</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">X_train_counts</span><span class="p">.</span><span class="n">toarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'0이 아닌 데이터의 갯수 : '</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_counts</span><span class="p">.</span><span class="n">toarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">X_train_counts</span><span class="p">.</span><span class="n">toarray</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>전체 데이터의 합 :  320
0이 아닌 데이터의 갯수 :  193
</pre></table></code></div></div><ul><li>총 35788의 열 중에서 언급된 단어 데이터는 320개</li><li>그 중 중복을 제거하고 0이 아닌 데이터의 행 갯수는 193개 임</li><li>총 35788개 중에 193개를 제외하고는 모두 0이라는 이야기 = 희소행렬</li></ul><p><br /></p><h3 id="110-tf-idf-적용">1.10 Tf-idf 적용</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfTransformer</span>

<span class="n">tf_transformer</span> <span class="o">=</span> <span class="n">TfidfTransformer</span><span class="p">(</span><span class="n">use_idf</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_counts</span><span class="p">)</span>
<span class="n">X_train_tf</span> <span class="o">=</span> <span class="n">tf_transformer</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train_counts</span><span class="p">)</span>
<span class="n">X_train_tf</span><span class="p">.</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(2257, 35788)
</pre></table></code></div></div><ul><li>Tfidf를 적용하여도 35788개의 열이 나온다.</li><li>결국 희소행렬임</li></ul><p><br /></p><h3 id="111-multinomial-naive-bayes-적용">1.11 Multinomial Naive Bayes 적용</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">().</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_tf</span><span class="p">,</span> <span class="n">twenty_train</span><span class="p">.</span><span class="n">target</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>Multinomial Naive Bayes를 Tf-idf를 적용시킨 데이터와 target을 넣고 학습 시켜줌</li><li>target = y 라고 생각해도 됨</li></ul><p><br /></p><h3 id="112-간단-테스트">1.12 간단 테스트</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">docs_new</span> <span class="o">=</span><span class="p">[</span><span class="s">'God is love'</span><span class="p">,</span> <span class="s">'OpenGL on the GPU is fast'</span><span class="p">]</span>
<span class="n">X_new_counts</span> <span class="o">=</span> <span class="n">count_vect</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">docs_new</span><span class="p">)</span>
<span class="n">X_new_tfidf</span> <span class="o">=</span> <span class="n">tf_transformer</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_new_counts</span><span class="p">)</span>

<span class="n">predicted</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new_tfidf</span><span class="p">)</span>

<span class="k">for</span> <span class="n">doc</span><span class="p">,</span> <span class="n">categories</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">docs_new</span><span class="p">,</span> <span class="n">predicted</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">doc</span><span class="si">}</span><span class="s"> =&gt; </span><span class="si">{</span><span class="n">twenty_train</span><span class="p">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">categories</span><span class="p">]</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>God is love =&gt; soc.religion.christian
OpenGL on the GPU is fast =&gt; comp.graphics
</pre></table></code></div></div><ul><li>간단하게 God is love, OpenGL on the GPU is fast 라는 문장을 카운트 벡터라이즈 한뒤 TF-idf로 거리를 구하여 MultinolialNB을 적용하여 예측하였다.</li><li>God is love는 soc.religion.christian으로 예측되고, OpenGL on the GPU is fast는 comp.grahics로 예측하는 것으로 보아 괜찮은듯 하다</li></ul><p><br /></p><h3 id="113-pipeline-생성">1.13 PipeLine 생성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="n">text_clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'vect'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'tfidf'</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'clf'</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">()),</span>
<span class="p">])</span>
</pre></table></code></div></div><ul><li>문장이 입력되면 Pipeline을 통해 카운트벡터라이즈 -&gt; Tf-idf -&gt; MultinomialNB를 거치는 Pipeline을 생성</li></ul><p><br /></p><h3 id="114-학습-후-test">1.14 학습 후 Test</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">text_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">twenty_train</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">twenty_train</span><span class="p">.</span><span class="n">target</span><span class="p">)</span>

<span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s">'alt.atheism'</span><span class="p">,</span> <span class="s">'soc.religion.christian'</span><span class="p">,</span> <span class="s">'comp.graphics'</span><span class="p">,</span> <span class="s">'sci.med'</span><span class="p">]</span>
<span class="n">twenty_test</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">'test'</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="n">docs_test</span> <span class="o">=</span> <span class="n">twenty_test</span><span class="p">.</span><span class="n">data</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">text_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">docs_test</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">twenty_test</span><span class="p">.</span><span class="n">target</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0.8348868175765646
</pre></table></code></div></div><ul><li>위에서 생성한 pipelien을 통과하여 train data를 학습시키고, 다시 같은 카테고리로 test 데이터를 불러와 예측해봄</li><li>예측된 결과와 실제 타겟은 약 0.83의 Accuracty를 가짐</li></ul><p><br /></p><h3 id="115-classification-report">1.15 Classification Report</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">twenty_test</span><span class="p">.</span><span class="n">target</span><span class="p">,</span> <span class="n">predicted</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span> <span class="n">twenty_test</span><span class="p">.</span><span class="n">target_names</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>                        precision    recall  f1-score   support

           alt.atheism       0.97      0.60      0.74       319
         comp.graphics       0.96      0.89      0.92       389
               sci.med       0.97      0.81      0.88       396
soc.religion.christian       0.65      0.99      0.78       398

              accuracy                           0.83      1502
             macro avg       0.89      0.82      0.83      1502
          weighted avg       0.88      0.83      0.84      1502
</pre></table></code></div></div><ul><li>atheism과 christain에서 상대적으로 f1-score가 낮은것으로 보아, 해당 뉴스들이 비슷한 단어들을 많이 쓰는듯 하다(종교적인 이야기이니 당연한걸지도..)</li></ul><p><br /></p><h3 id="116-confusion-matrix">1.16 Confusion Matrix</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">twenty_test</span><span class="p">.</span><span class="n">target</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>array([[192,   2,   6, 119],
       [  2, 347,   4,  36],
       [  2,  11, 322,  61],
       [  2,   2,   1, 393]])
</pre></table></code></div></div><ul><li>Confusion Matrix는 아래 와 같이 본다.</li><li>atheism을 atheism으로 예측한것은 192개, graphics는 2개, med는 6개 christin은 119개</li><li>graphics는 atheism으로 예측한것은 2개, graphics는 347개, med는 4개 christin은 36개</li></ul><p><br /></p><h2 id="2-sms-spam-collection-data">2. SMS Spam Collection Data</h2><hr /><h3 id="21-data">2.1 Data</h3><ul><li>kaggle에 있는 데이터로 문자를 받고 스팸인지 아닌지를 구분하는 데이터 셋</li><li>참고로 스팸의 반대말은 햄이다..</li></ul><p><br /></p><h3 id="22-data-load">2.2 Data load</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">messages</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://raw.githubusercontent.com/hmkim312/datas/main/spam/spam.csv'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'latin-1'</span><span class="p">)</span>
<span class="n">messages</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Unnamed: 2'</span><span class="p">,</span><span class="s">'Unnamed: 3'</span><span class="p">,</span><span class="s">'Unnamed: 4'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">messages</span> <span class="o">=</span> <span class="n">messages</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'v1'</span> <span class="p">:</span> <span class="s">'class'</span><span class="p">,</span> <span class="s">'v2'</span> <span class="p">:</span> <span class="s">'text'</span><span class="p">})</span>
<span class="n">messages</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>class<th>text<tbody><tr><th>0<td>ham<td>Go until jurong point, crazy.. Available only ...<tr><th>1<td>ham<td>Ok lar... Joking wif u oni...<tr><th>2<td>spam<td>Free entry in 2 a wkly comp to win FA Cup fina...<tr><th>3<td>ham<td>U dun say so early hor... U c already then say...<tr><th>4<td>ham<td>Nah I don't think he goes to usf, he lives aro...</table></div><ul><li>해당 데이터를 불러왔고, 데이터는 깃헙에 있다</li><li>보면 class 는 target이고, text는 내용이다</li><li>필요없는 3개의 컬럼은 삭제하였다</li></ul><p><br /></p><h3 id="23-data-통계">2.3 Data 통계</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">messages</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'class'</span><span class="p">).</span><span class="n">describe</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead tr th { text-align: left; } .dataframe thead tr:last-of-type th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr><th><th colspan="4" halign="left">text<tr><th><th>count<th>unique<th>top<th>freq<tr><th>class<th><th><th><th><tbody><tr><th>ham<td>4825<td>4516<td>Sorry, I'll call later<td>30<tr><th>spam<td>747<td>653<td>Please call our customer service representativ...<td>4</table></div><ul><li>Ham과 Spam은 약 747개와 4825개로 되어있다.</li></ul><p><br /></p><h3 id="24-text-길이">2.4 Text 길이</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">messages</span><span class="p">[</span><span class="s">'length'</span><span class="p">]</span> <span class="o">=</span> <span class="n">messages</span><span class="p">[</span><span class="s">'text'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="n">messages</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>class<th>text<th>length<tbody><tr><th>0<td>ham<td>Go until jurong point, crazy.. Available only ...<td>111<tr><th>1<td>ham<td>Ok lar... Joking wif u oni...<td>29<tr><th>2<td>spam<td>Free entry in 2 a wkly comp to win FA Cup fina...<td>155<tr><th>3<td>ham<td>U dun say so early hor... U c already then say...<td>49<tr><th>4<td>ham<td>Nah I don't think he goes to usf, he lives aro...<td>61</table></div><ul><li>단순히 문장의 길이를 length 컬럼으로 생성하여 확인한것</li></ul><p><br /></p><h3 id="25-spam과-ham의-문장-길이">2.5 Spam과 Ham의 문장 길이</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">messages</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span> <span class="s">'length'</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">'class'</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96459370-04fed480-125d-11eb-97cb-b8776e6dadb8.png" /></p><ul><li>Ham은 길이가 0~200사이에 몰려있고, 긴 것도 있는 반면 Spam은 길이가 100 ~ 170정도의 사이에 몰려있고 긴 것은 없다.</li></ul><p><br /></p><h3 id="26-단어정리를-위한-함수-생성">2.6 단어정리를 위한 함수 생성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>

<span class="k">def</span> <span class="nf">process_text</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">nopunc</span> <span class="o">=</span> <span class="p">[</span><span class="n">char</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">if</span> <span class="n">char</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">.</span><span class="n">punctuation</span><span class="p">]</span>
    <span class="n">nopunc</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">nopunc</span><span class="p">)</span>
    
    <span class="n">clean_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">nopunc</span><span class="p">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">word</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">clean_words</span>
</pre></table></code></div></div><ul><li>string 패키지에 있는 punctuation은 특수문자를 이야기함</li><li>nopunc는 특수문자를 제거하는 코드</li><li>clean_words는 특수문자를 제거한 nopunc에서 stopwords의 english에 있는 단어가 아닌것만 고른것</li></ul><p><br /></p><h3 id="27-결과-확인">2.7 결과 확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">messages</span><span class="p">[</span><span class="s">'text'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">process_text</span><span class="p">).</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0    [Go, jurong, point, crazy, Available, bugis, n...
1                       [Ok, lar, Joking, wif, u, oni]
2    [Free, entry, 2, wkly, comp, win, FA, Cup, fin...
3        [U, dun, say, early, hor, U, c, already, say]
4    [Nah, dont, think, goes, usf, lives, around, t...
Name: text, dtype: object
</pre></table></code></div></div><ul><li>특수문자는 제거되고, stopword에 없는 단어들만 남게 되었음</li></ul><p><br /></p><h3 id="28-훈련용-데이터-정리">2.8 훈련용 데이터 정리</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">msg_train</span><span class="p">,</span> <span class="n">msg_test</span><span class="p">,</span> <span class="n">class_train</span><span class="p">,</span> <span class="n">class_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">messages</span><span class="p">[</span><span class="s">'text'</span><span class="p">],</span> <span class="n">messages</span><span class="p">[</span><span class="s">'class'</span><span class="p">],</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>훈련용 데이터와 테스트용 데이터를 train_test_split 메서드로 사용하여 분리</li></ul><p><br /></p><h3 id="29-pipe-line-구축">2.9 Pipe Line 구축</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s">'vect'</span><span class="p">,</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="n">process_text</span><span class="p">)),</span>
    <span class="p">(</span><span class="s">'tfidf'</span><span class="p">,</span> <span class="n">TfidfTransformer</span><span class="p">()),</span>
    <span class="p">(</span><span class="s">'clf'</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">())</span>
<span class="p">])</span>
</pre></table></code></div></div><ul><li>뉴스기사 분석떄 처럼 Pipeline을 구축함</li></ul><p><br /></p><h3 id="210-학습">2.10 학습</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">pipeline</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">msg_train</span><span class="p">,</span> <span class="n">class_train</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Pipeline(steps=[('vect',
                 CountVectorizer(analyzer=&lt;function process_text at 0x7f8f263039d0&gt;)),
                ('tfidf', TfidfTransformer()), ('clf', MultinomialNB())])
</pre></table></code></div></div><ul><li>pipeline을 통과하여 학습함</li></ul><p><br /></p><h3 id="211-결과">2.11 결과</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">predictions</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">msg_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">class_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>              precision    recall  f1-score   support

         ham       0.96      1.00      0.98       949
        spam       1.00      0.77      0.87       166

    accuracy                           0.97      1115
   macro avg       0.98      0.88      0.92      1115
weighted avg       0.97      0.97      0.96      1115
</pre></table></code></div></div><ul><li>와 Acuuracy가 0.97이나 나옴</li></ul><p><br /></p><h3 id="212-confusion-matrix의-시각화">2.12 Confusion Matrix의 시각화</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">class_test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s">'d'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96459372-06300180-125d-11eb-81f4-13b28578cfc5.png" /></p><ul><li>Confusion Matrix를 Heatmap으로 시각화 한것</li><li>생각보다 잘맞추는 것에 대해 놀랐음</li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-science/'>Data Science</a>, <a href='/categories/machine-learning/'>Machine Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/fetch-20newsgroups/" class="post-tag no-text-decoration" >Fetch 20newsgroups</a> <a href="/tags/tfidf-transformer/" class="post-tag no-text-decoration" >Tfidf Transformer</a> <a href="/tags/count-vectorize/" class="post-tag no-text-decoration" >Count Vectorize</a> <a href="/tags/pipeline/" class="post-tag no-text-decoration" >Pipeline</a> <a href="/tags/sparse-matrix/" class="post-tag no-text-decoration" >Sparse Matrix</a> <a href="/tags/classification-report/" class="post-tag no-text-decoration" >Classification Report</a> <a href="/tags/multinomial-naive-bayes/" class="post-tag no-text-decoration" >Multinomial Naive Bayes</a> <a href="/tags/confusion-matrix/" class="post-tag no-text-decoration" >Confusion Matrix</a> <a href="/tags/spam/" class="post-tag no-text-decoration" >Spam</a> <a href="/tags/compression/" class="post-tag no-text-decoration" >Compression</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터 - Data Include Me&url=https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터 - Data Include Me&u=https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=나이즈 베이즈(Naive Bayes)를 사용한 유사문서와 스팸필터 - Data Include Me&url=https://datainclude.me/posts/%EB%82%98%EC%9D%B4%EC%A6%88_%EB%B2%A0%EC%9D%B4%EC%A6%88(Naive_Bayes)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%9C%A0%EC%82%AC%EB%AC%B8%EC%84%9C%EC%99%80_%EC%8A%A4%ED%8C%B8%ED%95%84%ED%84%B0/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Panel on right side (Desktop views) v2.3 © 2024 Your Name MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li class="recent-item"> <a href="/posts/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85_%EA%B0%80%EC%83%81%ED%99%94/">클라우드 컴퓨팅 - 가상화</a> <span class="text-muted small">2024-10-28</span></li><li class="recent-item"> <a href="/posts/gemini_api_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/">Gemini API 사용해보기</a> <span class="text-muted small">2024-03-12</span></li><li class="recent-item"> <a href="/posts/Ollama%EC%99%80_Python_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC_LLaMa2%EB%A5%BC_%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Ollama와 Python 라이브러리를 이용하여 LLaMa2를 로컬에서 사용하기</a> <span class="text-muted small">2024-02-13</span></li><li class="recent-item"> <a href="/posts/Mistral_7B_Fine_Tuning/">Mistral 7B 파인튜닝(Fine Tuning)하기</a> <span class="text-muted small">2023-10-25</span></li><li class="recent-item"> <a href="/posts/Penn_Fudan%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EA%B0%9D%EC%B2%B4_%ED%83%90%EC%A7%80_%EB%B6%84%ED%95%A0/">Penn-Fudan으로 알아보는 객체 탐지(Object Detection), 분할(Segmentation) with FasterRCNN</a> <span class="text-muted small">2023-10-23</span></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><style> .recent-item { margin-bottom: 0.5rem; } .recent-item a { color: var(--link-color); } .recent-item .small { font-size: 0.75rem; margin-left: 0.5rem; }</style></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%EC%A0%95%EB%B0%80%EB%8F%84(Precision)%EC%99%80_%EC%9E%AC%ED%98%84%EC%9C%A8(recall)/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 19, 2020 <i class="unloaded">2020-10-19T10:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>정밀도(Precision)와 재현율(Recall)</h3><div class="text-muted small"><p> 1. 정밀도와 재현율의 트레이드 오프 1.1 Wine Data로 실습 import pandas as pd wine_url = 'https://raw.githubusercontent.com/hmkim312/datas/main/wine/wine.csv' wine = pd.read_csv(wine_url, index_col=0) wine['tast...</p></div></div></a></div><div class="card"> <a href="/posts/%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8(Pipeline)/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 21, 2020 <i class="unloaded">2020-09-21T13:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>파이프라인(Pipeline)</h3><div class="text-muted small"><p> 1. 파이프라인(Pipeline) 1.1 Pipeline란 데이터를 가지고 분류기를 실행시킬때 하이퍼파라미터나 스케일러 등의 적용을 하다보면 코드의 순서가 바뀌는 등의 어려운 점이 있다. 해당 불편함을 해결해주는 Sklearn의 Pipeline이 있다. 쉽게 생각하여 데이터가 내가 설정한 대로 Pipe를 통과하여 여러개의 분류기나 스케일러...</p></div></div></a></div><div class="card"> <a href="/posts/%EB%AA%A8%EB%8D%B8_%ED%8F%89%EA%B0%80/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 22, 2020 <i class="unloaded">2020-09-22T21:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>모델 평가</h3><div class="text-muted small"><p> 1. 모델평가 1.1 모델 평가란? 생성한 모델을 좋다, 나쁘다, 그저 그렇다 라고 평가할 방법은 사실 없다 대부분 다양한 모델, 다양한 파라미터를 두고, 상대적으로 평가를 한다 2. 회귀 모델 2.1 회귀모델의 평가 회귀 모델은 실제 값과의 에러치를 가지고 평가를 함 2.1.1 MAE (Mean Absolute Err...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EC%A0%95%EB%B0%80%EB%8F%84(Precision)%EC%99%80_%EC%9E%AC%ED%98%84%EC%9C%A8(recall)/" class="btn btn-outline-primary"><p>정밀도(Precision)와 재현율(Recall)</p></a> <a href="/posts/%EB%84%A4%EC%9D%B4%EB%B2%84%EC%98%81%ED%99%94%ED%8F%89%EC%A0%90%EC%9D%84_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EA%B0%90%EC%A0%95%EB%B6%84%EC%84%9D/" class="btn btn-outline-primary"><p>네이버 영화 평점을 이용한 감성 분석</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://datainclude.me{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
