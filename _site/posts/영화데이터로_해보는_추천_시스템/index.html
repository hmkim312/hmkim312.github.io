<!DOCTYPE html><html lang="ko" mode="light" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>영화데이터로 해보는 추천 시스템(Recommendations) | Data Include Me</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="영화데이터로 해보는 추천 시스템(Recommendations)" /><meta name="author" content="HyunMin Kim" /><meta property="og:locale" content="ko" /><meta name="description" content="1. 추천 시스템 1.1 추천 시스템" /><meta property="og:description" content="1. 추천 시스템 1.1 추천 시스템" /><link rel="canonical" href="https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/" /><meta property="og:url" content="https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/" /><meta property="og:site_name" content="Data Include Me" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-25T09:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="영화데이터로 해보는 추천 시스템(Recommendations)" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@HyunMin Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HyunMin Kim"},"dateModified":"2020-10-25T09:00:00+09:00","datePublished":"2020-10-25T09:00:00+09:00","description":"1. 추천 시스템 1.1 추천 시스템","headline":"영화데이터로 해보는 추천 시스템(Recommendations)","mainEntityOfPage":{"@type":"WebPage","@id":"https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/"},"url":"https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/"}</script><meta property="og:image" content="https://datainclude.me/assets/img/sample/avatar.jpg" /> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="36x36" href="/assets/img/favicons/android-icon-36x36.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicons/android-icon-48x48.png"><link rel="icon" type="image/png" sizes="72x72" href="/assets/img/favicons/android-icon-72x72.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/android-icon-96x96.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/android-icon-144x144.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="70x70" href="/assets/img/favicons/ms-icon-70x70.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/ms-icon-144x144.png"><link rel="icon" type="image/png" sizes="150x150" href="/assets/img/favicons/ms-icon-150x150.png"><link rel="icon" type="image/png" sizes="310x310" href="/assets/img/favicons/ms-icon-310x310.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-MW9VRMW9" as="script"> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MW9VRMW9');</script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> </noscript> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9VRMW9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Data Include Me</a></div><div class="site-subtitle font-italic">Data Science Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hmkim312" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sanarial312','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>영화데이터로 해보는 추천 시스템(Recommendations)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <script type="text/javascript"> var lazyloadads = false; function loadAds() { if (!lazyloadads) { var script = document.createElement("script"); script.type = "text/javascript"; script.async = true; script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7594406644928408"; document.body.appendChild(script); lazyloadads = true; } } window.addEventListener("mousemove", loadAds, { once: true }); window.addEventListener('touchstart', loadAds, { once: true }); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>영화데이터로 해보는 추천 시스템(Recommendations)</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 25, 2020, 9:00 AM +0900" > Oct 25, 2020 <i class="unloaded">2020-10-25T09:00:00+09:00</i> </span> by <span class="author"> HyunMin Kim </span></div><a href="https://hits.seeyoufarm.com"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/%2F&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="페이지 조회수 뱃지", width: 100%;, height: 100%;/> </a></div><div class="post-content"><h2 id="1-추천-시스템">1. 추천 시스템</h2><hr /><h3 id="11-추천-시스템">1.1 추천 시스템</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97109867-16daee80-1719-11eb-882e-b9f736a1f188.png" /></p><ul><li>요즘 유튜브, 멜론 등등에는 추천 시스템이 적용되어 있음</li><li>특히 온라인 쇼핑몰 컨텐츠 등에서도 중요한 부분을 차지함</li><li>추천시스템은 콘텐츠 기반 필터링과 협업 필터링, 크개 2가지로 나뉜다.</li></ul><p><br /></p><h3 id="12-콘텐츠-기반-필터링-추천-시스템">1.2 콘텐츠 기반 필터링 추천 시스템</h3><ul><li>사용자가 특정한 아이템을 선호하는 경우 그 아이템과 비슷한 아이템을 추천하는 방식</li></ul><p><br /></p><h3 id="13-최근접-이웃-협업-필터링">1.3 최근접 이웃 협업 필터링</h3><ul><li>축적된 사용자 행동 데이터를 기반으로 사용자가 아직 평가하지 않은 아이템을 예측 평하</li><li>사용자 기반 : 당신과 비슷한 고객들이 다음 상품도 구매함</li><li>아이템 기반 : 이 상품을 선택한 다른 고객들은 다음 상품도 구매함</li><li>일반적으로는 사용자 기반 보다는 아이템기반 협업 필터링이 정확도가 더 높음<ul><li>비슷한 영화를 좋아한다고 취향이 비슷하다고 판단하기 어려움</li><li>매우 유명한 영화는 취향과 관계없이 관람하는 경우가 많음</li><li>사용자들이 평점을 매기지 않는 경우가 많음</li></ul></li></ul><p><br /></p><h3 id="14-잠재-요인-협업-필터링">1.4 잠재 요인 협업 필터링</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97107281-12f3a000-170a-11eb-9514-b20586241852.png" /></p><ul><li>사용자 - 아이템 평점 행렬 데이터를 이용해서 잠재요인을 도출하는 것</li><li>주요인과 아이템에 대한 잠재요인에 대해 행렬분해를 하고 다시 행렬곱을 통해 아직 평점을 부여하지 않은 아이템에 대한 예측 평점을 생성</li></ul><p><br /></p><h2 id="2-콘텐츠-기반-필터링-실습">2. 콘텐츠 기반 필터링 실습</h2><hr /><h3 id="21-tmdb5000-영화-데이터-세트">2.1 TMDB5000 영화 데이터 세트</h3><p><a href="https://www.kaggle.com/tmdb/tmdb-movie-metadata" target="_blank">https://www.kaggle.com/tmdb/tmdb-movie-metadata</a></p><ul><li>kaggle에 있는 TMDB5000 영화 데이터 세트</li><li>4803개의 영화 정보가 들어 있음</li></ul><p><br /></p><h3 id="22-데이터-로드">2.2 데이터 로드</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/tmdb5000/tmdb_5000_movies.csv'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">movies</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">movies</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(4803, 20)
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>budget<th>genres<th>homepage<th>id<th>keywords<th>original_language<th>original_title<th>overview<th>popularity<th>production_companies<th>production_countries<th>release_date<th>revenue<th>runtime<th>spoken_languages<th>status<th>tagline<th>title<th>vote_average<th>vote_count<tbody><tr><th>0<td>237000000<td>[{"id": 28, "name": "Action"}, {"id": 12, "nam...<td>http://www.avatarmovie.com/<td>19995<td>[{"id": 1463, "name": "culture clash"}, {"id":...<td>en<td>Avatar<td>In the 22nd century, a paraplegic Marine is di...<td>150.437577<td>[{"name": "Ingenious Film Partners", "id": 289...<td>[{"iso_3166_1": "US", "name": "United States o...<td>2009-12-10<td>2787965087<td>162.0<td>[{"iso_639_1": "en", "name": "English"}, {"iso...<td>Released<td>Enter the World of Pandora.<td>Avatar<td>7.2<td>11800<tr><th>1<td>300000000<td>[{"id": 12, "name": "Adventure"}, {"id": 14, "...<td>http://disney.go.com/disneypictures/pirates/<td>285<td>[{"id": 270, "name": "ocean"}, {"id": 726, "na...<td>en<td>Pirates of the Caribbean: At World's End<td>Captain Barbossa, long believed to be dead, ha...<td>139.082615<td>[{"name": "Walt Disney Pictures", "id": 2}, {"...<td>[{"iso_3166_1": "US", "name": "United States o...<td>2007-05-19<td>961000000<td>169.0<td>[{"iso_639_1": "en", "name": "English"}]<td>Released<td>At the end of the world, the adventure begins.<td>Pirates of the Caribbean: At World's End<td>6.9<td>4500<tr><th>2<td>245000000<td>[{"id": 28, "name": "Action"}, {"id": 12, "nam...<td>http://www.sonypictures.com/movies/spectre/<td>206647<td>[{"id": 470, "name": "spy"}, {"id": 818, "name...<td>en<td>Spectre<td>A cryptic message from Bond’s past sends him o...<td>107.376788<td>[{"name": "Columbia Pictures", "id": 5}, {"nam...<td>[{"iso_3166_1": "GB", "name": "United Kingdom"...<td>2015-10-26<td>880674609<td>148.0<td>[{"iso_639_1": "fr", "name": "Fran\u00e7ais"},...<td>Released<td>A Plan No One Escapes<td>Spectre<td>6.3<td>4466<tr><th>3<td>250000000<td>[{"id": 28, "name": "Action"}, {"id": 80, "nam...<td>http://www.thedarkknightrises.com/<td>49026<td>[{"id": 849, "name": "dc comics"}, {"id": 853,...<td>en<td>The Dark Knight Rises<td>Following the death of District Attorney Harve...<td>112.312950<td>[{"name": "Legendary Pictures", "id": 923}, {"...<td>[{"iso_3166_1": "US", "name": "United States o...<td>2012-07-16<td>1084939099<td>165.0<td>[{"iso_639_1": "en", "name": "English"}]<td>Released<td>The Legend Ends<td>The Dark Knight Rises<td>7.6<td>9106<tr><th>4<td>260000000<td>[{"id": 28, "name": "Action"}, {"id": 12, "nam...<td>http://movies.disney.com/john-carter<td>49529<td>[{"id": 818, "name": "based on novel"}, {"id":...<td>en<td>John Carter<td>John Carter is a war-weary, former military ca...<td>43.926995<td>[{"name": "Walt Disney Pictures", "id": 2}]<td>[{"iso_3166_1": "US", "name": "United States o...<td>2012-03-07<td>284139100<td>132.0<td>[{"iso_639_1": "en", "name": "English"}]<td>Released<td>Lost in our world, found in another.<td>John Carter<td>6.1<td>2124</table></div><p><br /></p><h3 id="23-데이터-선택">2.3 데이터 선택</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">movies_df</span> <span class="o">=</span> <span class="n">movies</span><span class="p">[[</span><span class="s">'id'</span><span class="p">,</span> <span class="s">'title'</span><span class="p">,</span> <span class="s">'genres'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">,</span>
                    <span class="s">'vote_count'</span><span class="p">,</span> <span class="s">'popularity'</span><span class="p">,</span> <span class="s">'keywords'</span><span class="p">,</span> <span class="s">'overview'</span><span class="p">]]</span>
<span class="n">movies_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>title<th>genres<th>vote_average<th>vote_count<th>popularity<th>keywords<th>overview<tbody><tr><th>0<td>19995<td>Avatar<td>[{"id": 28, "name": "Action"}, {"id": 12, "nam...<td>7.2<td>11800<td>150.437577<td>[{"id": 1463, "name": "culture clash"}, {"id":...<td>In the 22nd century, a paraplegic Marine is di...<tr><th>1<td>285<td>Pirates of the Caribbean: At World's End<td>[{"id": 12, "name": "Adventure"}, {"id": 14, "...<td>6.9<td>4500<td>139.082615<td>[{"id": 270, "name": "ocean"}, {"id": 726, "na...<td>Captain Barbossa, long believed to be dead, ha...<tr><th>2<td>206647<td>Spectre<td>[{"id": 28, "name": "Action"}, {"id": 12, "nam...<td>6.3<td>4466<td>107.376788<td>[{"id": 470, "name": "spy"}, {"id": 818, "name...<td>A cryptic message from Bond’s past sends him o...<tr><th>3<td>49026<td>The Dark Knight Rises<td>[{"id": 28, "name": "Action"}, {"id": 80, "nam...<td>7.6<td>9106<td>112.312950<td>[{"id": 849, "name": "dc comics"}, {"id": 853,...<td>Following the death of District Attorney Harve...<tr><th>4<td>49529<td>John Carter<td>[{"id": 28, "name": "Action"}, {"id": 12, "nam...<td>6.1<td>2124<td>43.926995<td>[{"id": 818, "name": "based on novel"}, {"id":...<td>John Carter is a war-weary, former military ca...</table></div><ul><li>실습에 필요한 컬럼만 가져옴</li><li>id : unique한 id</li><li>title : 영화제목</li><li>genres : 영화 장르</li><li>vote_average : 평균 평점</li><li>vote_count : 투표수</li><li>popularity : 인기점수</li><li>keywords : 키워드</li><li>overview : 영화 개요</li></ul><p><br /></p><h3 id="24-데이터-주의-사항">2.4 데이터 주의 사항</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">movies_df</span><span class="p">[[</span><span class="s">'genres'</span><span class="p">]][:</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>array([['[{"id": 28, "name": "Action"}, {"id": 12, "name": "Adventure"}, {"id": 14, "name": "Fantasy"}, {"id": 878, "name": "Science Fiction"}]']],
      dtype=object)
</pre></table></code></div></div><ul><li>genres와 keywords는 컬럼안에 dict형으로 저장되어 있음</li></ul><p><br /></p><h3 id="25-문자열로-된-데이터">2.5 문자열로 된 데이터</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>

<span class="n">code</span> <span class="o">=</span> <span class="s">"""(1,2, {'foo', 'bar'})"""</span>
<span class="n">code</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>("(1,2, {'foo', 'bar'})", str)
</pre></table></code></div></div><ul><li>genres와 keywords는 str로 되어 있음</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">literal_eval</span><span class="p">(</span><span class="n">code</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">code</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>((1, 2, {'bar', 'foo'}), tuple)
</pre></table></code></div></div><ul><li>literal_eval을 사용하여 tuple형태로 변경함</li></ul><p><br /></p><h3 id="26-genresdhk-keywords의-내용을-list와-dict으로-복구">2.6 genresdhk keywords의 내용을 list와 dict으로 복구</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">ast</span> <span class="kn">import</span> <span class="n">literal_eval</span>
<span class="kn">import</span> <span class="nn">warnings</span><span class="p">;</span> <span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>

<span class="n">movies_df</span><span class="p">[</span><span class="s">'genres'</span><span class="p">]</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'genres'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">literal_eval</span><span class="p">)</span>
<span class="n">movies_df</span><span class="p">[</span><span class="s">'keywords'</span><span class="p">]</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'keywords'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">literal_eval</span><span class="p">)</span>
<span class="n">movies_df</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>title<th>genres<th>vote_average<th>vote_count<th>popularity<th>keywords<th>overview<tbody><tr><th>0<td>19995<td>Avatar<td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...<td>7.2<td>11800<td>150.437577<td>[{'id': 1463, 'name': 'culture clash'}, {'id':...<td>In the 22nd century, a paraplegic Marine is di...<tr><th>1<td>285<td>Pirates of the Caribbean: At World's End<td>[{'id': 12, 'name': 'Adventure'}, {'id': 14, '...<td>6.9<td>4500<td>139.082615<td>[{'id': 270, 'name': 'ocean'}, {'id': 726, 'na...<td>Captain Barbossa, long believed to be dead, ha...<tr><th>2<td>206647<td>Spectre<td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...<td>6.3<td>4466<td>107.376788<td>[{'id': 470, 'name': 'spy'}, {'id': 818, 'name...<td>A cryptic message from Bond’s past sends him o...<tr><th>3<td>49026<td>The Dark Knight Rises<td>[{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...<td>7.6<td>9106<td>112.312950<td>[{'id': 849, 'name': 'dc comics'}, {'id': 853,...<td>Following the death of District Attorney Harve...<tr><th>4<td>49529<td>John Carter<td>[{'id': 28, 'name': 'Action'}, {'id': 12, 'nam...<td>6.1<td>2124<td>43.926995<td>[{'id': 818, 'name': 'based on novel'}, {'id':...<td>John Carter is a war-weary, former military ca...<tr><th>...<td>...<td>...<td>...<td>...<td>...<td>...<td>...<td>...<tr><th>4798<td>9367<td>El Mariachi<td>[{'id': 28, 'name': 'Action'}, {'id': 80, 'nam...<td>6.6<td>238<td>14.269792<td>[{'id': 5616, 'name': 'united states–mexico ba...<td>El Mariachi just wants to play his guitar and ...<tr><th>4799<td>72766<td>Newlyweds<td>[{'id': 35, 'name': 'Comedy'}, {'id': 10749, '...<td>5.9<td>5<td>0.642552<td>[]<td>A newlywed couple's honeymoon is upended by th...<tr><th>4800<td>231617<td>Signed, Sealed, Delivered<td>[{'id': 35, 'name': 'Comedy'}, {'id': 18, 'nam...<td>7.0<td>6<td>1.444476<td>[{'id': 248, 'name': 'date'}, {'id': 699, 'nam...<td>"Signed, Sealed, Delivered" introduces a dedic...<tr><th>4801<td>126186<td>Shanghai Calling<td>[]<td>5.7<td>7<td>0.857008<td>[]<td>When ambitious New York attorney Sam is sent t...<tr><th>4802<td>25975<td>My Date with Drew<td>[{'id': 99, 'name': 'Documentary'}]<td>6.3<td>16<td>1.929883<td>[{'id': 1523, 'name': 'obsession'}, {'id': 224...<td>Ever since the second grade when he first saw ...</table><p>4803 rows × 8 columns</p></div><ul><li>literal_eval을 사용하여 keywords와 genres를 list안에 dict으로 변경함</li></ul><p><br /></p><h3 id="27-dict의-value값을-특성으로-사용하도록-변경">2.7 dict의 value값을 특성으로 사용하도록 변경</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">movies_df</span><span class="p">[</span><span class="s">'genres'</span><span class="p">]</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'genres'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">movies_df</span><span class="p">[</span><span class="s">'keywords'</span><span class="p">]</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'keywords'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
<span class="n">movies_df</span><span class="p">[[</span><span class="s">'genres'</span><span class="p">,</span> <span class="s">'keywords'</span><span class="p">]][:</span><span class="mi">2</span><span class="p">]</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>genres<th>keywords<tbody><tr><th>0<td>[Action, Adventure, Fantasy, Science Fiction]<td>[culture clash, future, space war, space colon...<tr><th>1<td>[Adventure, Fantasy, Action]<td>[ocean, drug abuse, exotic island, east india ...</table></div><ul><li>dict 형태의 key : value로 들어있던 내용을, value값을 특성으로 사용하도록 for문과 lambda를 사용하여 해결</li></ul><p><br /></p><h3 id="28-genres의-각-단어들을-하나의-문장으로-변환">2.8 genres의 각 단어들을 하나의 문장으로 변환</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">movies_df</span><span class="p">[</span><span class="s">'genres_literal'</span><span class="p">]</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'genres'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="s">' '</span><span class="p">).</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">movies_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>title<th>genres<th>vote_average<th>vote_count<th>popularity<th>keywords<th>overview<th>genres_literal<tbody><tr><th>0<td>19995<td>Avatar<td>[Action, Adventure, Fantasy, Science Fiction]<td>7.2<td>11800<td>150.437577<td>[culture clash, future, space war, space colon...<td>In the 22nd century, a paraplegic Marine is di...<td>Action Adventure Fantasy Science Fiction<tr><th>1<td>285<td>Pirates of the Caribbean: At World's End<td>[Adventure, Fantasy, Action]<td>6.9<td>4500<td>139.082615<td>[ocean, drug abuse, exotic island, east india ...<td>Captain Barbossa, long believed to be dead, ha...<td>Adventure Fantasy Action<tr><th>2<td>206647<td>Spectre<td>[Action, Adventure, Crime]<td>6.3<td>4466<td>107.376788<td>[spy, based on novel, secret agent, sequel, mi...<td>A cryptic message from Bond’s past sends him o...<td>Action Adventure Crime<tr><th>3<td>49026<td>The Dark Knight Rises<td>[Action, Crime, Drama, Thriller]<td>7.6<td>9106<td>112.312950<td>[dc comics, crime fighter, terrorist, secret i...<td>Following the death of District Attorney Harve...<td>Action Crime Drama Thriller<tr><th>4<td>49529<td>John Carter<td>[Action, Adventure, Science Fiction]<td>6.1<td>2124<td>43.926995<td>[based on novel, mars, medallion, space travel...<td>John Carter is a war-weary, former military ca...<td>Action Adventure Science Fiction</table></div><ul><li>join을 사용하여 list로 되어있는 genres를 띄어쓰기로 된 컬럼을 생성</li></ul><p><br /></p><h3 id="29-genres를-countvectorize">2.9 genres를 countvectorize</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">min_df</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">genre_mat</span> <span class="o">=</span> <span class="n">count_vect</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">movies_df</span><span class="p">[</span><span class="s">'genres_literal'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">genre_mat</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(4803, 276)
</pre></table></code></div></div><ul><li>countvectorize를 하여 4803개의 영화에서 276개의 말뭉치 단어가 생김</li></ul><p><br /></p><h3 id="210-코사인-유사도">2.10 코사인 유사도</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">cosine_similarity</span>

<span class="n">genre_sim</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">genre_mat</span><span class="p">,</span> <span class="n">genre_mat</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">genre_sim</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">genre_sim</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>(4803, 4803)
[[1.         0.59628479 0.4472136  ... 0.         0.         0.        ]
 [0.59628479 1.         0.4        ... 0.         0.         0.        ]]
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97108313-14c06200-1710-11eb-8f85-30acec617b6c.png" /></p><ul><li>코사인 유사도를 통해, 아이템별로 비슷한 점수를 알수 있음</li></ul><p><br /></p><h3 id="211-genre_sim-높은값-순으로-정렬">2.11 genre_sim 높은값 순으로 정렬</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">genre_sim_sorted_ind</span> <span class="o">=</span> <span class="n">genre_sim</span><span class="p">.</span><span class="n">argsort</span><span class="p">()[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">genre_sim_sorted_ind</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[[   0 3494  813 ... 3038 3037 2401]]
</pre></table></code></div></div><p><br /></p><h3 id="212-추천-영화를-dataframe으로-반환하는-함수-생성">2.12 추천 영화를 DataFrame으로 반환하는 함수 생성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">find_sim_movie</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sorted_ind</span><span class="p">,</span> <span class="n">title_name</span><span class="p">,</span> <span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">title_movie</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">==</span> <span class="n">title_name</span><span class="p">]</span>
    
    <span class="n">title_index</span> <span class="o">=</span> <span class="n">title_movie</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">values</span>
    <span class="n">similar_indexes</span> <span class="o">=</span> <span class="n">sorted_ind</span><span class="p">[</span><span class="n">title_index</span><span class="p">,</span> <span class="p">:(</span><span class="n">top_n</span><span class="p">)]</span>
    
    <span class="k">print</span><span class="p">(</span><span class="n">similar_indexes</span><span class="p">)</span>
    <span class="n">similar_indexes</span> <span class="o">=</span> <span class="n">similar_indexes</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">similar_indexes</span><span class="p">]</span>
</pre></table></code></div></div><p><br /></p><h3 id="213-비슷한-영화-찾기">2.13 비슷한 영화 찾기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">similar_movies</span> <span class="o">=</span> <span class="n">find_sim_movie</span><span class="p">(</span><span class="n">movies_df</span><span class="p">,</span> <span class="n">genre_sim_sorted_ind</span><span class="p">,</span> <span class="s">'The Godfather'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">similar_movies</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">]]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[[2731 1243 3636 1946 2640 4065 1847 4217  883 3866]]
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>title<th>vote_average<tbody><tr><th>2731<td>The Godfather: Part II<td>8.3<tr><th>1243<td>Mean Streets<td>7.2<tr><th>3636<td>Light Sleeper<td>5.7<tr><th>1946<td>The Bad Lieutenant: Port of Call - New Orleans<td>6.0<tr><th>2640<td>Things to Do in Denver When You're Dead<td>6.7<tr><th>4065<td>Mi America<td>0.0<tr><th>1847<td>GoodFellas<td>8.2<tr><th>4217<td>Kids<td>6.8<tr><th>883<td>Catch Me If You Can<td>7.7<tr><th>3866<td>City of God<td>8.1</table></div><ul><li>대부2는 맞는거 같은데 그 아래는 좀..</li><li>문제가 있는듯 하다</li></ul><p><br /></p><h3 id="214-vote_average-확인">2.14 vote_average 확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">movies_df</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">,</span> <span class="s">'vote_count'</span><span class="p">]].</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'vote_average'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>title<th>vote_average<th>vote_count<tbody><tr><th>3519<td>Stiff Upper Lips<td>10.0<td>1<tr><th>4247<td>Me You and Five Bucks<td>10.0<td>2<tr><th>4045<td>Dancer, Texas Pop. 81<td>10.0<td>1<tr><th>4662<td>Little Big Top<td>10.0<td>1<tr><th>3992<td>Sardaarji<td>9.5<td>2<tr><th>2386<td>One Man's Hero<td>9.3<td>2<tr><th>2970<td>There Goes My Baby<td>8.5<td>2<tr><th>1881<td>The Shawshank Redemption<td>8.5<td>8205<tr><th>2796<td>The Prisoner of Zenda<td>8.4<td>11<tr><th>3337<td>The Godfather<td>8.4<td>5893</table></div><ul><li>평점과 평점을 매긴 횟수를 보면 문제 데이터가 보임</li><li>평점은 10점이나 횟수는 1점 등등..</li></ul><p><br /></p><h3 id="215-영화-선정을-위한-가중치-선정">2.15 영화 선정을 위한 가중치 선정</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97108663-5c47ed80-1712-11eb-89f9-e0c42828c698.png" /></p><ul><li>v : 개별 영화에 평점을 투표한 횟수</li><li>m : 평점을 부여하기 위한 최소 투표 횟수</li><li>R : 개별 영화에 대한 평균 평점</li><li>C : 전체 영화에 대한 평균 평점</li></ul><p><br /></p><h3 id="216-영화-전체-평균-평점과-최소-투표횟수를-60로-지정">2.16 영화 전체 평균 평점과 최소 투표횟수를 60%로 지정</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">C</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'vote_average'</span><span class="p">].</span><span class="n">mean</span><span class="p">()</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="s">'vote_count'</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'C:'</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s">'m:'</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C: 6.092 m: 370.2
</pre></table></code></div></div><ul><li>영화의 평균 평점은 6점정도이고, 최소 투표회수 60%지점은 약 370회</li><li>370회 미만의 평점 투표 영화는 제외 됨</li></ul><p><br /></p><h3 id="217-가중치가-부여된-평점을-계산하기-위한-함수-생성">2.17 가중치가 부여된 평점을 계산하기 위한 함수 생성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">weighted_vote_average</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s">'vote_count'</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s">'vote_average'</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="p">((</span><span class="n">v</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">m</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>위의 가중치 계산식을 함수로 작성</li></ul><p><br /></p><h3 id="218-다시-계산">2.18 다시 계산</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">movies_df</span><span class="p">[</span><span class="s">'weighted_vote'</span><span class="p">]</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">weighted_vote_average</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">movies_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>title<th>genres<th>vote_average<th>vote_count<th>popularity<th>keywords<th>overview<th>genres_literal<th>weighted_vote<tbody><tr><th>0<td>19995<td>Avatar<td>[Action, Adventure, Fantasy, Science Fiction]<td>7.2<td>11800<td>150.437577<td>[culture clash, future, space war, space colon...<td>In the 22nd century, a paraplegic Marine is di...<td>Action Adventure Fantasy Science Fiction<td>7.166301<tr><th>1<td>285<td>Pirates of the Caribbean: At World's End<td>[Adventure, Fantasy, Action]<td>6.9<td>4500<td>139.082615<td>[ocean, drug abuse, exotic island, east india ...<td>Captain Barbossa, long believed to be dead, ha...<td>Adventure Fantasy Action<td>6.838594<tr><th>2<td>206647<td>Spectre<td>[Action, Adventure, Crime]<td>6.3<td>4466<td>107.376788<td>[spy, based on novel, secret agent, sequel, mi...<td>A cryptic message from Bond’s past sends him o...<td>Action Adventure Crime<td>6.284091<tr><th>3<td>49026<td>The Dark Knight Rises<td>[Action, Crime, Drama, Thriller]<td>7.6<td>9106<td>112.312950<td>[dc comics, crime fighter, terrorist, secret i...<td>Following the death of District Attorney Harve...<td>Action Crime Drama Thriller<td>7.541095<tr><th>4<td>49529<td>John Carter<td>[Action, Adventure, Science Fiction]<td>6.1<td>2124<td>43.926995<td>[based on novel, mars, medallion, space travel...<td>John Carter is a war-weary, former military ca...<td>Action Adventure Science Fiction<td>6.098838</table></div><ul><li>전체 데이터에 함수 적용</li></ul><p><br /></p><h3 id="219-가중치-부여된-평점-순으로-정렬">2.19 가중치 부여된 평점 순으로 정렬</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">movies_df</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">,</span> <span class="s">'weighted_vote'</span><span class="p">,</span> <span class="s">'vote_count'</span><span class="p">]].</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'weighted_vote'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>title<th>vote_average<th>weighted_vote<th>vote_count<tbody><tr><th>1881<td>The Shawshank Redemption<td>8.5<td>8.396052<td>8205<tr><th>3337<td>The Godfather<td>8.4<td>8.263591<td>5893<tr><th>662<td>Fight Club<td>8.3<td>8.216455<td>9413<tr><th>3232<td>Pulp Fiction<td>8.3<td>8.207102<td>8428<tr><th>65<td>The Dark Knight<td>8.2<td>8.136930<td>12002<tr><th>1818<td>Schindler's List<td>8.3<td>8.126069<td>4329<tr><th>3865<td>Whiplash<td>8.3<td>8.123248<td>4254<tr><th>809<td>Forrest Gump<td>8.2<td>8.105954<td>7927<tr><th>2294<td>Spirited Away<td>8.3<td>8.105867<td>3840<tr><th>2731<td>The Godfather: Part II<td>8.3<td>8.079586<td>3338</table></div><ul><li>평점이 8.39 이상, 투표한 횟수가 적은 영화는 제외됨</li></ul><p><br /></p><h3 id="220-유사-영화-찾는-함수-변경">2.20 유사 영화 찾는 함수 변경</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">find_sim_movie</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">sorted_ind</span><span class="p">,</span> <span class="n">title_name</span><span class="p">,</span> <span class="n">top_n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">title_movie</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span> <span class="o">==</span> <span class="n">title_name</span><span class="p">]</span>
    <span class="n">title_index</span> <span class="o">=</span> <span class="n">title_movie</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">values</span>
    
    <span class="n">similar_indexes</span> <span class="o">=</span> <span class="n">sorted_ind</span><span class="p">[</span><span class="n">title_index</span><span class="p">,</span> <span class="p">:(</span><span class="n">top_n</span><span class="o">*</span><span class="mi">2</span><span class="p">)]</span>
    <span class="n">similar_indexes</span> <span class="o">=</span> <span class="n">similar_indexes</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">similar_indexes</span> <span class="o">=</span> <span class="n">similar_indexes</span><span class="p">[</span><span class="n">similar_indexes</span> <span class="o">!=</span> <span class="n">title_index</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">similar_indexes</span><span class="p">].</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'weighted_vote'</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span><span class="bp">False</span><span class="p">)[:</span><span class="n">top_n</span><span class="p">]</span>
</pre></table></code></div></div><ul><li>이전에 작성한 함수에서, 가중치를 부여한 평점을 추가함</li></ul><p><br /></p><h3 id="221-대부와-유사한-영화-찾기">2.21 대부와 유사한 영화 찾기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">similar_movies</span> <span class="o">=</span> <span class="n">find_sim_movie</span><span class="p">(</span><span class="n">movies_df</span><span class="p">,</span> <span class="n">genre_sim_sorted_ind</span><span class="p">,</span> <span class="s">'The Godfather'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">similar_movies</span><span class="p">[[</span><span class="s">'title'</span><span class="p">,</span> <span class="s">'vote_average'</span><span class="p">,</span> <span class="s">'weighted_vote'</span><span class="p">]]</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>title<th>vote_average<th>weighted_vote<tbody><tr><th>2731<td>The Godfather: Part II<td>8.3<td>8.079586<tr><th>1847<td>GoodFellas<td>8.2<td>7.976937<tr><th>3866<td>City of God<td>8.1<td>7.759693<tr><th>1663<td>Once Upon a Time in America<td>8.2<td>7.657811<tr><th>883<td>Catch Me If You Can<td>7.7<td>7.557097<tr><th>281<td>American Gangster<td>7.4<td>7.141396<tr><th>4041<td>This Is England<td>7.4<td>6.739664<tr><th>1149<td>American Hustle<td>6.8<td>6.717525<tr><th>1243<td>Mean Streets<td>7.2<td>6.626569<tr><th>2839<td>Rounders<td>6.9<td>6.530427</table></div><ul><li>아까보다는 좀 나은듯 하다. 가중치륿 부여해서 그런듯</li></ul><p><br /></p><h2 id="3-아이템-기반-최근접-이웃-협업-필터링">3. 아이템 기반 최근접 이웃 협업 필터링</h2><hr /><h3 id="31-무비렌즈-데이터">3.1 무비렌즈 데이터</h3><p><a href="https://grouplens.org/datasets/movielens/latest/" target="_blank">https://grouplens.org/datasets/movielens/latest/</a></p><ul><li>영화의 평점을 매긴 사용자와 영화 평점 행렬 등의 데이터</li><li>1메가짜리 small 데이터 다운</li></ul><p><br /></p><h3 id="32-데이터-불러오기">3.2 데이터 불러오기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/ml-latest-small/movies.csv'</span><span class="p">)</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/ml-latest-small/ratings.csv'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">movies</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ratings</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>(9742, 3)
(100836, 4)
</pre></table></code></div></div><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">movies</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>movieId<th>title<th>genres<tbody><tr><th>0<td>1<td>Toy Story (1995)<td>Adventure|Animation|Children|Comedy|Fantasy<tr><th>1<td>2<td>Jumanji (1995)<td>Adventure|Children|Fantasy<tr><th>2<td>3<td>Grumpier Old Men (1995)<td>Comedy|Romance<tr><th>3<td>4<td>Waiting to Exhale (1995)<td>Comedy|Drama|Romance<tr><th>4<td>5<td>Father of the Bride Part II (1995)<td>Comedy</table></div><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">ratings</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>userId<th>movieId<th>rating<th>timestamp<tbody><tr><th>0<td>1<td>1<td>4.0<td>964982703<tr><th>1<td>1<td>3<td>4.0<td>964981247<tr><th>2<td>1<td>6<td>4.0<td>964982224<tr><th>3<td>1<td>47<td>5.0<td>964983815<tr><th>4<td>1<td>50<td>5.0<td>964982931</table></div><ul><li>movie 데이터는 9742개로 영화 제목과 장르가 있음</li><li>ratings 데이터는 100836개로 영화 평점이 사용자별로 존재함</li></ul><p><br /></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97109307-e47bc200-1715-11eb-8956-067d54a470f1.png" /></p><ul><li>raw_data2개를 위 사진처럼 정리 해야함</li></ul><p><br /></p><h3 id="33-피벗테이블">3.3 피벗테이블</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[[</span><span class="s">'userId'</span><span class="p">,</span> <span class="s">'movieId'</span><span class="p">,</span> <span class="s">'rating'</span><span class="p">]]</span>
<span class="n">ratings_matrix</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s">'rating'</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="s">'userId'</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s">'movieId'</span><span class="p">)</span>
<span class="n">ratings_matrix</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th>movieId<th>1<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10<th>...<th>193565<th>193567<th>193571<th>193573<th>193579<th>193581<th>193583<th>193585<th>193587<th>193609<tr><th>userId<th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><tbody><tr><th>1<td>4.0<td>NaN<td>4.0<td>NaN<td>NaN<td>4.0<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>2<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>3<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>4<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>5<td>4.0<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN</table><p>5 rows × 9724 columns</p></div><ul><li>유저별 영화의 평점은 만들었다.</li><li>영화 이름이 id로 되어있어서 알수 없으니, movie 데이터에서 합치기</li></ul><p><br /></p><h3 id="34-ratings와-movie를-movieid로-결합">3.4 ratings와 movie를 movieId로 결합</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">rating_movies</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">movies</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'movieId'</span><span class="p">)</span>
<span class="n">rating_movies</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>userId<th>movieId<th>rating<th>title<th>genres<tbody><tr><th>0<td>1<td>1<td>4.0<td>Toy Story (1995)<td>Adventure|Animation|Children|Comedy|Fantasy<tr><th>1<td>5<td>1<td>4.0<td>Toy Story (1995)<td>Adventure|Animation|Children|Comedy|Fantasy<tr><th>2<td>7<td>1<td>4.5<td>Toy Story (1995)<td>Adventure|Animation|Children|Comedy|Fantasy<tr><th>3<td>15<td>1<td>2.5<td>Toy Story (1995)<td>Adventure|Animation|Children|Comedy|Fantasy<tr><th>4<td>17<td>1<td>4.5<td>Toy Story (1995)<td>Adventure|Animation|Children|Comedy|Fantasy</table></div><ul><li>rating에 title을 붙였으니, 다시 정리</li></ul><p><br /></p><h3 id="35-피벗테이블2">3.5 피벗테이블2</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[[</span><span class="s">'userId'</span><span class="p">,</span> <span class="s">'movieId'</span><span class="p">,</span> <span class="s">'rating'</span><span class="p">]]</span>
<span class="n">ratings_matrix</span> <span class="o">=</span> <span class="n">rating_movies</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s">'rating'</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="s">'userId'</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s">'title'</span><span class="p">)</span>
<span class="n">ratings_matrix</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th>title<th>'71 (2014)<th>'Hellboy': The Seeds of Creation (2004)<th>'Round Midnight (1986)<th>'Salem's Lot (2004)<th>'Til There Was You (1997)<th>'Tis the Season for Love (2015)<th>'burbs, The (1989)<th>'night Mother (1986)<th>(500) Days of Summer (2009)<th>*batteries not included (1987)<th>...<th>Zulu (2013)<th>[REC] (2007)<th>[REC]² (2009)<th>[REC]³ 3 Génesis (2012)<th>anohana: The Flower We Saw That Day - The Movie (2013)<th>eXistenZ (1999)<th>xXx (2002)<th>xXx: State of the Union (2005)<th>¡Three Amigos! (1986)<th>À nous la liberté (Freedom for Us) (1931)<tr><th>userId<th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><tbody><tr><th>1<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>4.0<td>NaN<tr><th>2<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>3<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>4<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<tr><th>5<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>...<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN</table><p>5 rows × 9719 columns</p></div><ul><li>이제는 유저가 영화에 점수를 준것을 정리함</li><li>단 NaN데이터가 있음</li></ul><p><br /></p><h3 id="36-nan-데이터-처리">3.6 NaN 데이터 처리</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">ratings_matrix</span> <span class="o">=</span> <span class="n">ratings_matrix</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ratings_matrix</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th>title<th>'71 (2014)<th>'Hellboy': The Seeds of Creation (2004)<th>'Round Midnight (1986)<th>'Salem's Lot (2004)<th>'Til There Was You (1997)<th>'Tis the Season for Love (2015)<th>'burbs, The (1989)<th>'night Mother (1986)<th>(500) Days of Summer (2009)<th>*batteries not included (1987)<th>...<th>Zulu (2013)<th>[REC] (2007)<th>[REC]² (2009)<th>[REC]³ 3 Génesis (2012)<th>anohana: The Flower We Saw That Day - The Movie (2013)<th>eXistenZ (1999)<th>xXx (2002)<th>xXx: State of the Union (2005)<th>¡Three Amigos! (1986)<th>À nous la liberté (Freedom for Us) (1931)<tr><th>userId<th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><tbody><tr><th>1<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>4.0<td>0.0<tr><th>2<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>3<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>4<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>5<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0</table><p>5 rows × 9719 columns</p></div><ul><li>NaN 데이터는 fillna를 사용해 0으로 채워줌</li></ul><p><br /></p><h3 id="37-행렬-transpose">3.7 행렬 transpose</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">ratings_matrix_T</span> <span class="o">=</span> <span class="n">ratings_matrix</span><span class="p">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">ratings_matrix_T</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th>userId<th>1<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10<th>...<th>601<th>602<th>603<th>604<th>605<th>606<th>607<th>608<th>609<th>610<tr><th>title<th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><tbody><tr><th>'71 (2014)<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>4.0<tr><th>'Hellboy': The Seeds of Creation (2004)<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>'Round Midnight (1986)<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>'Salem's Lot (2004)<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>'Til There Was You (1997)<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>...<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0</table><p>5 rows × 610 columns</p></div><ul><li>행렬의 유사도 측정을 하기 위해 행렬을 transpose함</li></ul><p><br /></p><h3 id="38-유사도-측정결과">3.8 유사도 측정결과</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">cosine_similarity</span>

<span class="n">item_sim</span> <span class="o">=</span> <span class="n">cosine_similarity</span><span class="p">(</span><span class="n">ratings_matrix_T</span><span class="p">,</span> <span class="n">ratings_matrix_T</span><span class="p">)</span>
<span class="n">item_sim_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">item_sim</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">ratings_matrix</span><span class="p">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">ratings_matrix</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">item_sim_df</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">item_sim_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(9719, 9719)
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th>title<th>'71 (2014)<th>'Hellboy': The Seeds of Creation (2004)<th>'Round Midnight (1986)<th>'Salem's Lot (2004)<th>'Til There Was You (1997)<th>'Tis the Season for Love (2015)<th>'burbs, The (1989)<th>'night Mother (1986)<th>(500) Days of Summer (2009)<th>*batteries not included (1987)<th>...<th>Zulu (2013)<th>[REC] (2007)<th>[REC]² (2009)<th>[REC]³ 3 Génesis (2012)<th>anohana: The Flower We Saw That Day - The Movie (2013)<th>eXistenZ (1999)<th>xXx (2002)<th>xXx: State of the Union (2005)<th>¡Three Amigos! (1986)<th>À nous la liberté (Freedom for Us) (1931)<tr><th>title<th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><th><tbody><tr><th>'71 (2014)<td>1.0<td>0.000000<td>0.000000<td>0.000000<td>0.000000<td>0.0<td>0.000000<td>0.0<td>0.141653<td>0.0<td>...<td>0.0<td>0.342055<td>0.543305<td>0.707107<td>0.0<td>0.0<td>0.139431<td>0.327327<td>0.0<td>0.0<tr><th>'Hellboy': The Seeds of Creation (2004)<td>0.0<td>1.000000<td>0.707107<td>0.000000<td>0.000000<td>0.0<td>0.000000<td>0.0<td>0.000000<td>0.0<td>...<td>0.0<td>0.000000<td>0.000000<td>0.000000<td>0.0<td>0.0<td>0.000000<td>0.000000<td>0.0<td>0.0<tr><th>'Round Midnight (1986)<td>0.0<td>0.707107<td>1.000000<td>0.000000<td>0.000000<td>0.0<td>0.176777<td>0.0<td>0.000000<td>0.0<td>...<td>0.0<td>0.000000<td>0.000000<td>0.000000<td>0.0<td>0.0<td>0.000000<td>0.000000<td>0.0<td>0.0<tr><th>'Salem's Lot (2004)<td>0.0<td>0.000000<td>0.000000<td>1.000000<td>0.857493<td>0.0<td>0.000000<td>0.0<td>0.000000<td>0.0<td>...<td>0.0<td>0.000000<td>0.000000<td>0.000000<td>0.0<td>0.0<td>0.000000<td>0.000000<td>0.0<td>0.0<tr><th>'Til There Was You (1997)<td>0.0<td>0.000000<td>0.000000<td>0.857493<td>1.000000<td>0.0<td>0.000000<td>0.0<td>0.000000<td>0.0<td>...<td>0.0<td>0.000000<td>0.000000<td>0.000000<td>0.0<td>0.0<td>0.000000<td>0.000000<td>0.0<td>0.0</table><p>5 rows × 9719 columns</p></div><ul><li>전체 영화에 대해 유사도 점수가 나옴</li></ul><p><br /></p><h3 id="39-대부와-유사한-영화는">3.9 대부와 유사한 영화는?</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">item_sim_df</span><span class="p">[</span><span class="s">'Godfather, The (1972)'</span><span class="p">].</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>title
Godfather, The (1972)                                    1.000000
Godfather: Part II, The (1974)                           0.821773
Goodfellas (1990)                                        0.664841
One Flew Over the Cuckoo's Nest (1975)                   0.620536
Star Wars: Episode IV - A New Hope (1977)                0.595317
Fargo (1996)                                             0.588614
Star Wars: Episode V - The Empire Strikes Back (1980)    0.586030
Fight Club (1999)                                        0.581279
Reservoir Dogs (1992)                                    0.579059
Pulp Fiction (1994)                                      0.575270
Name: Godfather, The (1972), dtype: float64
</pre></table></code></div></div><ul><li>대부2편, 등 스타워즈..음.. 잘 모르겠다</li></ul><p><br /></p><h3 id="310-인셉션과-비슷한-영화는">3.10 인셉션과 비슷한 영화는?</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">item_sim_df</span><span class="p">[</span><span class="s">'Inception (2010)'</span><span class="p">].</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>title
Inception (2010)                 1.000000
Dark Knight, The (2008)          0.727263
Inglourious Basterds (2009)      0.646103
Shutter Island (2010)            0.617736
Dark Knight Rises, The (2012)    0.617504
Fight Club (1999)                0.615417
Interstellar (2014)              0.608150
Up (2009)                        0.606173
Avengers, The (2012)             0.586504
Django Unchained (2012)          0.581342
Name: Inception (2010), dtype: float64
</pre></table></code></div></div><ul><li>다크나이트, 인터스텔라 등 뭔가 비슷해 보이기도 하는 영화가 나왔음</li></ul><p><br /></p><h2 id="4-요약">4. 요약</h2><hr /><h3 id="41-요약">4.1 요약</h3><ul><li>추천 시스템은 많은 분야에서 사용된다.</li><li>컨텐츠 기반, 아이템 기반 추천 시스템을 간단히 실습해보았다.</li><li>추천 시스템은 제대로 되었는지, 추천 받는 사람이 직접적인 평가를 해주지 않기 떄문에 사실 제대로 하고 있는지 알수 없다.</li><li>그래도, 넷플릭스, 유튜브 등 에서 추천알고리즘이 많이 사용되고 있고, 자연어처럼 발전이 무궁무진하다고 생각한다.</li><li>더 자세한 공부가 필요하다.</li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-science/'>Data Science</a>, <a href='/categories/machine-learning/'>Machine Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/recommendations/" class="post-tag no-text-decoration" >Recommendations</a> <a href="/tags/content-based-filtering/" class="post-tag no-text-decoration" >Content Based Filtering</a> <a href="/tags/collaborative-filtering/" class="post-tag no-text-decoration" >Collaborative Filtering</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=영화데이터로 해보는 추천 시스템(Recommendations) - Data Include Me&url=https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=영화데이터로 해보는 추천 시스템(Recommendations) - Data Include Me&u=https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=영화데이터로 해보는 추천 시스템(Recommendations) - Data Include Me&url=https://datainclude.me/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Panel on right side (Desktop views) v2.3 © 2024 Your Name MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li class="recent-item"> <a href="/posts/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85_%EA%B0%80%EC%83%81%ED%99%94/">클라우드 컴퓨팅 - 가상화</a> <span class="text-muted small">2024-10-28</span></li><li class="recent-item"> <a href="/posts/gemini_api_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/">Gemini API 사용해보기</a> <span class="text-muted small">2024-03-12</span></li><li class="recent-item"> <a href="/posts/Ollama%EC%99%80_Python_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC_LLaMa2%EB%A5%BC_%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Ollama와 Python 라이브러리를 이용하여 LLaMa2를 로컬에서 사용하기</a> <span class="text-muted small">2024-02-13</span></li><li class="recent-item"> <a href="/posts/Mistral_7B_Fine_Tuning/">Mistral 7B 파인튜닝(Fine Tuning)하기</a> <span class="text-muted small">2023-10-25</span></li><li class="recent-item"> <a href="/posts/Penn_Fudan%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EA%B0%9D%EC%B2%B4_%ED%83%90%EC%A7%80_%EB%B6%84%ED%95%A0/">Penn-Fudan으로 알아보는 객체 탐지(Object Detection), 분할(Segmentation) with FasterRCNN</a> <span class="text-muted small">2023-10-23</span></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><style> .recent-item { margin-bottom: 0.5rem; } .recent-item a { color: var(--link-color); } .recent-item .small { font-size: 0.75rem; margin-left: 0.5rem; }</style></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%EC%84%9C%ED%94%84%EB%9D%BC%EC%9D%B4%EC%A6%88(Surprise)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C(Recommendations)/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 26, 2020 <i class="unloaded">2020-10-26T09:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>서프라이즈(Surprise)를 사용한 추천시스템(Recommendations)</h3><div class="text-muted small"><p> 1. Surprise 1.1 Surprise란? https://antilibrary.org/2086 Surprise 는 추천 시스템을위한 사용하기 쉬운 Python scikit pip install scikit-surprise 1.2 Surprise 장점 다양한 추천 알고리즘 탑재 Surprise는 sklearn과 AP...</p></div></div></a></div><div class="card"> <a href="/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 26, 2020 <i class="unloaded">2020-10-26T10:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Good Books 데이터로 해보는 추천 시스템(Recommendations)</h3><div class="text-muted small"><p> 1. Good Books 1.1 Good Books 데이터 https://www.kaggle.com/zygmunt/goodbooks-10k ratings, books,tag, book_tags, to_read의 10k(10,000) 데이터 2. 추천 시스템 실습 2.1 Data load 2.1.1 Books data 1 2 3 4...</p></div></div></a></div><div class="card"> <a href="/posts/PCA_tSNE_LDA%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EC%B0%A8%EC%9B%90_%EC%B6%95%EC%86%8C/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 8, 2023 <i class="unloaded">2023-09-08T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PCA, t-SNE, LDA으로 알아보는 차원 축소</h3><div class="text-muted small"><p> 차원 축소는 데이터의 차원을 줄여서 데이터를 간결하게 만드는 기술이다. 시각화, 데이터 축소, 노이즈 제거, 성능 향상 및 계산 시간 감소를 위해 사용한다. 대표적인 차원 축소 알고리즘으로는 PCA, t-SNE, LDA가 있으며, 각 알고리즘은 장점과 단점이 있다. 차원 축소는 머신 러닝 모델의 성능에 긍부적 적인 영향을 미치며, 특성 선택과 차원 축...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_PCA%EC%99%80_kNN/" class="btn btn-outline-primary"><p>타이타닉 데이터로 해보는 PCA와 kNN</p></a> <a href="/posts/%EC%84%9C%ED%94%84%EB%9D%BC%EC%9D%B4%EC%A6%88(Surprise)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C(Recommendations)/" class="btn btn-outline-primary"><p>서프라이즈(Surprise)를 사용한 추천시스템(Recommendations)</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://datainclude.me{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
