<!DOCTYPE html><html lang="ko" mode="light" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>신용카드 부정 사용자 데이터로 해보는 부스팅 | Data Include Me</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="신용카드 부정 사용자 데이터로 해보는 부스팅" /><meta name="author" content="HyunMin Kim" /><meta property="og:locale" content="ko" /><meta name="description" content="1. 신용카드 부정사용자 검출 1.1 신용카드 부정사용자 검출 신용카드 사기 검출 분류 실습용 데이터 데이터에 class라는 이름의 컬럼이 사기 유무를 의미 class 컬럼의 불균형이 극심해서 전체 데이터의 약 0.172%가 사기(Fraud)를 가짐 금융 데이터이고, 기업의 기밀 보호를 위해 대다수의 특성이름은 삭제되어있음 Amount : 거래금액 Class : 사기 여부(1이면 Fraud)" /><meta property="og:description" content="1. 신용카드 부정사용자 검출 1.1 신용카드 부정사용자 검출 신용카드 사기 검출 분류 실습용 데이터 데이터에 class라는 이름의 컬럼이 사기 유무를 의미 class 컬럼의 불균형이 극심해서 전체 데이터의 약 0.172%가 사기(Fraud)를 가짐 금융 데이터이고, 기업의 기밀 보호를 위해 대다수의 특성이름은 삭제되어있음 Amount : 거래금액 Class : 사기 여부(1이면 Fraud)" /><link rel="canonical" href="https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/" /><meta property="og:url" content="https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/" /><meta property="og:site_name" content="Data Include Me" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-23T11:10:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="신용카드 부정 사용자 데이터로 해보는 부스팅" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@HyunMin Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HyunMin Kim"},"dateModified":"2020-10-23T11:10:00+09:00","datePublished":"2020-10-23T11:10:00+09:00","description":"1. 신용카드 부정사용자 검출 1.1 신용카드 부정사용자 검출 신용카드 사기 검출 분류 실습용 데이터 데이터에 class라는 이름의 컬럼이 사기 유무를 의미 class 컬럼의 불균형이 극심해서 전체 데이터의 약 0.172%가 사기(Fraud)를 가짐 금융 데이터이고, 기업의 기밀 보호를 위해 대다수의 특성이름은 삭제되어있음 Amount : 거래금액 Class : 사기 여부(1이면 Fraud)","headline":"신용카드 부정 사용자 데이터로 해보는 부스팅","mainEntityOfPage":{"@type":"WebPage","@id":"https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/"},"url":"https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/"}</script><meta property="og:image" content="https://datainclude.me/assets/img/sample/avatar.jpg" /> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="36x36" href="/assets/img/favicons/android-icon-36x36.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicons/android-icon-48x48.png"><link rel="icon" type="image/png" sizes="72x72" href="/assets/img/favicons/android-icon-72x72.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/android-icon-96x96.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/android-icon-144x144.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="70x70" href="/assets/img/favicons/ms-icon-70x70.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/ms-icon-144x144.png"><link rel="icon" type="image/png" sizes="150x150" href="/assets/img/favicons/ms-icon-150x150.png"><link rel="icon" type="image/png" sizes="310x310" href="/assets/img/favicons/ms-icon-310x310.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-MW9VRMW9" as="script"> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MW9VRMW9');</script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> </noscript> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9VRMW9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Data Include Me</a></div><div class="site-subtitle font-italic">Data Science Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hmkim312" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sanarial312','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>신용카드 부정 사용자 데이터로 해보는 부스팅</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <script type="text/javascript"> var lazyloadads = false; function loadAds() { if (!lazyloadads) { var script = document.createElement("script"); script.type = "text/javascript"; script.async = true; script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7594406644928408"; document.body.appendChild(script); lazyloadads = true; } } window.addEventListener("mousemove", loadAds, { once: true }); window.addEventListener('touchstart', loadAds, { once: true }); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>신용카드 부정 사용자 데이터로 해보는 부스팅</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Oct 23, 2020, 11:10 AM +0900" > Oct 23, 2020 <i class="unloaded">2020-10-23T11:10:00+09:00</i> </span> by <span class="author"> HyunMin Kim </span></div><a href="https://hits.seeyoufarm.com"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/%2F&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="페이지 조회수 뱃지", width: 100%;, height: 100%;/> </a></div><div class="post-content"><h2 id="1-신용카드-부정사용자-검출">1. 신용카드 부정사용자 검출</h2><hr /><h2 id="11-신용카드-부정사용자-검출">1.1 신용카드 부정사용자 검출</h2><ul><li>신용카드 사기 검출 분류 실습용 데이터</li><li>데이터에 class라는 이름의 컬럼이 사기 유무를 의미</li><li>class 컬럼의 불균형이 극심해서 전체 데이터의 약 0.172%가 사기(Fraud)를 가짐</li><li>금융 데이터이고, 기업의 기밀 보호를 위해 대다수의 특성이름은 삭제되어있음</li><li>Amount : 거래금액</li><li>Class : 사기 여부(1이면 Fraud)</li></ul><p><br /></p><h2 id="12-데이터-로드">1.2 데이터 로드</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">raw_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/creditcard/creditcard.csv'</span><span class="p">)</span>
<span class="n">raw_data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>Time<th>V1<th>V2<th>V3<th>V4<th>V5<th>V6<th>V7<th>V8<th>V9<th>...<th>V21<th>V22<th>V23<th>V24<th>V25<th>V26<th>V27<th>V28<th>Amount<th>Class<tbody><tr><th>0<td>0.0<td>-1.359807<td>-0.072781<td>2.536347<td>1.378155<td>-0.338321<td>0.462388<td>0.239599<td>0.098698<td>0.363787<td>...<td>-0.018307<td>0.277838<td>-0.110474<td>0.066928<td>0.128539<td>-0.189115<td>0.133558<td>-0.021053<td>149.62<td>0<tr><th>1<td>0.0<td>1.191857<td>0.266151<td>0.166480<td>0.448154<td>0.060018<td>-0.082361<td>-0.078803<td>0.085102<td>-0.255425<td>...<td>-0.225775<td>-0.638672<td>0.101288<td>-0.339846<td>0.167170<td>0.125895<td>-0.008983<td>0.014724<td>2.69<td>0<tr><th>2<td>1.0<td>-1.358354<td>-1.340163<td>1.773209<td>0.379780<td>-0.503198<td>1.800499<td>0.791461<td>0.247676<td>-1.514654<td>...<td>0.247998<td>0.771679<td>0.909412<td>-0.689281<td>-0.327642<td>-0.139097<td>-0.055353<td>-0.059752<td>378.66<td>0<tr><th>3<td>1.0<td>-0.966272<td>-0.185226<td>1.792993<td>-0.863291<td>-0.010309<td>1.247203<td>0.237609<td>0.377436<td>-1.387024<td>...<td>-0.108300<td>0.005274<td>-0.190321<td>-1.175575<td>0.647376<td>-0.221929<td>0.062723<td>0.061458<td>123.50<td>0<tr><th>4<td>2.0<td>-1.158233<td>0.877737<td>1.548718<td>0.403034<td>-0.407193<td>0.095921<td>0.592941<td>-0.270533<td>0.817739<td>...<td>-0.009431<td>0.798278<td>-0.137458<td>0.141267<td>-0.206010<td>0.502292<td>0.219422<td>0.215153<td>69.99<td>0</table><p>5 rows × 31 columns</p></div><h3 id="13-특성확인">1.3 특성확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">raw_data</span><span class="p">.</span><span class="n">columns</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Index(['Time', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9', 'V10',
       'V11', 'V12', 'V13', 'V14', 'V15', 'V16', 'V17', 'V18', 'V19', 'V20',
       'V21', 'V22', 'V23', 'V24', 'V25', 'V26', 'V27', 'V28', 'Amount',
       'Class'],
      dtype='object')
</pre></table></code></div></div><ul><li>데이터의 특성은 여러가지의 이유로 감추어져 있어서 V1, V2 이런식임</li></ul><p><br /></p><h3 id="14-데이터-라벨의-불균형-확인">1.4 데이터 라벨의 불균형 확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">raw_data</span><span class="p">[</span><span class="s">'Class'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>0    284315
1       492
Name: Class, dtype: int64
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">fraud_rate</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s">'Class'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Frauds </span><span class="si">{</span><span class="n">fraud_rate</span><span class="si">}</span><span class="s">% of the dataset'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Frauds 0.17% of the dataset
</pre></table></code></div></div><ul><li>실제로 부정사용자는 전체 데이터의 0.17% 밖에 안됨</li><li>그렇기 때문에 정확히 잘 잡는게 중요함</li></ul><p><br /></p><h3 id="15-그래프로도-안보임">1.5 그래프로도 안보임</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="s">'Class'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">raw_data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Class Distributions </span><span class="se">\n</span><span class="s"> (0 : No Fraud || 1 : Fraud)'</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000519-caa17a00-1571-11eb-8c35-23fa88097b9a.png" /></p><ul><li>title을 적을때 \n하면 줄바꿈이 됨</li></ul><p><br /></p><h3 id="16-x-y-로-데이터-나누기">1.6 X, y 로 데이터 나누기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>stratify : Data의 비율을 유지시킴<ul><li>만약 Y가 Data가 25%의 0과 75%의 1로 이루어진 Binary Set일 때, stratify=Y로 설정하면 나누어진 데이터셋들도 0과 1을 각각 25%, 75%로 유지한 채 분할됨</li></ul></li></ul><p><br /></p><h3 id="17-불균형-정도-확인">1.7 불균형 정도 확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(array([0, 1]), array([199020,    344]))
</pre></table></code></div></div><ul><li>np.unique에서 retunr_counts를 하면 각 갯수를 보여줌</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0.17254870488152324
</pre></table></code></div></div><ul><li>train 데이터에서의 불균형도 엄청남</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(array([0, 1]), array([85295,   148]))
</pre></table></code></div></div><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0.17321489179921118
</pre></table></code></div></div><ul><li>test 데이터에서의 불균형</li></ul><p><br /></p><h2 id="2-첫번째-스탭">2. 첫번째 스탭</h2><hr /><h3 id="21-분류기의-성능을-측정하는-함수-작성">2.1 분류기의 성능을 측정하는 함수 작성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="p">(</span><span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">):</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">pre</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">re</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">acc</span><span class="p">,</span> <span class="n">pre</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">auc</span>
</pre></table></code></div></div><ul><li>각 분류기들의 accuracy, precision, recall, f1, roc를 볼수 있는 함수 작성</li></ul><p><br /></p><h3 id="22-성능을-출력하는-함수-작성">2.2 성능을 출력하는 함수 작성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="k">def</span> <span class="nf">print_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">):</span>
    <span class="n">confusion</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    <span class="n">acc</span><span class="p">,</span> <span class="n">pre</span> <span class="p">,</span><span class="n">re</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">auc</span> <span class="o">=</span> <span class="n">get_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">'==&gt; confusion matrix'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">confusion</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'========='</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Accuracy : {0:4f}, Precision : {1:4f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">pre</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Recall : {0:4f}, F1 : {1:4f}, AUC : {2:4f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">re</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">auc</span><span class="p">))</span>
</pre></table></code></div></div><ul><li>모델별로 위에서 생성한 score를 출력하는 함수 작성</li></ul><p><br /></p><h3 id="23-logistic-regression">2.3 Logistic Regression</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="n">lr_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s">'liblinear'</span><span class="p">)</span>
<span class="n">lr_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">lr_pred</span> <span class="o">=</span> <span class="n">lr_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">print_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">lr_pred</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>==&gt; confusion matrix
[[85284    11]
 [   60    88]]
=========
Accuracy : 0.999169, Precision : 0.888889
Recall : 0.594595, F1 : 0.712551, AUC : 0.797233
</pre></table></code></div></div><ul><li>accuracy가 0.99??</li></ul><p><br /></p><h3 id="24-decision-tree">2.4 Decision Tree</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">dt_clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">dt_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">dt_pred</span> <span class="o">=</span> <span class="n">dt_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">print_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dt_pred</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>==&gt; confusion matrix
[[85281    14]
 [   42   106]]
=========
Accuracy : 0.999345, Precision : 0.883333
Recall : 0.716216, F1 : 0.791045, AUC : 0.858026
</pre></table></code></div></div><ul><li>이것도 accuracy가 0.99?</li></ul><p><br /></p><h3 id="25-random-forest">2.5 Random Forest</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">rf_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">rf_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">rf_pred</span> <span class="o">=</span> <span class="n">rf_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">print_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rf_pred</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>==&gt; confusion matrix
[[85290     5]
 [   38   110]]
=========
Accuracy : 0.999497, Precision : 0.956522
Recall : 0.743243, F1 : 0.836502, AUC : 0.871592
</pre></table></code></div></div><ul><li>마찬가지로 성능이 좋아보인다</li></ul><p><br /></p><h3 id="26-lightgbm">2.6 LightGBM</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">lightgbm</span> <span class="kn">import</span> <span class="n">LGBMClassifier</span>

<span class="n">lgbm_clf</span> <span class="o">=</span> <span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_leaves</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">boost_from_average</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>

<span class="n">lgbm_clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">lgbm_pred</span> <span class="o">=</span> <span class="n">lgbm_clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">print_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">lgbm_pred</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>==&gt; confusion matrix
[[85289     6]
 [   34   114]]
=========
Accuracy : 0.999532, Precision : 0.950000
Recall : 0.770270, F1 : 0.850746, AUC : 0.885100
</pre></table></code></div></div><ul><li>이것도 0.99가 나온다.</li></ul><p><br /></p><h2 id="3-전체-모델을-한번에-볼수있게-하기">3. 전체 모델을 한번에 볼수있게 하기</h2><hr /><h3 id="31-모델과-데이터를-주면-성능을-출력하는-함수-작성">3.1 모델과 데이터를 주면 성능을 출력하는 함수 작성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_result</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">get_clf_eval</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h3 id="32-다수의-모델의-성능을-정리해서-dataframe으로-반환하는-함수-작성">3.2 다수의 모델의 성능을 정리해서 DataFrame으로 반환하는 함수 작성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_result_pd</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">col_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'accuracy'</span><span class="p">,</span> <span class="s">'precision'</span><span class="p">,</span> <span class="s">'recall'</span><span class="p">,</span> <span class="s">'f1'</span><span class="p">,</span> <span class="s">'roc_acu'</span><span class="p">]</span>
    
    <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_result</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col_names</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">model_names</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h3 id="33-4개의-분류-모델을-한번에-표로-정리하기">3.3 4개의 분류 모델을 한번에 표로 정리하기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">time</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">dt_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">lgbm_clf</span><span class="p">]</span>

<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LinearReg'</span><span class="p">,</span> <span class="s">'DecisionTree'</span><span class="p">,</span> <span class="s">'RandomForest'</span><span class="p">,</span> <span class="s">'LightGBM'</span><span class="p">]</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">get_result_pd</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Fit time : '</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="n">results</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Fit time :  26.41209316253662
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>accuracy<th>precision<th>recall<th>f1<th>roc_acu<tbody><tr><th>LinearReg<td>0.999169<td>0.888889<td>0.594595<td>0.712551<td>0.797233<tr><th>DecisionTree<td>0.999345<td>0.883333<td>0.716216<td>0.791045<td>0.858026<tr><th>RandomForest<td>0.999497<td>0.956522<td>0.743243<td>0.836502<td>0.871592<tr><th>LightGBM<td>0.999532<td>0.950000<td>0.770270<td>0.850746<td>0.885100</table></div><ul><li>앙상블 계열의 성능이 우수함을 알수 있음</li></ul><p><br /></p><h2 id="4-데이터를-정리해서-다시-도전해보기">4. 데이터를 정리해서 다시 도전해보기</h2><hr /><h3 id="41-raw_data의-amount-컬럼-확인">4.1 raw_data의 Amount 컬럼 확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s">'Amount'</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000523-cbd2a700-1571-11eb-9548-1fb99aa91de7.png" /></p><ul><li>특정 구간의 분포가 많음</li></ul><p><br /></p><h3 id="42-amount-컬럼에-standardscaler-적용">4.2 Amount 컬럼에 StandardScaler 적용</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">amount_n</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s">'Amount'</span><span class="p">].</span><span class="n">values</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">raw_data_copy</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">raw_data_copy</span><span class="p">[</span><span class="s">'Amount_Scaled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">amount_n</span>
<span class="n">raw_data_copy</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>V1<th>V2<th>V3<th>V4<th>V5<th>V6<th>V7<th>V8<th>V9<th>V10<th>...<th>V20<th>V21<th>V22<th>V23<th>V24<th>V25<th>V26<th>V27<th>V28<th>Amount_Scaled<tbody><tr><th>0<td>-1.359807<td>-0.072781<td>2.536347<td>1.378155<td>-0.338321<td>0.462388<td>0.239599<td>0.098698<td>0.363787<td>0.090794<td>...<td>0.251412<td>-0.018307<td>0.277838<td>-0.110474<td>0.066928<td>0.128539<td>-0.189115<td>0.133558<td>-0.021053<td>0.244964<tr><th>1<td>1.191857<td>0.266151<td>0.166480<td>0.448154<td>0.060018<td>-0.082361<td>-0.078803<td>0.085102<td>-0.255425<td>-0.166974<td>...<td>-0.069083<td>-0.225775<td>-0.638672<td>0.101288<td>-0.339846<td>0.167170<td>0.125895<td>-0.008983<td>0.014724<td>-0.342475<tr><th>2<td>-1.358354<td>-1.340163<td>1.773209<td>0.379780<td>-0.503198<td>1.800499<td>0.791461<td>0.247676<td>-1.514654<td>0.207643<td>...<td>0.524980<td>0.247998<td>0.771679<td>0.909412<td>-0.689281<td>-0.327642<td>-0.139097<td>-0.055353<td>-0.059752<td>1.160686<tr><th>3<td>-0.966272<td>-0.185226<td>1.792993<td>-0.863291<td>-0.010309<td>1.247203<td>0.237609<td>0.377436<td>-1.387024<td>-0.054952<td>...<td>-0.208038<td>-0.108300<td>0.005274<td>-0.190321<td>-1.175575<td>0.647376<td>-0.221929<td>0.062723<td>0.061458<td>0.140534<tr><th>4<td>-1.158233<td>0.877737<td>1.548718<td>0.403034<td>-0.407193<td>0.095921<td>0.592941<td>-0.270533<td>0.817739<td>0.753074<td>...<td>0.408542<td>-0.009431<td>0.798278<td>-0.137458<td>0.141267<td>-0.206010<td>0.502292<td>0.219422<td>0.215153<td>-0.073403</table><p>5 rows × 29 columns</p></div><ul><li>일단 모든 데이터에 Scaler를 적용함</li></ul><p><br /></p><h3 id="43-데이터-나누기">4.3 데이터 나누기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">raw_data_copy</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h3 id="44-모델-재-평가">4.4 모델 재 평가</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">time</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">dt_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">lgbm_clf</span><span class="p">]</span>

<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LinearReg'</span><span class="p">,</span> <span class="s">'DecisionTree'</span><span class="p">,</span> <span class="s">'RandomForest'</span><span class="p">,</span> <span class="s">'LightGBM'</span><span class="p">]</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">get_result_pd</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Fit time : '</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="n">results</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Fit time :  23.386101961135864
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>accuracy<th>precision<th>recall<th>f1<th>roc_acu<tbody><tr><th>LinearReg<td>0.999169<td>0.888889<td>0.594595<td>0.712551<td>0.797233<tr><th>DecisionTree<td>0.999345<td>0.883333<td>0.716216<td>0.791045<td>0.858026<tr><th>RandomForest<td>0.999497<td>0.956522<td>0.743243<td>0.836502<td>0.871592<tr><th>LightGBM<td>0.999520<td>0.949580<td>0.763514<td>0.846442<td>0.881722</table></div><h3 id="45-모델별-roc커브">4.5 모델별 ROC커브</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span>


<span class="k">def</span> <span class="nf">draw_roc_curve</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)):</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">model</span><span class="p">].</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="n">model</span><span class="p">])</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">'k--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'random quess'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'ROC'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    
<span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000524-cc6b3d80-1571-11eb-802b-3e912d11adf1.png" /></p><ul><li>딱히 변화는 없어보인다.</li><li>스케일링을 다른것으로 해볼까?</li></ul><p><br /></p><h3 id="46-log-scale">4.6 log scale</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">amount_log</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">raw_data</span><span class="p">[</span><span class="s">'Amount'</span><span class="p">])</span>

<span class="n">raw_data_copy</span><span class="p">[</span><span class="s">'Amount_Scaled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">amount_log</span>
<span class="n">raw_data_copy</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>V1<th>V2<th>V3<th>V4<th>V5<th>V6<th>V7<th>V8<th>V9<th>V10<th>...<th>V20<th>V21<th>V22<th>V23<th>V24<th>V25<th>V26<th>V27<th>V28<th>Amount_Scaled<tbody><tr><th>0<td>-1.359807<td>-0.072781<td>2.536347<td>1.378155<td>-0.338321<td>0.462388<td>0.239599<td>0.098698<td>0.363787<td>0.090794<td>...<td>0.251412<td>-0.018307<td>0.277838<td>-0.110474<td>0.066928<td>0.128539<td>-0.189115<td>0.133558<td>-0.021053<td>5.014760<tr><th>1<td>1.191857<td>0.266151<td>0.166480<td>0.448154<td>0.060018<td>-0.082361<td>-0.078803<td>0.085102<td>-0.255425<td>-0.166974<td>...<td>-0.069083<td>-0.225775<td>-0.638672<td>0.101288<td>-0.339846<td>0.167170<td>0.125895<td>-0.008983<td>0.014724<td>1.305626<tr><th>2<td>-1.358354<td>-1.340163<td>1.773209<td>0.379780<td>-0.503198<td>1.800499<td>0.791461<td>0.247676<td>-1.514654<td>0.207643<td>...<td>0.524980<td>0.247998<td>0.771679<td>0.909412<td>-0.689281<td>-0.327642<td>-0.139097<td>-0.055353<td>-0.059752<td>5.939276<tr><th>3<td>-0.966272<td>-0.185226<td>1.792993<td>-0.863291<td>-0.010309<td>1.247203<td>0.237609<td>0.377436<td>-1.387024<td>-0.054952<td>...<td>-0.208038<td>-0.108300<td>0.005274<td>-0.190321<td>-1.175575<td>0.647376<td>-0.221929<td>0.062723<td>0.061458<td>4.824306<tr><th>4<td>-1.158233<td>0.877737<td>1.548718<td>0.403034<td>-0.407193<td>0.095921<td>0.592941<td>-0.270533<td>0.817739<td>0.753074<td>...<td>0.408542<td>-0.009431<td>0.798278<td>-0.137458<td>0.141267<td>-0.206010<td>0.502292<td>0.219422<td>0.215153<td>4.262539</table><p>5 rows × 29 columns</p></div><ul><li>단위수가 너무 큰 값들을 바로 회귀분석 할 경우, 결과를 왜곡할 우려가 있으므로 이를 방지하기 위해.</li><li>독립변수와 종속변수의 변화관계에서 절대량이 아닌 비율을 확인하기 위해</li><li>비선형관계의 데이터를 선형으로 만들기 위해</li></ul><p><br /></p><h3 id="47-log-scale-후의-분포">4.7 Log scale 후의 분포</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">raw_data_copy</span><span class="p">[</span><span class="s">'Amount_Scaled'</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000525-cd9c6a80-1571-11eb-89c0-0891604103c5.png" /></p><ul><li>log를 취해주니, 분포의 변화가 생겼음</li></ul><p><br /></p><h3 id="48-성능-평가">4.8 성능 평가</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">time</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">dt_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">lgbm_clf</span><span class="p">]</span>

<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LinearReg'</span><span class="p">,</span> <span class="s">'DecisionTree'</span><span class="p">,</span> <span class="s">'RandomForest'</span><span class="p">,</span> <span class="s">'LightGBM'</span><span class="p">]</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">get_result_pd</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Fit time : '</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="n">results</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Fit time :  23.800795793533325
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>accuracy<th>precision<th>recall<th>f1<th>roc_acu<tbody><tr><th>LinearReg<td>0.999169<td>0.888889<td>0.594595<td>0.712551<td>0.797233<tr><th>DecisionTree<td>0.999345<td>0.883333<td>0.716216<td>0.791045<td>0.858026<tr><th>RandomForest<td>0.999497<td>0.956522<td>0.743243<td>0.836502<td>0.871592<tr><th>LightGBM<td>0.999520<td>0.949580<td>0.763514<td>0.846442<td>0.881722</table></div><p><br /></p><h3 id="49-roc-커브-결과">4.9 ROC 커브 결과</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000528-cd9c6a80-1571-11eb-8059-65b47f3fc21d.png" /></p><ul><li>이것도 큰 변화는 없음</li></ul><p><br /></p><h2 id="5-boxplot">5. Boxplot</h2><hr /><h3 id="51-boxplot">5.1 Boxplot</h3><ul><li>갑자기 중간에 Boxplot을 넣은 이유는 데이터의 Outlier를 이야기하기 위해서</li><li>위의 데이터에서 Scale을 진행하고도 큰 변화가 없기에 outlier를 제거를 해보려고함</li><li>Boxplot이 Outlier를 보기 쉽다</li><li>물론 Outlier라고 판단하는건 그외의 다른 도메인 지식의 영향이 있을수 있음</li></ul><p><br /></p><h3 id="52-boxplot의-구성">5.2 Boxplot의 구성</h3><ul><li>최소값 : 제 1사분위에서 1.5 IQR1을 뺀 위치이다.</li><li>제 1사분위(Q1) : 25%의 위치를 의미한다.</li><li>제 2사분위(Q2) : 50%의 위치로 중앙값(median)을 의미한다.</li><li>제 3사분위(Q3) : 75%의 위치를 의미한다.</li><li>최대값 : 제 3사분위에서 1.5 IQR을 더한 위치이다.</li><li>최소값과 최대값을 넘어가는 위치에 있는 값을 이상치(Outlier)라고 부른다.</li></ul><p><br /></p><h3 id="53-간단한-데이터로-실습">5.3 간단한 데이터로 실습</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>
<span class="n">tmp_y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">tmp_y</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">tmp_y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000531-ce350100-1571-11eb-9991-f700a08b0d23.png" /></p><h3 id="54-해당-위치의-지표-찾기">5.4 해당 위치의 지표 찾기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'1사 분위 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'2사 분위 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">median</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'3사 분위 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'IQR : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'1.5 IQR : </span><span class="si">{</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'최소값 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">)))</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'최대값 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">)))</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>1사 분위 : 16.0
2사 분위 : 45.0
3사 분위 : 48.0
IQR : 32.0
1.5 IQR : 48.0
최소값 : -32.0
최대값 : 96.0
</pre></table></code></div></div><ul><li>1사분위 : np.percentile(samples, 25)</li><li>2사분위 : np.median(samples)</li><li>3사분위 : np.percentile(samples, 75)</li><li>iqr : np.percentile(samples, 75) - np.percentile(samples, 25)</li><li>1.5 iqr = (np.percentile(samples, 75) - np.percentile(samples, 25)) * 1.5</li><li>최소값 = np.percentile(samples, 25) - ((np.percentile(samples, 75) - np.percentile(samples, 25)) * 1.5)</li><li>최대값 = np.percentile(samples, 75) + ((np.percentile(samples, 75) - np.percentile(samples, 25)) * 1.5)</li></ul><p><br /></p><h3 id="55-실제로-그려보기">5.5 실제로 그려보기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">q2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">median</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">upper_fence</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="n">iqr</span> <span class="o">*</span> <span class="mf">1.5</span>
<span class="n">lower_fence</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="n">iqr</span> <span class="o">*</span> <span class="mf">1.5</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">tmp_y</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">q3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">upper_fence</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">'dashed'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lower_fence</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'black'</span><span class="p">,</span> <span class="n">ls</span> <span class="o">=</span> <span class="s">'dashed'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000533-cecd9780-1571-11eb-8041-d59aae510ea0.png" /></p><ul><li>위의 내용을 모두 적용하여 그려봄</li></ul><p><br /></p><h3 id="56-boxplot은-seabonr에-있음">5.6 Boxplot은 seabonr에 있음</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000536-cecd9780-1571-11eb-95db-6b2aacfa61fd.png" /></p><h2 id="6-boxplot을-이용하여-outlier를-정리해보기">6. Boxplot을 이용하여 Outlier를 정리해보기</h2><hr /><h3 id="61-boxplot으로-그리기">6.1 Boxplot으로 그리기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="p">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">raw_data</span><span class="p">[[</span><span class="s">'V13'</span><span class="p">,</span><span class="s">'V14'</span><span class="p">,</span><span class="s">'V15'</span><span class="p">]])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000540-cf662e00-1571-11eb-82bb-f7770aa9aac5.png" /></p><ul><li>딱히 해당 데이터에 대해 도메인지식은 없지만, V14 컬럼은 Outlier라고 할만큼 이상한 데이터가 많음</li></ul><p><br /></p><h3 id="62-outlier의-인덱스를-파악하는-함수-작성">6.2 Outlier의 인덱스를 파악하는 함수 작성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">get_outlier</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">):</span>
    <span class="n">fraud</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Class'</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">][</span><span class="n">column</span><span class="p">]</span>
    <span class="n">quantile_25</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">fraud</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">quantile_75</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">fraud</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">quantile_75</span> <span class="o">-</span> <span class="n">quantile_25</span>
    <span class="n">iqr_weight</span> <span class="o">=</span> <span class="n">iqr</span> <span class="o">*</span> <span class="n">weight</span>
    <span class="n">lowest_val</span> <span class="o">=</span> <span class="n">quantile_25</span> <span class="o">-</span> <span class="n">iqr_weight</span>
    <span class="n">highest_val</span> <span class="o">=</span> <span class="n">quantile_75</span> <span class="o">+</span> <span class="n">iqr_weight</span>
    
    <span class="n">outlier_index</span> <span class="o">=</span> <span class="n">fraud</span><span class="p">[(</span><span class="n">fraud</span> <span class="o">&lt;</span> <span class="n">lowest_val</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">fraud</span> <span class="o">&gt;</span> <span class="n">highest_val</span><span class="p">)].</span><span class="n">index</span>
    
    <span class="k">return</span> <span class="n">outlier_index</span>
</pre></table></code></div></div><p><br /></p><h3 id="63-outlier-찾기">6.3 Outlier 찾기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">get_outlier</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s">'V14'</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Int64Index([8296, 8615, 9035, 9252], dtype='int64')
</pre></table></code></div></div><p><br /></p><h3 id="64-outlier-제거">6.4 Outlier 제거</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">raw_data_copy</span><span class="p">.</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(284807, 29)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">outlier_index</span> <span class="o">=</span> <span class="n">get_outlier</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span> <span class="s">'V14'</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="n">raw_data_copy</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">outlier_index</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">raw_data_copy</span><span class="p">.</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(284803, 29)
</pre></table></code></div></div><ul><li>V14의 컬럼에 아웃라이어를 인덱스로 찾아서 삭제함</li></ul><p><br /></p><h3 id="65-outlier제거-한-뒤-데이터-다시-나누기">6.5 Outlier제거 한 뒤 데이터 다시 나누기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">raw_data_copy</span>

<span class="n">raw_data</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">outlier_index</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">raw_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">stratify</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>삭제한 아웃라이어를 기준으로 데이터를 나누었음</li></ul><p><br /></p><h3 id="66-outlier-제거-후-성능-평가">6.6 Outlier 제거 후 성능 평가</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">time</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">dt_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">lgbm_clf</span><span class="p">]</span>

<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LinearReg'</span><span class="p">,</span> <span class="s">'DecisionTree'</span><span class="p">,</span> <span class="s">'RandomForest'</span><span class="p">,</span> <span class="s">'LightGBM'</span><span class="p">]</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">get_result_pd</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Fit time : '</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="n">results</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Fit time :  25.215320110321045
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>accuracy<th>precision<th>recall<th>f1<th>roc_acu<tbody><tr><th>LinearReg<td>0.999286<td>0.904762<td>0.650685<td>0.756972<td>0.825284<tr><th>DecisionTree<td>0.999427<td>0.870229<td>0.780822<td>0.823105<td>0.890311<tr><th>RandomForest<td>0.999497<td>0.918699<td>0.773973<td>0.840149<td>0.886928<tr><th>LightGBM<td>0.999602<td>0.951613<td>0.808219<td>0.874074<td>0.904074</table></div><ul><li>ROC 커브로 봐봐야 겠음</li></ul><p><br /></p><h3 id="67-roc커브">6.7 ROC커브</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/97000541-cf662e00-1571-11eb-9f37-7b836f4e2952.png" /></p><ul><li>Outlier를 제거했는데도 별 차이는 없어보임</li></ul><p><br /></p><h2 id="7-smote-oversampling">7. SMOTE Oversampling</h2><hr /><h3 id="71-smote-oversampling">7.1 SMOTE Oversampling</h3><ul><li>사실 위의 데이터는 조금 문제가 있는게, 전체 데이터에서 y의 1값이 0.17%라는것이다</li><li>그 뜻은 그냥 모든 y값을 0으로 예측해도 틀린값은 0.17% 밖에 안된다는 이야기</li><li>그래서 위의 모든 데이터가 Acc가 높게 나온것</li><li>해당 문제를 잡기 위해 Oversampling이 필요함</li></ul><p><br /></p><h3 id="72-undersampling-vs-oversampling">7.2 Undersampling vs Oversampling</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/96974428-2eb54580-1554-11eb-976b-25a1e43bb121.png" /></p><ul><li>데이터의 불균형이 극심할때 불균형한 두 클래스의 분포를 강제로 맞추는 작업</li><li>언더샘플링 : 많은 수의 데이터를 적은 수의 데이터로 강제 조정</li><li>오버샘플링 :<ul><li>원본 데이터의 피쳐값들을 약간 변경하여 증식</li><li>대표적으로 SMOTE방법이 있음</li><li>적은 데이터 세트에 있는 개별 데이터를 k-최근접 이웃 방법으로 찾아서 데이터의 분포 사이에 새로운 데이터를 만드는 방식</li><li>imbalanced-learn 이라는 Python pkg가 있음</li></ul></li></ul><p><br /></p><h3 id="73-설치">7.3 설치</h3><ul><li>pip install imbalanced-learn</li></ul><p><br /></p><h3 id="74-smote-적용하기">7.4 SMOTE 적용하기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>

<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">X_train_over</span><span class="p">,</span> <span class="n">y_train_over</span> <span class="o">=</span> <span class="n">smote</span><span class="p">.</span><span class="n">fit_sample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>단, 데이터 증강은 train 데이터에서만 한다</li></ul><h3 id="75-데이터-증강의-효과">7.5 데이터 증강의 효과</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'증강 전 : X_train : </span><span class="si">{</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">, y_train : </span><span class="si">{</span><span class="n">y_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'증강 후 : X_train : </span><span class="si">{</span><span class="n">X_train_over</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">, y_train : </span><span class="si">{</span><span class="n">y_train_over</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>증강 전 : X_train : (199362, 29), y_train : (199362,)
증강 후 : X_train : (398040, 29), y_train : (398040,)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train_over</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>(array([0, 1]), array([199020,    342]))
(array([0, 1]), array([199020, 199020]))
</pre></table></code></div></div><ul><li>증강 전의 전체 데이터는 199362였고, 증강 후에 398040으로 늘어남</li><li>증강 전의 y_train의 1값은 342개 으나, 증강 후의 1값은 199020개로 대폭 늘어나게 됨</li></ul><p><br /></p><h3 id="76-oversampling-후의-성능확인">7.6 Oversampling 후의 성능확인</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">time</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">lr_clf</span><span class="p">,</span> <span class="n">dt_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">lgbm_clf</span><span class="p">]</span>

<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s">'LinearReg'</span><span class="p">,</span> <span class="s">'DecisionTree'</span><span class="p">,</span> <span class="s">'RandomForest'</span><span class="p">,</span> <span class="s">'LightGBM'</span><span class="p">]</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">get_result_pd</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_train_over</span><span class="p">,</span> <span class="n">y_train_over</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">'Fit time : '</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
<span class="n">results</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Fit time :  50.29139733314514
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>accuracy<th>precision<th>recall<th>f1<th>roc_acu<tbody><tr><th>LinearReg<td>0.975609<td>0.059545<td>0.897260<td>0.111679<td>0.936502<tr><th>DecisionTree<td>0.968984<td>0.046048<td>0.869863<td>0.087466<td>0.919509<tr><th>RandomForest<td>0.999532<td>0.873239<td>0.849315<td>0.861111<td>0.924552<tr><th>LightGBM<td>0.999532<td>0.873239<td>0.849315<td>0.861111<td>0.924552</table></div><ul><li>그전과 비교하여 recall이 좋아진것을 확인할수 있음</li></ul><p><br /></p><h3 id="77-roc-커브">7.7 ROC 커브</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">draw_roc_curve</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></table></code></div></div><imgr src="https://user-images.githubusercontent.com/60168331/97000544-cffec480-1571-11eb-87b0-008be63e8d83.png"> - 그전과 비교해서 ROC커브도 많이 좋아졌음 <br /> ### 7.8 결론 - 데이터의 불균형이 있을땐 Oversampling도 하나의 방안이 될수있음 - Outlier는 수치적으로 이상한 애들이긴 하지만, 도메인지식으로 인해 제거를 안할수도 있음 </imgr></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-science/'>Data Science</a>, <a href='/categories/machine-learning/'>Machine Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/accuracy/" class="post-tag no-text-decoration" >Accuracy</a> <a href="/tags/precision/" class="post-tag no-text-decoration" >Precision</a> <a href="/tags/recall/" class="post-tag no-text-decoration" >Recall</a> <a href="/tags/f1-score/" class="post-tag no-text-decoration" >F1-Score</a> <a href="/tags/roc-curve/" class="post-tag no-text-decoration" >Roc Curve</a> <a href="/tags/outlier/" class="post-tag no-text-decoration" >Outlier</a> <a href="/tags/box-plot/" class="post-tag no-text-decoration" >Box Plot</a> <a href="/tags/over-sampling/" class="post-tag no-text-decoration" >Over Sampling</a> <a href="/tags/kaggle/" class="post-tag no-text-decoration" >Kaggle</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=신용카드 부정 사용자 데이터로 해보는 부스팅 - Data Include Me&url=https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=신용카드 부정 사용자 데이터로 해보는 부스팅 - Data Include Me&u=https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=신용카드 부정 사용자 데이터로 해보는 부스팅 - Data Include Me&url=https://datainclude.me/posts/%EC%8B%A0%EC%9A%A9%EC%B9%B4%EB%93%9C_%EB%B6%80%EC%A0%95_%EC%82%AC%EC%9A%A9%EC%9E%90_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B6%80%EC%8A%A4%ED%8C%85/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Panel on right side (Desktop views) v2.3 © 2024 Your Name MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li class="recent-item"> <a href="/posts/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85_%EA%B0%80%EC%83%81%ED%99%94/">클라우드 컴퓨팅 - 가상화</a> <span class="text-muted small">2024-10-28</span></li><li class="recent-item"> <a href="/posts/gemini_api_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/">Gemini API 사용해보기</a> <span class="text-muted small">2024-03-12</span></li><li class="recent-item"> <a href="/posts/Ollama%EC%99%80_Python_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC_LLaMa2%EB%A5%BC_%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Ollama와 Python 라이브러리를 이용하여 LLaMa2를 로컬에서 사용하기</a> <span class="text-muted small">2024-02-13</span></li><li class="recent-item"> <a href="/posts/Mistral_7B_Fine_Tuning/">Mistral 7B 파인튜닝(Fine Tuning)하기</a> <span class="text-muted small">2023-10-25</span></li><li class="recent-item"> <a href="/posts/Penn_Fudan%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EA%B0%9D%EC%B2%B4_%ED%83%90%EC%A7%80_%EB%B6%84%ED%95%A0/">Penn-Fudan으로 알아보는 객체 탐지(Object Detection), 분할(Segmentation) with FasterRCNN</a> <span class="text-muted small">2023-10-23</span></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><style> .recent-item { margin-bottom: 0.5rem; } .recent-item a { color: var(--link-color); } .recent-item .small { font-size: 0.75rem; margin-left: 0.5rem; }</style></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%EB%AA%A8%EB%8D%B8_%ED%8F%89%EA%B0%80/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 22, 2020 <i class="unloaded">2020-09-22T21:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>모델 평가</h3><div class="text-muted small"><p> 1. 모델평가 1.1 모델 평가란? 생성한 모델을 좋다, 나쁘다, 그저 그렇다 라고 평가할 방법은 사실 없다 대부분 다양한 모델, 다양한 파라미터를 두고, 상대적으로 평가를 한다 2. 회귀 모델 2.1 회귀모델의 평가 회귀 모델은 실제 값과의 에러치를 가지고 평가를 함 2.1.1 MAE (Mean Absolute Err...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%A0%95%EB%B0%80%EB%8F%84(Precision)%EC%99%80_%EC%9E%AC%ED%98%84%EC%9C%A8(recall)/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 19, 2020 <i class="unloaded">2020-10-19T10:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>정밀도(Precision)와 재현율(Recall)</h3><div class="text-muted small"><p> 1. 정밀도와 재현율의 트레이드 오프 1.1 Wine Data로 실습 import pandas as pd wine_url = 'https://raw.githubusercontent.com/hmkim312/datas/main/wine/wine.csv' wine = pd.read_csv(wine_url, index_col=0) wine['tast...</p></div></div></a></div><div class="card"> <a href="/posts/Mall_Customer_Segmentation_Data%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EA%B5%B0%EC%A7%91%ED%99%94/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 22, 2020 <i class="unloaded">2020-10-22T09:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mall Customer Segmentation Data로 해보는 군집화</h3><div class="text-muted small"><p> 1. Mall Customer Segmentation Data 1.1 Mall Customer Segmentation Data Kaggle에 있는 쇼핑몰 고객 데이터 https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python 2. Mall Customer...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HAR_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_GBM,_XGBoost,_LightGBM/" class="btn btn-outline-primary"><p>HAR 데이터로 해보는 GBM, XGBoost, LightGBM</p></a> <a href="/posts/%EC%95%84%EC%9D%B4%EB%A6%AC%EC%8A%A4_%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%99%80_%EC%99%80%EC%9D%B8%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_PCA/" class="btn btn-outline-primary"><p>아이리스 데이터와 와인데이터로 해보는 PCA</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://datainclude.me{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
