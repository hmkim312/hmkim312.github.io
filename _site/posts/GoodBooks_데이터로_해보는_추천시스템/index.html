<!DOCTYPE html><html lang="ko" mode="light" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Good Books 데이터로 해보는 추천 시스템(Recommendations) | Data Include Me</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="Good Books 데이터로 해보는 추천 시스템(Recommendations)" /><meta name="author" content="HyunMin Kim" /><meta property="og:locale" content="ko" /><meta name="description" content="1. Good Books 1.1 Good Books 데이터" /><meta property="og:description" content="1. Good Books 1.1 Good Books 데이터" /><link rel="canonical" href="https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/" /><meta property="og:url" content="https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/" /><meta property="og:site_name" content="Data Include Me" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-10-26T10:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Good Books 데이터로 해보는 추천 시스템(Recommendations)" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@HyunMin Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HyunMin Kim"},"dateModified":"2020-10-26T10:00:00+09:00","datePublished":"2020-10-26T10:00:00+09:00","description":"1. Good Books 1.1 Good Books 데이터","headline":"Good Books 데이터로 해보는 추천 시스템(Recommendations)","mainEntityOfPage":{"@type":"WebPage","@id":"https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/"},"url":"https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/"}</script><meta property="og:image" content="https://datainclude.me/assets/img/sample/avatar.jpg" /> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="36x36" href="/assets/img/favicons/android-icon-36x36.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicons/android-icon-48x48.png"><link rel="icon" type="image/png" sizes="72x72" href="/assets/img/favicons/android-icon-72x72.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/android-icon-96x96.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/android-icon-144x144.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="70x70" href="/assets/img/favicons/ms-icon-70x70.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/ms-icon-144x144.png"><link rel="icon" type="image/png" sizes="150x150" href="/assets/img/favicons/ms-icon-150x150.png"><link rel="icon" type="image/png" sizes="310x310" href="/assets/img/favicons/ms-icon-310x310.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-MW9VRMW9" as="script"> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MW9VRMW9');</script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> </noscript> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9VRMW9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Data Include Me</a></div><div class="site-subtitle font-italic">Data Science Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hmkim312" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sanarial312','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Good Books 데이터로 해보는 추천 시스템(Recommendations)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <script type="text/javascript"> var lazyloadads = false; function loadAds() { if (!lazyloadads) { var script = document.createElement("script"); script.type = "text/javascript"; script.async = true; script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7594406644928408"; document.body.appendChild(script); lazyloadads = true; } } window.addEventListener("mousemove", loadAds, { once: true }); window.addEventListener('touchstart', loadAds, { once: true }); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Good Books 데이터로 해보는 추천 시스템(Recommendations)</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Oct 26, 2020, 10:00 AM +0900" > Oct 26, 2020 <i class="unloaded">2020-10-26T10:00:00+09:00</i> </span> by <span class="author"> HyunMin Kim </span></div><a href="https://hits.seeyoufarm.com"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/%2F&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="페이지 조회수 뱃지", width: 100%;, height: 100%;/> </a></div><div class="post-content"><h2 id="1-good-books">1. Good Books</h2><hr /><h3 id="11-good-books-데이터">1.1 Good Books 데이터</h3><p><a href="https://www.kaggle.com/zygmunt/goodbooks-10k" target="_blank">https://www.kaggle.com/zygmunt/goodbooks-10k</a></p><ul><li>ratings, books,tag, book_tags, to_read의 10k(10,000) 데이터</li></ul><p><br /></p><h2 id="2-추천-시스템-실습">2. 추천 시스템 실습</h2><hr /><h3 id="21-data-load">2.1 Data load</h3><h4 id="211-books-data">2.1.1 Books data</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">books</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/goodbooks-10k/books.csv'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'ISO-8859-1'</span><span class="p">)</span>
<span class="n">books</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>book_id<th>best_book_id<th>work_id<th>books_count<th>isbn<th>isbn13<th>authors<th>original_publication_year<th>original_title<th>...<th>ratings_count<th>work_ratings_count<th>work_text_reviews_count<th>ratings_1<th>ratings_2<th>ratings_3<th>ratings_4<th>ratings_5<th>image_url<th>small_image_url<tbody><tr><th>0<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>4780653<td>4942365<td>155254<td>66715<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<tr><th>1<td>2<td>3<td>3<td>4640799<td>491<td>439554934<td>9.780440e+12<td>J.K. Rowling, Mary GrandPrÃ©<td>1997.0<td>Harry Potter and the Philosopher's Stone<td>...<td>4602479<td>4800065<td>75867<td>75504<td>101676<td>455024<td>1156318<td>3011543<td>https://images.gr-assets.com/books/1474154022m...<td>https://images.gr-assets.com/books/1474154022s...<tr><th>2<td>3<td>41865<td>41865<td>3212258<td>226<td>316015849<td>9.780316e+12<td>Stephenie Meyer<td>2005.0<td>Twilight<td>...<td>3866839<td>3916824<td>95009<td>456191<td>436802<td>793319<td>875073<td>1355439<td>https://images.gr-assets.com/books/1361039443m...<td>https://images.gr-assets.com/books/1361039443s...<tr><th>3<td>4<td>2657<td>2657<td>3275794<td>487<td>61120081<td>9.780061e+12<td>Harper Lee<td>1960.0<td>To Kill a Mockingbird<td>...<td>3198671<td>3340896<td>72586<td>60427<td>117415<td>446835<td>1001952<td>1714267<td>https://images.gr-assets.com/books/1361975680m...<td>https://images.gr-assets.com/books/1361975680s...<tr><th>4<td>5<td>4671<td>4671<td>245494<td>1356<td>743273567<td>9.780743e+12<td>F. Scott Fitzgerald<td>1925.0<td>The Great Gatsby<td>...<td>2683664<td>2773745<td>51992<td>86236<td>197621<td>606158<td>936012<td>947718<td>https://images.gr-assets.com/books/1490528560m...<td>https://images.gr-assets.com/books/1490528560s...</table><p>5 rows × 23 columns</p></div><ul><li>Book에 대한 정보가 담긴 csv 파일</li><li>이번 데이터들은 encoding을 ISO-8859-1로 읽어야함</li><li>rating 1 ~ 5의 의미는 별점 1점부터 5점의 갯수임</li></ul><p><br /></p><h4 id="212-ratings-data">2.1.2 Ratings Data</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/goodbooks-10k/ratings.csv'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'ISO-8859-1'</span><span class="p">)</span>
<span class="n">ratings</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>book_id<th>user_id<th>rating<tbody><tr><th>0<td>1<td>314<td>5<tr><th>1<td>1<td>439<td>3<tr><th>2<td>1<td>588<td>5<tr><th>3<td>1<td>1169<td>4<tr><th>4<td>1<td>1185<td>4</table></div><ul><li>rating 데이터에는 Book_id와 User_id 그리고 해당 유저가 준 rating 점수가 있음</li></ul><p><br /></p><h4 id="213-book-tags-data-load">2.1.3 Book tags Data load</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">book_tags</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/goodbooks-10k/book_tags.csv'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'ISO-8859-1'</span><span class="p">)</span>
<span class="n">book_tags</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>goodreads_book_id<th>tag_id<th>count<tbody><tr><th>0<td>1<td>30574<td>167697<tr><th>1<td>1<td>11305<td>37174<tr><th>2<td>1<td>11557<td>34173<tr><th>3<td>1<td>8717<td>12986<tr><th>4<td>1<td>33114<td>12716</table></div><ul><li>Book의 id와 tag의 id가 있음</li></ul><p><br /></p><h4 id="214-tags-data-load">2.1.4 Tags Data load</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">tags</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/goodbooks-10k/tags.csv'</span><span class="p">)</span>
<span class="n">tags</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>tag_id<th>tag_name<tbody><tr><th>34247<td>34247<td>Ｃhildrens<tr><th>34248<td>34248<td>Ｆａｖｏｒｉｔｅｓ<tr><th>34249<td>34249<td>Ｍａｎｇａ<tr><th>34250<td>34250<td>ＳＥＲＩＥＳ<tr><th>34251<td>34251<td>ｆａｖｏｕｒｉｔｅｓ</table></div><ul><li>Tag의 id와 해당 tag와 연결되는 name이 있음</li></ul><p><br /></p><h4 id="215-read-data-load">2.1.5 Read Data load</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">to_read</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://media.githubusercontent.com/media/hmkim312/datas/main/goodbooks-10k/to_read.csv'</span><span class="p">)</span>
<span class="n">to_read</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>user_id<th>book_id<tbody><tr><th>0<td>1<td>112<tr><th>1<td>1<td>235<tr><th>2<td>1<td>533<tr><th>3<td>1<td>1198<tr><th>4<td>1<td>1874</table></div><ul><li>유저가 어떤 책을 읽었는지에 대한 id가 적혀있음</li></ul><p><br /></p><h3 id="22-tag-data-전처리">2.2 Tag Data 전처리</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">tags_join_Df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">book_tags</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s">'tag_id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s">'tag_id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'inner'</span><span class="p">)</span>
<span class="n">tags_join_Df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>goodreads_book_id<th>tag_id<th>count<th>tag_name<tbody><tr><th>0<td>1<td>30574<td>167697<td>to-read<tr><th>1<td>2<td>30574<td>24549<td>to-read<tr><th>2<td>3<td>30574<td>496107<td>to-read<tr><th>3<td>5<td>30574<td>11909<td>to-read<tr><th>4<td>6<td>30574<td>298<td>to-read</table></div><ul><li>Tagid와 tag_name을 books id가 있는 데이터 프레임과 merge함</li></ul><p><br /></p><h3 id="23-authors로-tfidf">2.3 Authors로 Tfidf</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">books</span><span class="p">[</span><span class="s">'authors'</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>0                 Suzanne Collins
1    J.K. Rowling, Mary GrandPrÃ©
2                 Stephenie Meyer
Name: authors, dtype: object
</pre></table></code></div></div><ul><li>books 데이터에는 작가명 컬럼이 있음</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="n">tf</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s">'word'</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop_words</span> <span class="o">=</span> <span class="s">'english'</span><span class="p">)</span>
<span class="n">tfidf_matrix</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">books</span><span class="p">[</span><span class="s">'authors'</span><span class="p">])</span>
<span class="n">tfidf_matrix</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>&lt;10000x14742 sparse matrix of type '&lt;class 'numpy.float64'&gt;'
	with 43235 stored elements in Compressed Sparse Row format&gt;
</pre></table></code></div></div><ul><li>Books에 있는 작가명으로 Tfidf를 수행함</li></ul><p><br /></p><h3 id="24-유사도-측정">2.4 유사도 측정</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="kn">import</span> <span class="n">linear_kernel</span>

<span class="n">cosine_sim</span> <span class="o">=</span> <span class="n">linear_kernel</span><span class="p">(</span><span class="n">tfidf_matrix</span><span class="p">,</span> <span class="n">tfidf_matrix</span><span class="p">)</span>
<span class="n">cosine_sim</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>array([[1., 0., 0., ..., 0., 0., 0.],
       [0., 1., 0., ..., 0., 0., 0.],
       [0., 0., 1., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 1., 0., 0.],
       [0., 0., 0., ..., 0., 1., 0.],
       [0., 0., 0., ..., 0., 0., 1.]])
</pre></table></code></div></div><ul><li>사이킷런의 linear_kernel을 사용하여 작가명으로 만든 Tfidf매트릭스를 유사도 행렬로 생성</li></ul><p><br /></p><h3 id="25-hobbit과-유사한-책은">2.5 Hobbit과 유사한 책은?</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">title</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">books</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>
<span class="n">indices</span><span class="p">[</span><span class="s">'The Hobbit'</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>6
</pre></table></code></div></div><ul><li>Hobbit의 index는 6번이다</li><li>6번 행을 불러와서 비슷한 책을 찾게 해보자</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cosine_sim</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="s">'The Hobbit'</span><span class="p">]]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>array([0., 0., 0., ..., 0., 0., 0.])
</pre></table></code></div></div><ul><li>유사도 행렬에서 hobbit의 인덱스의 행을 불러옴</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cosine_sim</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="s">'The Hobbit'</span><span class="p">]].</span><span class="n">shape</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(10000,)
</pre></table></code></div></div><ul><li>총 1만개의 책 데이터가 있음</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">cosine_sim</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="s">'The Hobbit'</span><span class="p">]]))[:</span><span class="mi">3</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[(0, 0.0), (1, 0.0), (2, 0.0)]
</pre></table></code></div></div><ul><li>유사도 행렬에서 The Hobbit의 인덱스만 가져오고, 해당 컬럼(다른책 책 인덱스)와 코사인 유사도 점수를 enumerate를 사용하여 튜플형식으로 만들고, 해당 데이터를 list에 넣는다</li></ul><p><br /></p><h3 id="26-가장-유사한-책의-index">2.6 가장 유사한 책의 Index</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">sim_scores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">cosine_sim</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="s">'The Hobbit'</span><span class="p">]]))</span>
<span class="n">sim_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sim_scores</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">sim_scores</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[(6, 1.0), (18, 1.0), (154, 1.0)]
</pre></table></code></div></div><ul><li>호빗과 가장 유사한 책의 인덱스(여기서는 열)와 코사인 점수를 정렬하여 출력함</li><li>완전 똑같은 1점도 보인다. 18번, 154번</li><li>참고로 맨 앞에 (6, 1.0)은 본인 자신임</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Index 6번의 책 이름 :'</span><span class="p">,</span> <span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">][</span><span class="mi">6</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Index 18번의 책 이름 :'</span><span class="p">,</span> <span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">][</span><span class="mi">18</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'Index 154번의 책 이름 :'</span><span class="p">,</span> <span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">][</span><span class="mi">154</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Index 6번의 책 이름 : The Hobbit
Index 18번의 책 이름 : The Fellowship of the Ring (The Lord of the Rings, #1)
Index 154번의 책 이름 : The Two Towers (The Lord of the Rings, #2)
</pre></table></code></div></div><ul><li>호빗과 비슷한 책은 반지의 제왕 시리즈가 나옴</li></ul><p><br /></p><h3 id="27-작가로-본-유사-책-검색">2.7 작가로 본 유사 책 검색</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">sim_scores</span> <span class="o">=</span> <span class="n">sim_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
<span class="n">book_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sim_scores</span><span class="p">]</span>
<span class="n">title</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">book_indices</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>18      The Fellowship of the Ring (The Lord of the Ri...
154            The Two Towers (The Lord of the Rings, #2)
160     The Return of the King (The Lord of the Rings,...
188     The Lord of the Rings (The Lord of the Rings, ...
963     J.R.R. Tolkien 4-Book Boxed Set: The Hobbit an...
4975        Unfinished Tales of NÃºmenor and Middle-Earth
2308                               The Children of HÃºrin
610              The Silmarillion (Middle-Earth Universe)
8271                   The Complete Guide to Middle-Earth
1128     The History of the Hobbit, Part One: Mr. Baggins
Name: title, dtype: object
</pre></table></code></div></div><ul><li>그 외의 다른 책들도 대부분 Hobbit이긴 하나, 아마 작가가 동일인일 가능성이 높다.</li><li>사실 생각해 보면 작가이름으로만 Tfidf를 했기 때문에, 작가 이름이 같다면 모두 동일한 점수(1)로 나올것이다</li></ul><p><br /></p><h3 id="28-tag-추가">2.8 Tag 추가</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">books_with_tags</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="n">tags_join_Df</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span> <span class="s">'book_id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s">'goodreads_book_id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'inner'</span><span class="p">)</span>
<span class="n">books_with_tags</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>book_id<th>best_book_id<th>work_id<th>books_count<th>isbn<th>isbn13<th>authors<th>original_publication_year<th>original_title<th>...<th>ratings_2<th>ratings_3<th>ratings_4<th>ratings_5<th>image_url<th>small_image_url<th>goodreads_book_id<th>tag_id<th>count<th>tag_name<tbody><tr><th>0<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<td>2767052<td>30574<td>11314<td>to-read<tr><th>1<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<td>2767052<td>11305<td>10836<td>fantasy<tr><th>2<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<td>2767052<td>11557<td>50755<td>favorites<tr><th>3<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<td>2767052<td>8717<td>35418<td>currently-reading<tr><th>4<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<td>2767052<td>33114<td>25968<td>young-adult</table><p>5 rows × 27 columns</p></div><ul><li>Books 데이터 프레임에, 앞에서 만든 tagid와 tag name을 merge함</li></ul><p><br /></p><h3 id="29-tag를-tfidf">2.9 Tag를 Tfidf</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">tf_tag</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s">'word'</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s">'english'</span><span class="p">)</span>
<span class="n">tfidf_matrix_tag</span> <span class="o">=</span> <span class="n">tf_tag</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">books_with_tags</span><span class="p">[</span><span class="s">'tag_name'</span><span class="p">].</span><span class="n">head</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">cosine_sim_tag</span> <span class="o">=</span> <span class="n">linear_kernel</span><span class="p">(</span><span class="n">tfidf_matrix_tag</span><span class="p">,</span> <span class="n">tfidf_matrix_tag</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>앞에선 작가 이름으로 Tfidf를 했고, 이번엔 Tag로 해본다</li></ul><p><br /></p><h3 id="210-추천책을-반환하는-함수">2.10 추천책을 반환하는 함수</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">title_tag</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span>
<span class="n">indices_tag</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">books</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">tags_recommendations</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">indices_tag</span><span class="p">[</span><span class="n">title</span><span class="p">]</span>
    <span class="n">sim_scores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">cosine_sim_tag</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
    <span class="n">sim_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sim_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">sim_scores</span> <span class="o">=</span> <span class="n">sim_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">book_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sim_scores</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">title_tag</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">book_indices</span><span class="p">]</span>
</pre></table></code></div></div><ul><li>이번에는 책의 제목을 넣으면 추천책을 반환하는 함수를 작성</li><li>sim_scores = sim_scores[1:11]은 총 10개를 가리키며, 1부터 한것은 0번은 입력한 책 제목 자신이 나오기 떄문임</li></ul><p><br /></p><h3 id="211-tag로-찾아본-hobbits와-유사책">2.11 Tag로 찾아본 Hobbits와 유사책</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">tags_recommendations</span><span class="p">(</span><span class="s">'The Hobbit'</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>16             Catching Fire (The Hunger Games, #2)
31                                  Of Mice and Men
107    Confessions of a Shopaholic (Shopaholic, #1)
125                       Dune (Dune Chronicles #1)
149                                    The Red Tent
206          One for the Money (Stephanie Plum, #1)
214                                Ready Player One
231             The Gunslinger (The Dark Tower, #1)
253          Shiver (The Wolves of Mercy Falls, #1)
313                         Inkheart (Inkworld, #1)
Name: title, dtype: object
</pre></table></code></div></div><ul><li>헝거게임, 듄 등 호빗과 비슷한 판타지 장르가 나오는듯 싶다.</li></ul><p><br /></p><h3 id="212-book-id에-tag-name을-한번에-붙이기">2.12 Book id에 tag name을 한번에 붙이기</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">temp_df</span> <span class="o">=</span> <span class="n">books_with_tags</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'book_id'</span><span class="p">)[</span><span class="s">'tag_name'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">temp_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>book_id<th>tag_name<tbody><tr><th>0<td>1<td>to-read fantasy favorites currently-reading yo...<tr><th>1<td>2<td>to-read fantasy favorites currently-reading yo...<tr><th>2<td>3<td>to-read fantasy favorites currently-reading yo...<tr><th>3<td>5<td>to-read fantasy favorites currently-reading yo...<tr><th>4<td>6<td>to-read fantasy young-adult fiction harry-pott...</table></div><ul><li>Book Id에 있는 모든 tag_name들을 한번에 모아놓음</li></ul><p><br /></p><h3 id="213-boos에-merge">2.13 Boos에 Merge</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">books</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="n">temp_df</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'book_id'</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s">'inner'</span><span class="p">)</span>
<span class="n">books</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>id<th>book_id<th>best_book_id<th>work_id<th>books_count<th>isbn<th>isbn13<th>authors<th>original_publication_year<th>original_title<th>...<th>work_ratings_count<th>work_text_reviews_count<th>ratings_1<th>ratings_2<th>ratings_3<th>ratings_4<th>ratings_5<th>image_url<th>small_image_url<th>tag_name<tbody><tr><th>0<td>1<td>2767052<td>2767052<td>2792775<td>272<td>439023483<td>9.780439e+12<td>Suzanne Collins<td>2008.0<td>The Hunger Games<td>...<td>4942365<td>155254<td>66715<td>127936<td>560092<td>1481305<td>2706317<td>https://images.gr-assets.com/books/1447303603m...<td>https://images.gr-assets.com/books/1447303603s...<td>to-read fantasy favorites currently-reading yo...<tr><th>1<td>2<td>3<td>3<td>4640799<td>491<td>439554934<td>9.780440e+12<td>J.K. Rowling, Mary GrandPrÃ©<td>1997.0<td>Harry Potter and the Philosopher's Stone<td>...<td>4800065<td>75867<td>75504<td>101676<td>455024<td>1156318<td>3011543<td>https://images.gr-assets.com/books/1474154022m...<td>https://images.gr-assets.com/books/1474154022s...<td>to-read fantasy favorites currently-reading yo...<tr><th>2<td>3<td>41865<td>41865<td>3212258<td>226<td>316015849<td>9.780316e+12<td>Stephenie Meyer<td>2005.0<td>Twilight<td>...<td>3916824<td>95009<td>456191<td>436802<td>793319<td>875073<td>1355439<td>https://images.gr-assets.com/books/1361039443m...<td>https://images.gr-assets.com/books/1361039443s...<td>to-read fantasy favorites currently-reading yo...<tr><th>3<td>4<td>2657<td>2657<td>3275794<td>487<td>61120081<td>9.780061e+12<td>Harper Lee<td>1960.0<td>To Kill a Mockingbird<td>...<td>3340896<td>72586<td>60427<td>117415<td>446835<td>1001952<td>1714267<td>https://images.gr-assets.com/books/1361975680m...<td>https://images.gr-assets.com/books/1361975680s...<td>to-read favorites currently-reading young-adul...<tr><th>4<td>5<td>4671<td>4671<td>245494<td>1356<td>743273567<td>9.780743e+12<td>F. Scott Fitzgerald<td>1925.0<td>The Great Gatsby<td>...<td>2773745<td>51992<td>86236<td>197621<td>606158<td>936012<td>947718<td>https://images.gr-assets.com/books/1490528560m...<td>https://images.gr-assets.com/books/1490528560s...<td>to-read favorites currently-reading young-adul...</table><p>5 rows × 24 columns</p></div><ul><li>이번에는 tag name이 하나의 컬럼에 여러개가 들어있음</li></ul><p><br /></p><h3 id="214-작가와-tag-name을-합침">2.14 작가와 Tag name을 합침</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">books</span><span class="p">[</span><span class="s">'corpus'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">books</span><span class="p">[[</span><span class="s">'authors'</span><span class="p">,</span> <span class="s">'tag_name'</span><span class="p">]]</span>
                            <span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>
                            <span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>
                           <span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">' '</span><span class="p">))</span>
<span class="n">books</span><span class="p">[</span><span class="s">'corpus'</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>0    Suzanne Collins to-read fantasy favorites curr...
1    J.K. Rowling, Mary GrandPrÃ© to-read fantasy f...
2    Stephenie Meyer to-read fantasy favorites curr...
Name: corpus, dtype: object
</pre></table></code></div></div><ul><li>corpus라는 컬럼에 저자와 태그가 한번에 모두 있음</li></ul><p><br /></p><h3 id="215-tfidf-실행">2.15 Tfidf 실행</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">tf_corpus</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s">'word'</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">min_df</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="s">'english'</span><span class="p">)</span>
<span class="n">tfidf_matrix_corpus</span> <span class="o">=</span> <span class="n">tf_corpus</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">books</span><span class="p">[</span><span class="s">'corpus'</span><span class="p">])</span>
<span class="n">cosine_sim_corpus</span> <span class="o">=</span> <span class="n">linear_kernel</span><span class="p">(</span><span class="n">tfidf_matrix_corpus</span><span class="p">,</span> <span class="n">tfidf_matrix_corpus</span><span class="p">)</span>
<span class="n">titles</span> <span class="o">=</span> <span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">]</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">books</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">books</span><span class="p">[</span><span class="s">'title'</span><span class="p">])</span>
</pre></table></code></div></div><ul><li>작가와 Tag name을 합친것을 Tfidf를 실행함</li></ul><p><br /></p><h3 id="216-추천-함수-작성">2.16 추천 함수 작성</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">corpus_recommendations</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">title</span><span class="p">]</span>
    <span class="n">sim_scores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">cosine_sim_corpus</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
    <span class="n">sim_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">sim_scores</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">sim_scores</span> <span class="o">=</span> <span class="n">sim_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">book_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sim_scores</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">titles</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">book_indices</span><span class="p">]</span>
</pre></table></code></div></div><p><br /></p><h3 id="217-비슷한-책은">2.17 비슷한 책은?</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">corpus_recommendations</span><span class="p">(</span><span class="s">'The Hobbit'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>188     The Lord of the Rings (The Lord of the Rings, ...
154            The Two Towers (The Lord of the Rings, #2)
160     The Return of the King (The Lord of the Rings,...
18      The Fellowship of the Ring (The Lord of the Ri...
610              The Silmarillion (Middle-Earth Universe)
4975        Unfinished Tales of NÃºmenor and Middle-Earth
2308                               The Children of HÃºrin
963     J.R.R. Tolkien 4-Book Boxed Set: The Hobbit an...
465                             The Hobbit: Graphic Novel
8271                   The Complete Guide to Middle-Earth
Name: title, dtype: object
</pre></table></code></div></div><ul><li>The Hobbit과 비슷한 책은 이제 잘 나오는듯 하다.</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">corpus_recommendations</span><span class="p">(</span><span class="s">'Twilight (Twilight, #1)'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>51                                 Eclipse (Twilight, #3)
48                                New Moon (Twilight, #2)
991                    The Twilight Saga (Twilight, #1-4)
833                         Midnight Sun (Twilight, #1.5)
731     The Short Second Life of Bree Tanner: An Eclip...
1618    The Twilight Saga Complete Collection  (Twilig...
4087    The Twilight Saga: The Official Illustrated Gu...
2020             The Twilight Collection (Twilight, #1-3)
72                                The Host (The Host, #1)
219     Twilight: The Complete Illustrated Movie Compa...
Name: title, dtype: object
</pre></table></code></div></div><ul><li>트와일라잇과 비슷한 책들</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">corpus_recommendations</span><span class="p">(</span><span class="s">'Harry Potter and the Prisoner of Azkaban (Harry Potter, #3)'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>1       Harry Potter and the Sorcerer's Stone (Harry P...
26      Harry Potter and the Half-Blood Prince (Harry ...
22      Harry Potter and the Chamber of Secrets (Harry...
24      Harry Potter and the Deathly Hallows (Harry Po...
23      Harry Potter and the Goblet of Fire (Harry Pot...
20      Harry Potter and the Order of the Phoenix (Har...
3752         Harry Potter Collection (Harry Potter, #1-6)
398                          The Tales of Beedle the Bard
1285                           Quidditch Through the Ages
421              Harry Potter Boxset (Harry Potter, #1-7)
Name: title, dtype: object
</pre></table></code></div></div><ul><li>해리포터와 비슷한 책</li></ul><p><br /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">corpus_recommendations</span><span class="p">(</span><span class="s">'Romeo and Juliet'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>352                      Othello
769                Julius Caesar
124                       Hamlet
153                      Macbeth
247    A Midsummer Night's Dream
838       The Merchant of Venice
854                Twelfth Night
529       Much Ado About Nothing
713                    King Lear
772      The Taming of the Shrew
Name: title, dtype: object
</pre></table></code></div></div><ul><li>로미오와 줄리엣과 비슷한 책</li></ul><p><br /></p><h2 id="3-요약">3. 요약</h2><hr /><h3 id="31-요약">3.1 요약</h3><ul><li>책 데이터로 해본 추천 시스템, Tfidf를 사용하였고, 사실 작가나 태그만 사용한다면 같은 작가, 같은 태그의 책들만 추천을 해줬을것이다.</li><li>하지만 하나의 컬럼에 모아서 Tfidf를 하였을땐 조금 다른 결과가 나왔으나, 이렇게 하는것이 맞는지, 혹은 더 다른 방법은 없는지 싶다</li><li>추천 시스템은 어려운듯 하다</li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-science/'>Data Science</a>, <a href='/categories/machine-learning/'>Machine Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/recommendations/" class="post-tag no-text-decoration" >Recommendations</a> <a href="/tags/tfidf-vectorizer/" class="post-tag no-text-decoration" >Tfidf Vectorizer</a> <a href="/tags/linear-kernel/" class="post-tag no-text-decoration" >linear Kernel</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Good Books 데이터로 해보는 추천 시스템(Recommendations) - Data Include Me&url=https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Good Books 데이터로 해보는 추천 시스템(Recommendations) - Data Include Me&u=https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Good Books 데이터로 해보는 추천 시스템(Recommendations) - Data Include Me&url=https://datainclude.me/posts/GoodBooks_%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Panel on right side (Desktop views) v2.3 © 2024 Your Name MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li class="recent-item"> <a href="/posts/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85_%EA%B0%80%EC%83%81%ED%99%94/">클라우드 컴퓨팅 - 가상화</a> <span class="text-muted small">2024-10-28</span></li><li class="recent-item"> <a href="/posts/gemini_api_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/">Gemini API 사용해보기</a> <span class="text-muted small">2024-03-12</span></li><li class="recent-item"> <a href="/posts/Ollama%EC%99%80_Python_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC_LLaMa2%EB%A5%BC_%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Ollama와 Python 라이브러리를 이용하여 LLaMa2를 로컬에서 사용하기</a> <span class="text-muted small">2024-02-13</span></li><li class="recent-item"> <a href="/posts/Mistral_7B_Fine_Tuning/">Mistral 7B 파인튜닝(Fine Tuning)하기</a> <span class="text-muted small">2023-10-25</span></li><li class="recent-item"> <a href="/posts/Penn_Fudan%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EA%B0%9D%EC%B2%B4_%ED%83%90%EC%A7%80_%EB%B6%84%ED%95%A0/">Penn-Fudan으로 알아보는 객체 탐지(Object Detection), 분할(Segmentation) with FasterRCNN</a> <span class="text-muted small">2023-10-23</span></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><style> .recent-item { margin-bottom: 0.5rem; } .recent-item a { color: var(--link-color); } .recent-item .small { font-size: 0.75rem; margin-left: 0.5rem; }</style></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%EB%AC%B8%EC%9E%A5_%EC%82%AC%EC%9D%B4%EC%9D%98_%EA%B1%B0%EB%A6%AC/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 18, 2020 <i class="unloaded">2020-10-18T09:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>문장 사이의 거리</h3><div class="text-muted small"><p> 1. 문장 사이의 거리 1.1 문장 사이의 거리 평면이든 공간이든 두점 사이의 거리는 구할 수 있음 비교해야할 문장을 벡터로 표현할 수 있다면 거리를 구할수 있을것 같다. 1.2 Count Vectorizer from sklearn.feature_extraction.text import CountVectorizer vecto...</p></div></div></a></div><div class="card"> <a href="/posts/%EB%84%A4%EC%9D%B4%EB%B2%84%EC%98%81%ED%99%94%ED%8F%89%EC%A0%90%EC%9D%84_%EC%9D%B4%EC%9A%A9%ED%95%9C_%EA%B0%90%EC%A0%95%EB%B6%84%EC%84%9D/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 21, 2020 <i class="unloaded">2020-10-21T09:10:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>네이버 영화 평점을 이용한 감성 분석</h3><div class="text-muted small"><p> 1. 네이버 영화 1.1 네이버 영화 평점 https://movie.naver.com/movie/point/af/list.nhn 관객이 영화를 관람 후 리뷰와 함께 평점을 0점 ~ 10점 까지의 점수를 남김 영화의 리뷰와 함께 평점을 크롤링해와서 감성분석에 사용 1.2 Data Load import pandas as pd tr...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%98%81%ED%99%94%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EC%B6%94%EC%B2%9C_%EC%8B%9C%EC%8A%A4%ED%85%9C/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Oct 25, 2020 <i class="unloaded">2020-10-25T09:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>영화데이터로 해보는 추천 시스템(Recommendations)</h3><div class="text-muted small"><p> 1. 추천 시스템 1.1 추천 시스템 요즘 유튜브, 멜론 등등에는 추천 시스템이 적용되어 있음 특히 온라인 쇼핑몰 컨텐츠 등에서도 중요한 부분을 차지함 추천시스템은 콘텐츠 기반 필터링과 협업 필터링, 크개 2가지로 나뉜다. 1.2 콘텐츠 기반 필터링 추천 시스템 사용자가 특정한 아이템을 선호하는 경우 그 아이템과 비슷...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EC%84%9C%ED%94%84%EB%9D%BC%EC%9D%B4%EC%A6%88(Surprise)%EB%A5%BC_%EC%82%AC%EC%9A%A9%ED%95%9C_%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C(Recommendations)/" class="btn btn-outline-primary"><p>서프라이즈(Surprise)를 사용한 추천시스템(Recommendations)</p></a> <a href="/posts/Mahotas%EB%A1%9C_%ED%95%B4%EB%B3%B4%EB%8A%94_%EB%B9%84%EC%8A%B7%ED%95%9C_%EC%9D%B4%EB%AF%B8%EC%A7%80_%EC%B0%BE%EA%B8%B0/" class="btn btn-outline-primary"><p>Mahotas로 해보는 비슷한 이미지 찾기</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://datainclude.me{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
