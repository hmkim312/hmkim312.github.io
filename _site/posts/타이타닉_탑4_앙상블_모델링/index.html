<!DOCTYPE html><html lang="ko" mode="light" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>타이타닉 탑4% 앙상블 모델링 | Data Include Me</title><meta name="generator" content="Jekyll v3.9.3" /><meta property="og:title" content="타이타닉 탑4% 앙상블 모델링" /><meta name="author" content="HyunMin Kim" /><meta property="og:locale" content="ko" /><meta name="description" content="1 Introduction 2 Load and check data 2.1 load data 2.2 Outlier detection 2.3 joining train and test set 2.4 check for null and missing values 3 Feature analysis 3.1 Numerical values 3.2 Categorical values 4 Filling missing Values 4.1 Age 5 Feature engineering 5.1 Name/Title 5.2 Family Size 5.3 Cabin 5.4 Ticket 6 Modeling 6.1 Simple modeling 6.1.1 Cross validate models 6.1.2 Hyperparamater tunning for best models 6.1.3 Plot learning curves 6.1.4 Feature importance of the tree based classifiers 6.2 Ensemble modeling 6.2.1 Combining models 6.3 Prediction 6.3.1 Predict and Submit results" /><meta property="og:description" content="1 Introduction 2 Load and check data 2.1 load data 2.2 Outlier detection 2.3 joining train and test set 2.4 check for null and missing values 3 Feature analysis 3.1 Numerical values 3.2 Categorical values 4 Filling missing Values 4.1 Age 5 Feature engineering 5.1 Name/Title 5.2 Family Size 5.3 Cabin 5.4 Ticket 6 Modeling 6.1 Simple modeling 6.1.1 Cross validate models 6.1.2 Hyperparamater tunning for best models 6.1.3 Plot learning curves 6.1.4 Feature importance of the tree based classifiers 6.2 Ensemble modeling 6.2.1 Combining models 6.3 Prediction 6.3.1 Predict and Submit results" /><link rel="canonical" href="https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/" /><meta property="og:url" content="https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/" /><meta property="og:site_name" content="Data Include Me" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-05T00:30:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="타이타닉 탑4% 앙상블 모델링" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@HyunMin Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"HyunMin Kim"},"dateModified":"2020-11-05T00:30:00+09:00","datePublished":"2020-11-05T00:30:00+09:00","description":"1 Introduction 2 Load and check data 2.1 load data 2.2 Outlier detection 2.3 joining train and test set 2.4 check for null and missing values 3 Feature analysis 3.1 Numerical values 3.2 Categorical values 4 Filling missing Values 4.1 Age 5 Feature engineering 5.1 Name/Title 5.2 Family Size 5.3 Cabin 5.4 Ticket 6 Modeling 6.1 Simple modeling 6.1.1 Cross validate models 6.1.2 Hyperparamater tunning for best models 6.1.3 Plot learning curves 6.1.4 Feature importance of the tree based classifiers 6.2 Ensemble modeling 6.2.1 Combining models 6.3 Prediction 6.3.1 Predict and Submit results","headline":"타이타닉 탑4% 앙상블 모델링","mainEntityOfPage":{"@type":"WebPage","@id":"https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/"},"url":"https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/"}</script><meta property="og:image" content="https://datainclude.me/assets/img/sample/avatar.jpg" /> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="36x36" href="/assets/img/favicons/android-icon-36x36.png"><link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicons/android-icon-48x48.png"><link rel="icon" type="image/png" sizes="72x72" href="/assets/img/favicons/android-icon-72x72.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/android-icon-96x96.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/android-icon-144x144.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="70x70" href="/assets/img/favicons/ms-icon-70x70.png"><link rel="icon" type="image/png" sizes="144x144" href="/assets/img/favicons/ms-icon-144x144.png"><link rel="icon" type="image/png" sizes="150x150" href="/assets/img/favicons/ms-icon-150x150.png"><link rel="icon" type="image/png" sizes="310x310" href="/assets/img/favicons/ms-icon-310x310.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=GTM-MW9VRMW9" as="script"> <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MW9VRMW9');</script><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" media="print" onload="this.media='all'"> <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"> </noscript> <!-- CSS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <!-- JS selector for site. Chirpy v2.3 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT Licensed --> <script src="/assets/js/post.min.js" async></script> <script src="/app.js" defer></script><body data-spy="scroll" data-target="#toc"> <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MW9VRMW9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Data Include Me</a></div><div class="site-subtitle font-italic">Data Science Blog</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hmkim312" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:window.open('mailto:' + ['sanarial312','gmail.com'].join('@'))" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>타이타닉 탑4% 앙상블 모델링</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Refactor the HTML structure. --> <!-- Suroundding the markdown table with '<div class="table-wrapper">. and '</div>' --> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"> <script type="text/javascript"> var lazyloadads = false; function loadAds() { if (!lazyloadads) { var script = document.createElement("script"); script.type = "text/javascript"; script.async = true; script.src = "https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7594406644928408"; document.body.appendChild(script); lazyloadads = true; } } window.addEventListener("mousemove", loadAds, { once: true }); window.addEventListener('touchstart', loadAds, { once: true }); </script><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>타이타닉 탑4% 앙상블 모델링</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Nov 5, 2020, 12:30 AM +0900" > Nov 5, 2020 <i class="unloaded">2020-11-05T00:30:00+09:00</i> </span> by <span class="author"> HyunMin Kim </span></div><a href="https://hits.seeyoufarm.com"> <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/%2F&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=views&edge_flat=false" alt="페이지 조회수 뱃지", width: 100%;, height: 100%;/> </a></div><div class="post-content"><ul><li>1 Introduction</li><li>2 Load and check data<ul><li>2.1 load data</li><li>2.2 Outlier detection</li><li>2.3 joining train and test set</li><li>2.4 check for null and missing values</li></ul></li><li>3 Feature analysis<ul><li>3.1 Numerical values</li><li>3.2 Categorical values</li></ul></li><li>4 Filling missing Values<ul><li>4.1 Age</li></ul></li><li>5 Feature engineering<ul><li>5.1 Name/Title</li><li>5.2 Family Size</li><li>5.3 Cabin</li><li>5.4 Ticket</li></ul></li><li>6 Modeling<ul><li>6.1 Simple modeling<ul><li>6.1.1 Cross validate models</li><li>6.1.2 Hyperparamater tunning for best models</li><li>6.1.3 Plot learning curves</li><li>6.1.4 Feature importance of the tree based classifiers</li></ul></li><li>6.2 Ensemble modeling<ul><li>6.2.1 Combining models</li></ul></li><li>6.3 Prediction<ul><li>6.3.1 Predict and Submit results</li></ul></li></ul></li></ul><p><br /></p><h3 id="1-introduction">1. Introduction</h3><ul><li>해당 작성자의 첫번째 커널로 타이타닉을 선택한 이유는 데이터 엔지니어링과 모델링에 있어 좋은 feature를 가지고 있다고 한다.</li><li>첫번째로 몇몇의 feature를 분석하고 그것에 집중하여 엔지니어링을 할것이다</li><li>마지막 부분은 voting procedure를 사용하여 타이타닉의 생존을 모델링하고 예측할것 이다.</li><li><p>해당 노트북은 아래의 스크립트를 따라간다. :</p><ul><li>Feature analysis</li><li>Feature engineering</li><li>Modeling</li></ul></li><li>아래 출처의 notebook을 따라서 필사한것 임</li><li>출처 : <a href="https://www.kaggle.com/yassineghouzam/titanic-top-4-with-ensemble-modeling" target="_blank">https://www.kaggle.com/yassineghouzam/titanic-top-4-with-ensemble-modeling</a></li></ul><p><br /></p><h4 id="필수-패키지-import">필수 패키지 import</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span><span class="p">,</span> <span class="n">ExtraTreesClassifier</span><span class="p">,</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">learning_curve</span>

<span class="n">sns</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">style</span> <span class="o">=</span> <span class="s">'white'</span><span class="p">,</span> <span class="n">context</span> <span class="o">=</span> <span class="s">'notebook'</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s">'deep'</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h3 id="2-load-and-check-data">2. Load and check data</h3><hr /><h4 id="21-load-data">2.1 Load data</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/train.csv'</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/test.csv'</span><span class="p">)</span>
<span class="n">IDtest</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'PassengerId'</span><span class="p">]</span>
</pre></table></code></div></div><p><br /></p><h4 id="22-outlier-detection">2.2 Outlier detection</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">detect_outliers</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
        <span class="n">Q1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="mi">25</span><span class="p">)</span>
        <span class="n">Q3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="mi">75</span><span class="p">)</span>
        <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
        
        <span class="n">outlier_step</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
        <span class="n">outlier_list_col</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">Q1</span> <span class="o">-</span> <span class="n">outlier_step</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">Q3</span> <span class="o">+</span> <span class="n">outlier_step</span><span class="p">)].</span><span class="n">index</span>
        
        <span class="n">outlier_indices</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">outlier_list_col</span><span class="p">)</span>
        
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">outlier_indices</span><span class="p">)</span>
    <span class="n">multiple_outliers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">outlier_indices</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">multiple_outliers</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Outliers_to_drop</span> <span class="o">=</span> <span class="n">detect_outliers</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s">'Age'</span><span class="p">,</span> <span class="s">'SibSp'</span><span class="p">,</span> <span class="s">'Parch'</span><span class="p">,</span> <span class="s">'Fare'</span><span class="p">])</span>
</pre></table></code></div></div><ul><li><p>outlier는 예측에 극적인 영향을 미칠 수 있기 때문에 (퇴행 문제에 대해) 관리하기로 선택했다.</p></li><li><p>나는 Tukey 방법(Tukey JW, 1977)을 사용하여 분포 값(IQR)의 1 사분위수와 3 사분위수 사이의 범위를 정의하는 outlier를 검출했다. outlier란 피쳐 값이 (IQR +- 특이치 단계) 외부에 있는 행이다.</p></li><li><p>나는 숫자 값 특징(Age, SibSp, Sarch 및 Fair)에서 outlier를 검출하기로 결정했다. 그리고 outlier를 최소 두 개의 outlier가 있는 행으로 생각했다.</p></li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># outlier를 가지고 있는 행들
</span><span class="n">train</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Outliers_to_drop</span><span class="p">]</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>PassengerId<th>Survived<th>Pclass<th>Name<th>Sex<th>Age<th>SibSp<th>Parch<th>Ticket<th>Fare<th>Cabin<th>Embarked<tbody><tr><th>27<td>28<td>0<td>1<td>Fortune, Mr. Charles Alexander<td>male<td>19.0<td>3<td>2<td>19950<td>263.00<td>C23 C25 C27<td>S<tr><th>88<td>89<td>1<td>1<td>Fortune, Miss. Mabel Helen<td>female<td>23.0<td>3<td>2<td>19950<td>263.00<td>C23 C25 C27<td>S<tr><th>159<td>160<td>0<td>3<td>Sage, Master. Thomas Henry<td>male<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S<tr><th>180<td>181<td>0<td>3<td>Sage, Miss. Constance Gladys<td>female<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S<tr><th>201<td>202<td>0<td>3<td>Sage, Mr. Frederick<td>male<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S<tr><th>324<td>325<td>0<td>3<td>Sage, Mr. George John Jr<td>male<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S<tr><th>341<td>342<td>1<td>1<td>Fortune, Miss. Alice Elizabeth<td>female<td>24.0<td>3<td>2<td>19950<td>263.00<td>C23 C25 C27<td>S<tr><th>792<td>793<td>0<td>3<td>Sage, Miss. Stella Anna<td>female<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S<tr><th>846<td>847<td>0<td>3<td>Sage, Mr. Douglas Bullen<td>male<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S<tr><th>863<td>864<td>0<td>3<td>Sage, Miss. Dorothy Edith "Dolly"<td>female<td>NaN<td>8<td>2<td>CA. 2343<td>69.55<td>NaN<td>S</table></div><ul><li>10개의 outlier를 가지고 있는 행들 중 28, 89, 342는 fare가 너무 높고, 나머지 7명은 SibSp가 너무 높다</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># outlier 삭제
</span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">Outliers_to_drop</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">).</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h4 id="23-joining-train-and-test-set">2.3 joining train and test set</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">train_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span> <span class="p">[</span><span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">).</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>categorical 변환 중에 동일한 수의 형상을 얻기 위해 train 및 test dataset을 concat함.</li></ul><p><br /></p><h4 id="24-check-for-null-and-missing-values">2.4 check for null and missing values</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">)</span>

<span class="n">dataset</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>PassengerId       0
Survived        418
Pclass            0
Name              0
Sex               0
Age             256
SibSp             0
Parch             0
Ticket            0
Fare              1
Cabin          1007
Embarked          2
dtype: int64
</pre></table></code></div></div><ul><li>Age와 Cabin에 nan이 많음</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 881 entries, 0 to 880
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  881 non-null    int64  
 1   Survived     881 non-null    int64  
 2   Pclass       881 non-null    int64  
 3   Name         881 non-null    object 
 4   Sex          881 non-null    object 
 5   Age          711 non-null    float64
 6   SibSp        881 non-null    int64  
 7   Parch        881 non-null    int64  
 8   Ticket       881 non-null    object 
 9   Fare         881 non-null    float64
 10  Cabin        201 non-null    object 
 11  Embarked     879 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 82.7+ KB
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">train</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>PassengerId      0
Survived         0
Pclass           0
Name             0
Sex              0
Age            170
SibSp            0
Parch            0
Ticket           0
Fare             0
Cabin          680
Embarked         2
dtype: int64
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>PassengerId<th>Survived<th>Pclass<th>Name<th>Sex<th>Age<th>SibSp<th>Parch<th>Ticket<th>Fare<th>Cabin<th>Embarked<tbody><tr><th>0<td>1<td>0<td>3<td>Braund, Mr. Owen Harris<td>male<td>22.0<td>1<td>0<td>A/5 21171<td>7.2500<td>NaN<td>S<tr><th>1<td>2<td>1<td>1<td>Cumings, Mrs. John Bradley (Florence Briggs Th...<td>female<td>38.0<td>1<td>0<td>PC 17599<td>71.2833<td>C85<td>C<tr><th>2<td>3<td>1<td>3<td>Heikkinen, Miss. Laina<td>female<td>26.0<td>0<td>0<td>STON/O2. 3101282<td>7.9250<td>NaN<td>S<tr><th>3<td>4<td>1<td>1<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)<td>female<td>35.0<td>1<td>0<td>113803<td>53.1000<td>C123<td>S<tr><th>4<td>5<td>0<td>3<td>Allen, Mr. William Henry<td>male<td>35.0<td>0<td>0<td>373450<td>8.0500<td>NaN<td>S</table></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">train</span><span class="p">.</span><span class="n">dtypes</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>PassengerId      int64
Survived         int64
Pclass           int64
Name            object
Sex             object
Age            float64
SibSp            int64
Parch            int64
Ticket          object
Fare           float64
Cabin           object
Embarked        object
dtype: object
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">train</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>PassengerId<th>Survived<th>Pclass<th>Age<th>SibSp<th>Parch<th>Fare<tbody><tr><th>count<td>881.000000<td>881.000000<td>881.000000<td>711.000000<td>881.000000<td>881.000000<td>881.000000<tr><th>mean<td>446.713961<td>0.385925<td>2.307605<td>29.731603<td>0.455165<td>0.363224<td>31.121566<tr><th>std<td>256.617021<td>0.487090<td>0.835055<td>14.547835<td>0.871571<td>0.791839<td>47.996249<tr><th>min<td>1.000000<td>0.000000<td>1.000000<td>0.420000<td>0.000000<td>0.000000<td>0.000000<tr><th>25%<td>226.000000<td>0.000000<td>2.000000<td>20.250000<td>0.000000<td>0.000000<td>7.895800<tr><th>50%<td>448.000000<td>0.000000<td>3.000000<td>28.000000<td>0.000000<td>0.000000<td>14.454200<tr><th>75%<td>668.000000<td>1.000000<td>3.000000<td>38.000000<td>1.000000<td>0.000000<td>30.500000<tr><th>max<td>891.000000<td>1.000000<td>3.000000<td>80.000000<td>5.000000<td>6.000000<td>512.329200</table></div><p><br /></p><h3 id="3-feature-analysis">3. Feature analysis</h3><hr /><h3 id="31-numerical-values">3.1 Numerical values</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 상관관계 확인
</span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">train</span><span class="p">[[</span><span class="s">'Survived'</span><span class="p">,</span> <span class="s">'SibSp'</span><span class="p">,</span> <span class="s">'Parch'</span><span class="p">,</span> <span class="s">'Age'</span><span class="p">,</span> <span class="s">'Fare'</span><span class="p">]].</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s">'.2f'</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s">'coolwarm'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237344-1b6c9600-1fa8-11eb-9263-2de4f7c6feeb.png" /></p><ul><li>Fare만 survived에 상관관계가 있어보임 그렇다고, 다른 feature들이 유의미하지 않다는것은 아니기에 하나씩 살펴보자</li></ul><h4 id="sibsp">SibSp</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'SibSp'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s">'bar'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s">'muted'</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">'survival probability'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>C:\ProgramData\Anaconda3\lib\site-packages\seaborn\categorical.py:3669: UserWarning: The `factorplot` function has been renamed to `catplot`. The original name will be removed in a future release. Please update your code. Note that the default `kind` in `factorplot` (`'point'`) has changed `'strip'` in `catplot`.
  warnings.warn(msg)
C:\ProgramData\Anaconda3\lib\site-packages\seaborn\categorical.py:3675: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
  warnings.warn(msg, UserWarning)
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237350-1dcef000-1fa8-11eb-8966-661f127332b2.png" /></p><ul><li><p>형제/자매들이 많은 승객들은 생존할 기회가 적은 것 같다.</p></li><li><p>싱글 승객(0 SibSP) 또는 다른 두 사람(SibSP 1 또는 2)과 함께 생존할 수 있는 기회가 더 많음</p></li><li><p>이 관찰은 상당히 흥미로우며, 이러한 범주를 설명하는 새로운 특징을 고려할 수 있다.</p></li></ul><h4 id="parch">Parch</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'Parch'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s">'bar'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s">'muted'</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">'survival probability'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>C:\ProgramData\Anaconda3\lib\site-packages\seaborn\categorical.py:3669: UserWarning: The `factorplot` function has been renamed to `catplot`. The original name will be removed in a future release. Please update your code. Note that the default `kind` in `factorplot` (`'point'`) has changed `'strip'` in `catplot`.
  warnings.warn(msg)
C:\ProgramData\Anaconda3\lib\site-packages\seaborn\categorical.py:3675: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
  warnings.warn(msg, UserWarning)
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237353-1e678680-1fa8-11eb-8fb3-ce41ecb1ea1f.png" /></p><ul><li>핵가족은 독신(Parch 0), 중간(Parch 3,4), 대가족(Parch 5,6)보다 생존할 기회가 더 많다.</li><li>부모/자녀가 3명인 승객의 생존에 중요한 표준 편차가 있을 수 있음</li></ul><h4 id="age">Age</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">,</span> <span class="s">'Age'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237355-1f001d00-1fa8-11eb-9b4f-462b0d56044e.png" /></p><ul><li>나이 분포는 꼬리가 있는 분포, 어쩌면 가우스 분포인 것 같다.</li><li>우리는 생존자와 생존하지 않은 하위 인구에서 연령 분포가 같지 않다는 것을 알아챘다. 실제로 살아남은 젊은 승객에 해당하는 봉우리가 있다. 우리는 또한 60-80세 사이의 승객들이 덜 살아남았다는 것을 안다.</li><li>그래서 “나이”가 “생존”과 상관관계가 없다고 해도, 우리는 생존할 기회가 더 많거나 적은 승객들의 연령 범주가 있음을 알 수 있다.</li><li>아주 어린 승객들은 생존할 기회가 더 많은 것 같다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">][(</span><span class="n">train</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">notnull</span><span class="p">())],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'Red'</span><span class="p">,</span> <span class="n">shade</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">][(</span><span class="n">train</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">notnull</span><span class="p">())],</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">g</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'Blue'</span><span class="p">,</span> <span class="n">shade</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Age'</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Frequency'</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="s">'Not Survived'</span><span class="p">,</span> <span class="s">'Survived'</span><span class="p">])</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237356-1f98b380-1fa8-11eb-9ec7-24994fadc0bd.png" /></p><ul><li>두 그래프를 포개놓으니, 0~5세 아이들의 생존율이 높음을 알수 있었다</li></ul><h4 id="fare">Fare</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">].</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>1
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">"Fare"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"Fare"</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Fare"</span><span class="p">].</span><span class="n">median</span><span class="p">())</span>
</pre></table></code></div></div><ul><li>요금의 Null값은 중앙값으로 대체 하였다</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'m'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Skewness : %.2f'</span><span class="o">%</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">].</span><span class="n">skew</span><span class="p">()))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'best'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237359-1f98b380-1fa8-11eb-81b4-258ec53e8c90.png" /></p><ul><li>요금 분배는 매우 왜곡되어 있다. 이렇게 되면 크기가 조정되더라도 모형의 매우 높은 값이 초과될 수 있다.</li><li>이 경우 로그 기능으로 변환해 이 skew를 줄이는 것이 좋다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span> <span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="k">else</span> <span class="mi">0</span> <span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'b'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Skewness : %.2f'</span><span class="o">%</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">].</span><span class="n">skew</span><span class="p">()))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'best'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237363-20314a00-1fa8-11eb-84bc-a0fd48c91174.png" /></p><ul><li>로그 변환 후 왜도가 명확하게 감소함</li></ul><p><br /></p><h4 id="32-categorical-values">3.2 Categorical values</h4><h4 id="sex">Sex</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'Sex'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Survival Probability'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237364-20314a00-1fa8-11eb-970a-ad433291be10.png" /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">train</span><span class="p">[[</span><span class="s">'Sex'</span><span class="p">,</span><span class="s">'Survived'</span><span class="p">]].</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Sex'</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>Survived<tr><th>Sex<th><tbody><tr><th>female<td>0.747573<tr><th>male<td>0.190559</table></div><ul><li>남성이 여성보다 생존할 기회가 적다는 것은 명백하다.</li><li>그래서 Sex는 생존을 예측하는 데 중요한 역할을 할 수도 있다.</li><li>타이타닉 영화(1997년)를 본 사람들에게, 나는 우리 모두가 대피 중에 “여성과 아이들이 먼저”라는 문장을 기억할 것이라고 확신한다.</li></ul><h4 id="pclass">Pclass</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'Pclass'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s">'bar'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s">'muted'</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">'survival probability'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>C:\ProgramData\Anaconda3\lib\site-packages\seaborn\categorical.py:3669: UserWarning: The `factorplot` function has been renamed to `catplot`. The original name will be removed in a future release. Please update your code. Note that the default `kind` in `factorplot` (`'point'`) has changed `'strip'` in `catplot`.
  warnings.warn(msg)
C:\ProgramData\Anaconda3\lib\site-packages\seaborn\categorical.py:3675: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
  warnings.warn(msg, UserWarning)
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237366-20c9e080-1fa8-11eb-925d-2f46d5d5c8e1.png" /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'Pclass'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s">'Sex'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s">'bar'</span><span class="p">,</span> <span class="n">palette</span> <span class="o">=</span> <span class="s">'muted'</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">'survival probability'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237368-20c9e080-1fa8-11eb-91df-0e8935ce0bb4.png" /></p><ul><li>승객 생존은 3개 등급에서 같지 않다. 일등석 승객은 이등석, 삼등석 승객보다 생존 기회가 더 많다.</li><li>이러한 경향은 남녀 승객 모두를 볼 때 보존된다.</li></ul><h4 id="embarked">Embarked</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>2
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="s">'S'</span><span class="p">)</span>
</pre></table></code></div></div><ul><li>2개의 null값은 가장 많은 항구인 S로 넣음</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"Embarked"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span>  <span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span>
                   <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">"muted"</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"survival probability"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237370-21627700-1fa8-11eb-8c5c-3299242d777c.png" /></p><ul><li>체르부르(C)에서 오는 승객의 생존 기회가 더 많아진 것으로 보인다.</li><li>내 가설은 1등석 승객의 비율이 퀸스타운(Q), 사우샘프턴(S)보다 더 높다는 것이다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="s">"Pclass"</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">"Embarked"</span><span class="p">,</span>  <span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span>
                   <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"count"</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">"muted"</span><span class="p">)</span>
<span class="n">g</span><span class="p">.</span><span class="n">despine</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"Count"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237372-21627700-1fa8-11eb-9000-a8e7e79dadbd.png" /></p><ul><li>실제로 사우샘프턴(S)과 퀸스타운(Q)에서 오는 승객이 3등급을 가장 많이 타는 반면, 체르부르크 승객은 대부분 생존율이 가장 높은 1등석을 타고 있다.</li><li>현시점에서 일등석의 생존율이 높은 이유를 설명할 수 없다. 나의 가설은 1등석 승객들이 그들의 영향 때문에 대피하는 동안 우선순위가 결정되었다는 것이다.</li></ul><p><br /></p><h3 id="4-filling-missing-values">4. Filling missing Values</h3><hr /><h4 id="41-age">4.1 Age</h4><ul><li>보시다시피 Age 열에는 전체 데이터 집합에 256개의 결측값이 포함되어 있다.</li><li>(예를 들어) 생존 기회가 더 많은 하위인구(0세 ~ 5세)가 있기 때문에 연령 특징을 유지하고 누락된 가치를 귀속시키는 것이 바람직하다.</li><li>이 문제를 해결하기 위해 나는 에이지(Sex, Parch, Pclass, SibSP)와 가장 상관관계가 있는 특징을 살펴보았다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Sex'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'box'</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Sex'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'box'</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Parch'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'box'</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'Age'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'SibSp'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">'box'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237373-21fb0d80-1fa8-11eb-81a1-31bb56a253bc.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237374-21fb0d80-1fa8-11eb-9c7c-af7a3ae78d14.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237375-2293a400-1fa8-11eb-9a38-1671a6942288.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237377-232c3a80-1fa8-11eb-91aa-02bac0e5820d.png" /></p><ul><li>남녀 하위집단에서 연령 분포가 동일한 것 같아 성별은 나이를 예측하는 데 도움이 되지 않는다.</li><li>그러나 1등석 승객은 2등석 승객보다 나이가 많고 3등석 승객보다 나이가 많다.</li><li>더욱이, 승객은 나이가 많을수록 부모/자식을 더 많이 가지고 있고, 동생/여동생을 더 많이 가지고 있다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 성별을 categorical로 분류
</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Sex'</span><span class="p">].</span><span class="nb">map</span><span class="p">({</span><span class="s">'male'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">'female'</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span> <span class="s">'Sex'</span><span class="p">,</span> <span class="s">'SibSp'</span><span class="p">,</span> <span class="s">'Parch'</span><span class="p">,</span> <span class="s">'Pclass'</span><span class="p">]].</span><span class="n">corr</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'summer_r'</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237380-232c3a80-1fa8-11eb-8a64-771e895de98c.png" /></p><ul><li>correlation map은 Parch를 제외한 인자 그림 관측치를 확인한다. Age는 Sex와는 상관관계가 없지만, Pclass, Parch, SibSp와 부정적으로 상관관계가 있다.</li><li>Age는 부모/자녀 수와 함께 성장하고 있다. 그러나 일반적인 상관관계는 부정적이다.</li><li>그래서 나는 SibSP, Parch, Pclass를 사용하여 Null Age을 귀속시키기로 결정했다.</li><li>Pclass, Parch, SibSp에 따라 비슷한 행의 중위연령으로 Age를 채우는 전략이다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="c1"># Filling missing value of Age
</span>
<span class="c1"># Fill Age with the median age of similar rows according to Pclass, Parch and SibSp
# Index of NaN age rows
</span>
<span class="n">index_NaN_age</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Age'</span><span class="p">][</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()].</span><span class="n">index</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index_NaN_age</span><span class="p">:</span>
    <span class="n">age_med</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">median</span><span class="p">()</span>
    <span class="n">age_pred</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Age'</span><span class="p">][((</span><span class="n">dataset</span><span class="p">[</span><span class="s">'SibSp'</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'SibSp'</span><span class="p">])</span> <span class="o">&amp;</span> 
                                <span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Parch'</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'Parch'</span><span class="p">])</span> <span class="o">&amp;</span> 
                                <span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">]</span> <span class="o">==</span> <span class="n">dataset</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'Pclass'</span><span class="p">]))].</span><span class="n">median</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="p">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">age_pred</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_pred</span>
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">dataset</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_med</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">"Age"</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"box"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">"Age"</span><span class="p">,</span><span class="n">data</span> <span class="o">=</span> <span class="n">train</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s">"violin"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237381-23c4d100-1fa8-11eb-8d4e-9dcc46036859.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237383-23c4d100-1fa8-11eb-902f-3be7f2b3ddc1.png" /></p><ul><li>연령의 중위수 값과 하위 모집단에서의 중위수 사이의 차이는 없었다.</li><li>그러나 생존한 승객들의 violin plot에서 우리는 여전히 매우 어린 승객들이 더 높은 생존율을 가지고 있다는 것을 알아차린다.</li></ul><p><br /></p><h3 id="5-feature-engineering">5. Feature engineering</h3><hr /><h4 id="51-name--title">5.1 Name / Title</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Name'</span><span class="p">].</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0                              Braund, Mr. Owen Harris
1    Cumings, Mrs. John Bradley (Florence Briggs Th...
2                               Heikkinen, Miss. Laina
3         Futrelle, Mrs. Jacques Heath (Lily May Peel)
4                             Allen, Mr. William Henry
Name: Name, dtype: object
</pre></table></code></div></div><ul><li>이름 기능에는 승객의 제목에 대한 정보가 포함되어 있다.</li><li>이름이 다른 승객은 대피하는데 선호될수 있다</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># get title from name
</span><span class="n">dataset_title</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]]</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dataset_title</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'Title'</span><span class="p">].</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0      Mr
1     Mrs
2    Miss
3     Mrs
4      Mr
Name: Title, dtype: object
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'Title'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">setp</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">45</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237384-245d6780-1fa8-11eb-9994-356b2f77e95c.png" /></p><ul><li>데이터 집합에는 17개의 제목이 있는데, 대부분은 몇개 없다 우리는 4개의 카테고리로 분류할 수 있다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># Convert to categorical values Title
</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">].</span><span class="n">replace</span><span class="p">(</span>
    <span class="p">[</span><span class="s">'Lady'</span><span class="p">,</span> <span class="s">'the Countess'</span><span class="p">,</span> <span class="s">'Countess'</span><span class="p">,</span> <span class="s">'Capt'</span><span class="p">,</span> <span class="s">'Col'</span><span class="p">,</span> <span class="s">'Don'</span><span class="p">,</span> <span class="s">'Dr'</span><span class="p">,</span> <span class="s">'Major'</span><span class="p">,</span> <span class="s">'Rev'</span><span class="p">,</span> <span class="s">'Sir'</span><span class="p">,</span> <span class="s">'Jonkheer'</span><span class="p">,</span> <span class="s">'Dona'</span><span class="p">],</span> <span class="s">'Rare'</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span>
    <span class="p">{</span><span class="s">"Master"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"Miss"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"Ms"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"Mme"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"Mlle"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"Mrs"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"Mr"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">"Rare"</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Title"</span><span class="p">])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s">"Master"</span><span class="p">,</span><span class="s">"Miss/Ms/Mme/Mlle/Mrs"</span><span class="p">,</span><span class="s">"Mr"</span><span class="p">,</span><span class="s">"Rare"</span><span class="p">])</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237386-24f5fe00-1fa8-11eb-96a8-877183e5815f.png" /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"Title"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s">"Master"</span><span class="p">,</span><span class="s">"Miss-Mrs"</span><span class="p">,</span><span class="s">"Mr"</span><span class="p">,</span><span class="s">"Rare"</span><span class="p">])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"survival probability"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237388-24f5fe00-1fa8-11eb-840b-016eaf05558e.png" /></p><ul><li>“여자와 아이들이 먼저”</li><li>희귀한 title 을 가진 승객들이 생존할 수 있는 기회가 더 많다는 점은 흥미롭다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Drop Name variable
</span><span class="n">dataset</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Name"</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h4 id="52-family-size">5.2 Family size</h4><ul><li>우리는 대가족들이 대피하는 동안 그들의 자매/형제/부모를 찾으면서 대피하는 데 더 많은 어려움을 겪을 것이라고 상상할 수 있다. 그래서, 나는 SibSp , Parch 그리고 1 (승객 포함)의 합인 “Fize” (가족 크기) 특징을 창조하기로 선택했다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># create a family size descriptor from SibSp, and Parch
</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Fsize'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'SibSp'</span><span class="p">]</span> <span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Parch'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">'Fsize'</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">'Survived'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">'Survival Probability'</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237389-258e9480-1fa8-11eb-9fa8-f2c4fb320b18.png" /></p><ul><li>가족의 크기가 중요한 역할을 하는 것 같은데, 대가족에게는 생존 확률이 가장 낮다.</li><li>4개의 가족사이즈를 만들기로 결심했다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># create new feature of family size
</span><span class="n">dataset</span><span class="p">[</span><span class="s">'Single'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Fsize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span> <span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span> <span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'SmallF'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Fsize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span> <span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="mi">0</span> <span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'MedF'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Fsize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span> <span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="mi">3</span> <span class="o">&lt;=</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">0</span> <span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'LargeF'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Fsize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span> <span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&gt;=</span> <span class="mi">5</span> <span class="k">else</span> <span class="mi">0</span> <span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"Single"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"Survival Probability"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"SmallF"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"Survival Probability"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"MedF"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"Survival Probability"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"LargeF"</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"Survival Probability"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237393-26272b00-1fa8-11eb-8284-9ddcdf908c4d.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237395-26272b00-1fa8-11eb-9840-af91fa9b2bc3.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237397-26bfc180-1fa8-11eb-8094-e895cd869e4b.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237398-26bfc180-1fa8-11eb-92e7-a3b9f5181cec.png" /></p><ul><li>Family size plot은 중소 가족이 단일 승객이나 대가족보다 생존할 기회가 더 많다는 것을 보여준다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># convert to indicator values Title and Embarked 
</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s">'Title'</span><span class="p">])</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="s">'Embarked'</span><span class="p">],</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s">'Em'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>PassengerId<th>Survived<th>Pclass<th>Sex<th>Age<th>SibSp<th>Parch<th>Ticket<th>Fare<th>Cabin<th>...<th>SmallF<th>MedF<th>LargeF<th>Title_0<th>Title_1<th>Title_2<th>Title_3<th>Em_C<th>Em_Q<th>Em_S<tbody><tr><th>0<td>1<td>0.0<td>3<td>0<td>22.0<td>1<td>0<td>A/5 21171<td>1.981001<td>NaN<td>...<td>1<td>0<td>0<td>0<td>0<td>1<td>0<td>0<td>0<td>1<tr><th>1<td>2<td>1.0<td>1<td>1<td>38.0<td>1<td>0<td>PC 17599<td>4.266662<td>C85<td>...<td>1<td>0<td>0<td>0<td>1<td>0<td>0<td>1<td>0<td>0<tr><th>2<td>3<td>1.0<td>3<td>1<td>26.0<td>0<td>0<td>STON/O2. 3101282<td>2.070022<td>NaN<td>...<td>0<td>0<td>0<td>0<td>1<td>0<td>0<td>0<td>0<td>1<tr><th>3<td>4<td>1.0<td>1<td>1<td>35.0<td>1<td>0<td>113803<td>3.972177<td>C123<td>...<td>1<td>0<td>0<td>0<td>1<td>0<td>0<td>0<td>0<td>1<tr><th>4<td>5<td>0.0<td>3<td>0<td>35.0<td>0<td>0<td>373450<td>2.085672<td>NaN<td>...<td>0<td>0<td>0<td>0<td>0<td>1<td>0<td>0<td>0<td>1</table><p>5 rows × 22 columns</p></div><ul><li>지금까지 23개의 features가 있음</li></ul><h4 id="53-cabin">5.3 Cabin</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">].</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0     NaN
1     C85
2     NaN
3    C123
4     NaN
Name: Cabin, dtype: object
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">"Cabin"</span><span class="p">].</span><span class="n">describe</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>count     292
unique    186
top        G6
freq        5
Name: Cabin, dtype: object
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">"Cabin"</span><span class="p">].</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>1007
</pre></table></code></div></div><ul><li>Cabin 열에는 292개의 값과 1007개의 결측값이 포함되어 있다.</li><li>객실 없는 승객은 객실 번호 대신 누락된 값이 표시되어 있는 줄 알았는데.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">"Cabin"</span><span class="p">][</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Cabin"</span><span class="p">].</span><span class="n">notnull</span><span class="p">()].</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>1      C85
3     C123
6      E46
10      G6
11    C103
Name: Cabin, dtype: object
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Replace the Cabin number by the type of cabin 'X' if not
</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Cabin"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="p">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">else</span> <span class="s">'X'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataset</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">]</span> <span class="p">])</span>
</pre></table></code></div></div><ul><li>선실의 첫 번째 글자는 데스크를 가리키며, 타이타닉호에서 승객의 위치를 나타내기 때문에 나는 이 정보만을 보관하기로 선택했다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Cabin"</span><span class="p">],</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">,</span><span class="s">'C'</span><span class="p">,</span><span class="s">'D'</span><span class="p">,</span><span class="s">'E'</span><span class="p">,</span><span class="s">'F'</span><span class="p">,</span><span class="s">'G'</span><span class="p">,</span><span class="s">'T'</span><span class="p">,</span><span class="s">'X'</span><span class="p">])</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237400-27585800-1fa8-11eb-9b98-c616417fe689.png" /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">factorplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s">"Cabin"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="s">"bar"</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">,</span><span class="s">'C'</span><span class="p">,</span><span class="s">'D'</span><span class="p">,</span><span class="s">'E'</span><span class="p">,</span><span class="s">'F'</span><span class="p">,</span><span class="s">'G'</span><span class="p">,</span><span class="s">'T'</span><span class="p">,</span><span class="s">'X'</span><span class="p">])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s">"Survival Probability"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237401-27585800-1fa8-11eb-9147-97861c2e9498.png" /></p><ul><li>객실이 있는 승객의 수가 적기 때문에 생존 확률은 중요한 표준 편차를 가지고 있고 우리는 다른 desk에 있는 승객의 생존 확률을 구별할 수 없다.</li><li>그러나 우리는 객실을 가진 승객들이 (X)가 없는 승객들보다 일반적으로 생존할 기회가 더 많다는 것을 알 수 있다.</li><li>특히 객실 B, C, D, E, F에 해당된다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Cabin'</span><span class="p">],</span> <span class="n">prefix</span> <span class="o">=</span> <span class="s">'Cabin'</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h4 id="54-ticket">5.4 Ticket</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">[</span><span class="s">'Ticket'</span><span class="p">].</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0           A/5 21171
1            PC 17599
2    STON/O2. 3101282
3              113803
4              373450
Name: Ticket, dtype: object
</pre></table></code></div></div><ul><li>그것은 같은 접두사를 공유하는 티켓이 함께 배치된 선실에 예약될 수 있다는 것을 의미할 수 있다. 따라서 그것은 배 안에 선실을 실제로 배치하는 것으로 이어질 수 있다.</li><li>동일한 접두사를 가진 티켓은 등급과 생존이 유사할 수 있다.</li><li>그래서 나는 티켓 기능 열을 티켓 접두사로 바꾸기로 결정했다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">Ticket</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dataset</span><span class="p">.</span><span class="n">Ticket</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">i</span><span class="p">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">Ticket</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'.'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ticket</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'X'</span><span class="p">)</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'Ticket'</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ticket</span>
<span class="n">dataset</span><span class="p">[</span><span class="s">'Ticket'</span><span class="p">].</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>0        A5
1        PC
2    STONO2
3         X
4         X
Name: Ticket, dtype: object
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Ticket"</span><span class="p">],</span> <span class="n">prefix</span><span class="o">=</span><span class="s">"T"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># Create categorical values for Pclass
</span><span class="n">dataset</span><span class="p">[</span><span class="s">"Pclass"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s">"Pclass"</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">"category"</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Pclass"</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="s">"Pc"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Drop useless variables 
</span><span class="n">dataset</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">"PassengerId"</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dataset</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><div style="width:100%; height:200px; overflow:auto"><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>Survived<th>Sex<th>Age<th>SibSp<th>Parch<th>Fare<th>Fsize<th>Single<th>SmallF<th>MedF<th>...<th>T_STONO<th>T_STONO2<th>T_STONOQ<th>T_SWPP<th>T_WC<th>T_WEP<th>T_X<th>Pc_1<th>Pc_2<th>Pc_3<tbody><tr><th>0<td>0.0<td>0<td>22.0<td>1<td>0<td>1.981001<td>2<td>0<td>1<td>0<td>...<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>1<tr><th>1<td>1.0<td>1<td>38.0<td>1<td>0<td>4.266662<td>2<td>0<td>1<td>0<td>...<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>1<td>0<td>0<tr><th>2<td>1.0<td>1<td>26.0<td>0<td>0<td>2.070022<td>1<td>1<td>0<td>0<td>...<td>0<td>1<td>0<td>0<td>0<td>0<td>0<td>0<td>0<td>1<tr><th>3<td>1.0<td>1<td>35.0<td>1<td>0<td>3.972177<td>2<td>0<td>1<td>0<td>...<td>0<td>0<td>0<td>0<td>0<td>0<td>1<td>1<td>0<td>0<tr><th>4<td>0.0<td>0<td>35.0<td>0<td>0<td>2.085672<td>1<td>1<td>0<td>0<td>...<td>0<td>0<td>0<td>0<td>0<td>0<td>1<td>0<td>0<td>1</table><p>5 rows × 67 columns</p></div><p><br /></p><h3 id="6modeling">6.Modeling</h3><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">## Separate train dataset and test dataset
</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:</span><span class="n">train_len</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">train_len</span><span class="p">:]</span>
<span class="n">test</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s">"Survived"</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">## Separate train features and label 
</span>
<span class="n">train</span><span class="p">[</span><span class="s">"Survived"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">"Survived"</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">Y_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">"Survived"</span><span class="p">]</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Survived"</span><span class="p">],</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h4 id="61-simple-modeling">6.1 Simple modeling</h4><h4 id="611-cross-validate-models">6.1.1 Cross validate models</h4><ul><li>popular classifier 10개 을 비교하고 층화된 kfold 교차 검증 절차를 통해 각각의 평균 정확도를 평가할것이다.<ul><li>SVC</li><li>Decision Tree</li><li>AdaBoost</li><li>Random Forest</li><li>Extra Trees</li><li>Gradient Boosting</li><li>Multiple layer perceprton (neural network)</li><li>KNN</li><li>Logistic regression</li><li>Linear Discriminant Analysis</li></ul></li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># Cross validate model with Kfold stratified cross val
</span><span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="n">random_state</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">classifiers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">),</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ExtraTreesClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">MLPClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">KNeighborsClassifier</span><span class="p">())</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">))</span>
<span class="n">classifiers</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">LinearDiscriminantAnalysis</span><span class="p">())</span>

<span class="n">cv_results</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">classifier</span> <span class="ow">in</span> <span class="n">classifiers</span><span class="p">:</span>
    <span class="n">cv_results</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
                                      <span class="n">y</span><span class="o">=</span><span class="n">Y_train</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>

<span class="n">cv_means</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">cv_std</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">cv_result</span> <span class="ow">in</span> <span class="n">cv_results</span><span class="p">:</span>
    <span class="n">cv_means</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv_result</span><span class="p">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="n">cv_std</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv_result</span><span class="p">.</span><span class="n">std</span><span class="p">())</span>

<span class="n">cv_res</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"CrossValMeans"</span><span class="p">:</span> <span class="n">cv_means</span><span class="p">,</span> <span class="s">"CrossValerrors"</span><span class="p">:</span> <span class="n">cv_std</span><span class="p">,</span> <span class="s">"Algorithm"</span><span class="p">:</span> <span class="p">[</span><span class="s">"SVC"</span><span class="p">,</span> <span class="s">"DecisionTree"</span><span class="p">,</span> <span class="s">"AdaBoost"</span><span class="p">,</span>
                                                                                          <span class="s">"RandomForest"</span><span class="p">,</span> <span class="s">"ExtraTrees"</span><span class="p">,</span> <span class="s">"GradientBoosting"</span><span class="p">,</span> <span class="s">"MultipleLayerPerceptron"</span><span class="p">,</span> <span class="s">"KNeighboors"</span><span class="p">,</span> <span class="s">"LogisticRegression"</span><span class="p">,</span> <span class="s">"LinearDiscriminantAnalysis"</span><span class="p">]})</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="s">"CrossValMeans"</span><span class="p">,</span> <span class="s">"Algorithm"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cv_res</span><span class="p">,</span>
                <span class="n">palette</span><span class="o">=</span><span class="s">"Set3"</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s">"h"</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s">'xerr'</span><span class="p">:</span> <span class="n">cv_std</span><span class="p">})</span>
<span class="n">g</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Mean Accuracy"</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Cross validation scores"</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237403-27f0ee80-1fa8-11eb-9aad-5da3880bf1e3.png" /></p><ul><li>앙상블 모델링을 위해 SVC, AdaBoost, Random Forest , ExtraTree, 그리고 GradientBoosting 분류기를 선택하기로 결정했다.</li></ul><p><br /></p><h4 id="612-hyperparameter-tunning-for-best-models">6.1.2 Hyperparameter tunning for best models</h4><ul><li>AdaBoost, ExtraTree, RandomForest, GradientBoosting 및 SVC 분류기에 대한 그리드 검색 최적화를 수행했다.</li><li>나는 4개의 cpu가 있기 때문에 “n_jobs” 파라미터를 4로 설정했다. 계산 시간이 분명히 단축되었다.</li><li>notebook에는 n_jobs를 4로 설정하였지만, 여기서는 -1로 하겠음</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1"># Adaboost
</span><span class="n">DTC</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>

<span class="n">adaDTC</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">DTC</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

<span class="n">ada_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">"base_estimator__criterion"</span><span class="p">:</span> <span class="p">[</span><span class="s">"gini"</span><span class="p">,</span> <span class="s">"entropy"</span><span class="p">],</span>
                  <span class="s">"base_estimator__splitter"</span><span class="p">:</span>   <span class="p">[</span><span class="s">"best"</span><span class="p">,</span> <span class="s">"random"</span><span class="p">],</span>
                  <span class="s">"algorithm"</span><span class="p">:</span> <span class="p">[</span><span class="s">"SAMME"</span><span class="p">,</span> <span class="s">"SAMME.R"</span><span class="p">],</span>
                  <span class="s">"n_estimators"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                  <span class="s">"learning_rate"</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]}</span>

<span class="n">gsadaDTC</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">adaDTC</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">ada_param_grid</span><span class="p">,</span>
                        <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gsadaDTC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>

<span class="n">ada_best</span> <span class="o">=</span> <span class="n">gsadaDTC</span><span class="p">.</span><span class="n">best_estimator_</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Fitting 10 folds for each of 112 candidates, totalling 1120 fits


[Parallel(n_jobs=-1)]: Using backend LokyBackend with 12 concurrent workers.
[Parallel(n_jobs=-1)]: Done  26 tasks      | elapsed:    2.4s
[Parallel(n_jobs=-1)]: Done 664 tasks      | elapsed:    3.7s
[Parallel(n_jobs=-1)]: Done 1120 out of 1120 | elapsed:    4.4s finished
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">gsadaDTC</span><span class="p">.</span><span class="n">best_score_</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0.82073544433095
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1">#ExtraTrees 
</span><span class="n">ExtC</span> <span class="o">=</span> <span class="n">ExtraTreesClassifier</span><span class="p">()</span>


<span class="c1">## Search grid for optimal parameters
</span><span class="n">ex_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">"max_depth"</span><span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">],</span>
              <span class="s">"max_features"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s">"min_samples_split"</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s">"min_samples_leaf"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
              <span class="s">"bootstrap"</span><span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">],</span>
              <span class="s">"n_estimators"</span> <span class="p">:[</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">],</span>
              <span class="s">"criterion"</span><span class="p">:</span> <span class="p">[</span><span class="s">"gini"</span><span class="p">]}</span>


<span class="n">gsExtC</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">ExtC</span><span class="p">,</span><span class="n">param_grid</span> <span class="o">=</span> <span class="n">ex_param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">"accuracy"</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">gsExtC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">)</span>

<span class="n">ExtC_best</span> <span class="o">=</span> <span class="n">gsExtC</span><span class="p">.</span><span class="n">best_estimator_</span>

<span class="c1"># Best score
</span><span class="n">gsExtC</span><span class="p">.</span><span class="n">best_score_</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>[Parallel(n_jobs=-1)]: Using backend LokyBackend with 12 concurrent workers.


Fitting 10 folds for each of 54 candidates, totalling 540 fits


[Parallel(n_jobs=-1)]: Done  26 tasks      | elapsed:    1.2s
[Parallel(n_jobs=-1)]: Done 176 tasks      | elapsed:    6.5s
[Parallel(n_jobs=-1)]: Done 426 tasks      | elapsed:   16.4s
[Parallel(n_jobs=-1)]: Done 540 out of 540 | elapsed:   21.0s finished





0.8308733401430031
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c1"># RFC
</span><span class="n">RFC</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>

<span class="n">rf_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'max_depth'</span> <span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">],</span>
                <span class="s">'max_features'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                <span class="s">'min_samples_split'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                <span class="s">'min_samples_leaf'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
                <span class="s">'bootstrap'</span> <span class="p">:</span> <span class="p">[</span><span class="bp">False</span><span class="p">],</span>
                <span class="s">'n_estimators'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">300</span><span class="p">],</span>
                <span class="s">'criterion'</span> <span class="p">:[</span><span class="s">'gini'</span><span class="p">]}</span>

<span class="n">gsRFC</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">RFC</span><span class="p">,</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="n">rf_param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">gsRFC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">RFC_best</span> <span class="o">=</span> <span class="n">gsRFC</span><span class="p">.</span><span class="n">best_estimator_</span>

<span class="c1">#bset score
</span><span class="n">gsRFC</span><span class="p">.</span><span class="n">best_score_</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Fitting 10 folds for each of 54 candidates, totalling 540 fits


[Parallel(n_jobs=-1)]: Using backend LokyBackend with 12 concurrent workers.
[Parallel(n_jobs=-1)]: Done  26 tasks      | elapsed:    3.5s
[Parallel(n_jobs=-1)]: Done 176 tasks      | elapsed:    8.8s
[Parallel(n_jobs=-1)]: Done 426 tasks      | elapsed:   19.1s
[Parallel(n_jobs=-1)]: Done 540 out of 540 | elapsed:   24.4s finished





0.8365806945863126
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1"># Gradient boosting
</span>
<span class="n">GBC</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">()</span>
<span class="n">gb_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'loss'</span> <span class="p">:</span> <span class="p">[</span><span class="s">'deviance'</span><span class="p">],</span>
                <span class="s">'n_estimators'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
                <span class="s">'learning_rate'</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
                <span class="s">'max_depth'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                <span class="s">'min_samples_leaf'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">],</span>
                <span class="s">'max_features'</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]}</span>

<span class="n">gsGBC</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">GBC</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span> <span class="n">gb_param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span> <span class="s">'accuracy'</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">gsGBC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">GBC_best</span> <span class="o">=</span> <span class="n">gsGBC</span><span class="p">.</span><span class="n">best_estimator_</span>
<span class="n">gsGBC</span><span class="p">.</span><span class="n">best_score_</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Fitting 10 folds for each of 72 candidates, totalling 720 fits


[Parallel(n_jobs=-1)]: Using backend LokyBackend with 12 concurrent workers.
[Parallel(n_jobs=-1)]: Done  26 tasks      | elapsed:    2.8s
[Parallel(n_jobs=-1)]: Done 176 tasks      | elapsed:    5.5s
[Parallel(n_jobs=-1)]: Done 426 tasks      | elapsed:    9.7s
[Parallel(n_jobs=-1)]: Done 720 out of 720 | elapsed:   14.6s finished





0.8331460674157304
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="c1"># SVC
</span><span class="n">SVMC</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">svc_param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s">'kernel'</span> <span class="p">:</span> <span class="p">[</span><span class="s">'rbf'</span><span class="p">],</span>
                 <span class="s">'gamma'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="s">'C'</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]}</span>
<span class="n">gsSVMC</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVMC</span><span class="p">,</span> <span class="n">param_grid</span> <span class="o">=</span> <span class="n">svc_param_grid</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">kfold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s">'accuracy'</span><span class="p">,</span> <span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">gsSVMC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">SVMC_best</span> <span class="o">=</span> <span class="n">gsSVMC</span><span class="p">.</span><span class="n">best_estimator_</span>
<span class="n">gsSVMC</span><span class="p">.</span><span class="n">best_score_</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Fitting 10 folds for each of 28 candidates, totalling 280 fits


[Parallel(n_jobs=-1)]: Using backend LokyBackend with 12 concurrent workers.
[Parallel(n_jobs=-1)]: Done  26 tasks      | elapsed:    0.8s
[Parallel(n_jobs=-1)]: Done 176 tasks      | elapsed:    5.4s
[Parallel(n_jobs=-1)]: Done 280 out of 280 | elapsed:   10.1s finished

0.8331332992849847
</pre></table></code></div></div><p><br /></p><h4 id="613-plot-learning-curves">6.1.3 Plot learning curves</h4><ul><li>학습 곡선은 훈련 세트에 대한 오버핏 효과와 훈련 크기가 정확도에 미치는 영향을 확인할 수 있는 좋은 방법이다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">plot_learning_curve</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">train_sizes</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(.</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Training examples'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Score'</span><span class="p">)</span>
    <span class="n">train_sizes</span><span class="p">,</span> <span class="n">train_scores</span><span class="p">,</span> <span class="n">test_scores</span> <span class="o">=</span> <span class="n">learning_curve</span><span class="p">(</span>
        <span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">train_sizes</span><span class="o">=</span><span class="n">train_sizes</span><span class="p">)</span>
    <span class="n">train_score_mean</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_scores</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">train_score_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">train_scores</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_score_mean</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">test_scores</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_score_std</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">std</span><span class="p">(</span><span class="n">test_scores</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">train_sizes</span><span class="p">,</span> <span class="n">train_score_mean</span> <span class="o">-</span> <span class="n">train_score_std</span><span class="p">,</span> <span class="n">train_score_mean</span> <span class="o">+</span> <span class="n">train_score_std</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">train_sizes</span><span class="p">,</span> <span class="n">test_score_mean</span> <span class="o">-</span> <span class="n">test_score_std</span><span class="p">,</span> <span class="n">test_score_mean</span> <span class="o">+</span> <span class="n">test_score_std</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'g'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_sizes</span><span class="p">,</span> <span class="n">train_score_mean</span><span class="p">,</span> <span class="s">'o-'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'r'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Training score'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_sizes</span><span class="p">,</span> <span class="n">test_score_mean</span><span class="p">,</span> <span class="s">'o-'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'g'</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">'Cross-validation score'</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s">'best'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plt</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">g</span> <span class="o">=</span> <span class="n">plot_learning_curve</span><span class="p">(</span><span class="n">gsRFC</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">,</span><span class="s">"RF mearning curves"</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plot_learning_curve</span><span class="p">(</span><span class="n">gsExtC</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">,</span><span class="s">"ExtraTrees learning curves"</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plot_learning_curve</span><span class="p">(</span><span class="n">gsSVMC</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">,</span><span class="s">"SVC learning curves"</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plot_learning_curve</span><span class="p">(</span><span class="n">gsadaDTC</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">,</span><span class="s">"AdaBoost learning curves"</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">plot_learning_curve</span><span class="p">(</span><span class="n">gsGBC</span><span class="p">.</span><span class="n">best_estimator_</span><span class="p">,</span><span class="s">"GradientBoosting learning curves"</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">cv</span><span class="o">=</span><span class="n">kfold</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237404-27f0ee80-1fa8-11eb-8bec-64c3d5db3066.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237406-28898500-1fa8-11eb-8fee-fd5f8fed4656.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237407-28898500-1fa8-11eb-958c-04cf1de0e1e6.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237408-29221b80-1fa8-11eb-977a-6c3c7f6d9ade.png" /> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237412-29221b80-1fa8-11eb-9500-11b22ef51a23.png" /></p><ul><li>GradientBoosting과 Adaboost 분류자는 훈련 세트에 오버핏하는 경향이 있다. 증가하는 교차 검증 곡선에 따르면 GradientBoosting과 Adaboost는 더 많은 훈련 사례를 통해 더 나은 성과를 낼 수 있다.</li><li>SVC와 ExtraTree 분류자는 훈련 곡선과 교차 검증 곡선이 서로 가깝기 때문에 예측을 더 잘 일반화하는 것으로 보인다.</li></ul><p><br /></p><h4 id="614-feature-importance-of-tree-based-classifiers">6.1.4 Feature importance of tree based classifiers</h4><ul><li>승객 생존 예측에 가장 유용한 기능을 보기 위해 4개의 트리 기반 분류기에 대한 기능 중요도를 표시했다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="n">nrows</span> <span class="o">=</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s">"all"</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>

<span class="n">names_classifiers</span> <span class="o">=</span> <span class="p">[(</span><span class="s">"AdaBoosting"</span><span class="p">,</span> <span class="n">ada_best</span><span class="p">),(</span><span class="s">"ExtraTrees"</span><span class="p">,</span><span class="n">ExtC_best</span><span class="p">),(</span><span class="s">"RandomForest"</span><span class="p">,</span><span class="n">RFC_best</span><span class="p">),(</span><span class="s">"GradientBoosting"</span><span class="p">,</span><span class="n">GBC_best</span><span class="p">)]</span>

<span class="n">nclassifier</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">names_classifiers</span><span class="p">[</span><span class="n">nclassifier</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">classifier</span> <span class="o">=</span> <span class="n">names_classifiers</span><span class="p">[</span><span class="n">nclassifier</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">classifier</span><span class="p">.</span><span class="n">feature_importances_</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">40</span><span class="p">]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">X_train</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="n">indices</span><span class="p">][:</span><span class="mi">40</span><span class="p">],</span><span class="n">x</span> <span class="o">=</span> <span class="n">classifier</span><span class="p">.</span><span class="n">feature_importances_</span><span class="p">[</span><span class="n">indices</span><span class="p">][:</span><span class="mi">40</span><span class="p">]</span> <span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s">'h'</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">])</span>
        <span class="n">g</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Relative importance"</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">g</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"Features"</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        <span class="n">g</span><span class="p">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">g</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">" feature importance"</span><span class="p">)</span>
        <span class="n">nclassifier</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237413-29bab200-1fa8-11eb-856a-b07cc448f942.png" /></p><ul><li>4개의 트리 기반 분류자(Adaboost, ExtraTree, RandomForest 및 GradientBoosting)에 대한 피쳐 중요도를 표시한다.</li><li>우리는 4개의 분류자가 상대적 중요도에 따라 상위 특징을 가지고 있다는 것을 주목한다. 이들의 예측이 같은 특징을 바탕으로 한 것이 아니라는 뜻이다. 그럼에도 불구하고, 그들은 분류에 대한 몇 가지 공통적인 중요한 특징들을 공유한다. 예를 들어, ‘Par’, ‘Title_2’, ‘Age’, ‘Sex’ 등이 그것이다.</li><li>Title_2는 Mrs/Mme/Miss/Ms 범주가 Sex와 높은 상관관계를 가지고 있음을 나타낸다.</li><li>우리는 다음과 같이 말할 수 있다.<ul><li>pc_1, pc_2, pc_3 및 운임은 승객의 일반적인 사회적 지위를 말한다.</li><li>Sex and Title_2(Mrs/Mlle/Mme/Miss/Ms)와 Title_3(Mr)은 성별을 가리킨다.</li><li>Age 및 Title_1(Master)은 승객의 나이를 말한다.</li><li>Fsize, LargeF, MedF, Single은 승객 가족의 크기를 가리킨다.</li></ul></li><li>이 4가지 분류기의 특징적인 중요성에 따라 생존 예측은 배 안의 위치보다 ‘나이’ ‘성’ ‘가족 규모’ ‘승객의 사회적 지위’와 더 관련이 있는 것으로 보인다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">test_Survived_RFC</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">RFC_best</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"RFC"</span><span class="p">)</span>
<span class="n">test_Survived_ExtC</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ExtC_best</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"ExtC"</span><span class="p">)</span>
<span class="n">test_Survived_SVMC</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">SVMC_best</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"SVC"</span><span class="p">)</span>
<span class="n">test_Survived_AdaC</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ada_best</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"Ada"</span><span class="p">)</span>
<span class="n">test_Survived_GBC</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">GBC_best</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"GBC"</span><span class="p">)</span>


<span class="c1"># Concatenate all classifier results
</span><span class="n">ensemble_results</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_Survived_RFC</span><span class="p">,</span><span class="n">test_Survived_ExtC</span><span class="p">,</span><span class="n">test_Survived_AdaC</span><span class="p">,</span><span class="n">test_Survived_GBC</span><span class="p">,</span> <span class="n">test_Survived_SVMC</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">g</span><span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">ensemble_results</span><span class="p">.</span><span class="n">corr</span><span class="p">(),</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/60168331/98237414-2a534880-1fa8-11eb-942a-39b6cd9dacba.png" /></p><ul><li>이 예측은 Adaboost 다른 분류자와 비교했을 때를 제외하고는 5개 분류자의 경우 상당히 유사한 것으로 보인다.</li><li>5개의 분류자는 거의 같은 예측을 하지만 약간의 차이가 있다. 5가지 분류자 예측 간의 차이점은 통합 투표를 고려하기에 충분하다.</li></ul><p><br /></p><h3 id="62-ensemble-modeling">6.2 Ensemble modeling</h3><h4 id="621-combining-models">6.2.1 Combining models</h4><ul><li>나는 5개의 분류자에서 나온 예측을 결합하기 위해 voting classifier를 선택했다.</li><li>나는 각 투표의 확률을 고려하기 위해 투표 매개변수에 “soft” 주장을 전달하는 것을 선호했다.</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># 각 모델별 베스트 파라미터를 뽑고, voting을 시킴
</span><span class="n">votingC</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s">'rfc'</span><span class="p">,</span> <span class="n">RFC_best</span><span class="p">),</span> <span class="p">(</span><span class="s">'extc'</span><span class="p">,</span> <span class="n">ExtC_best</span><span class="p">),</span>
<span class="p">(</span><span class="s">'svc'</span><span class="p">,</span> <span class="n">SVMC_best</span><span class="p">),</span> <span class="p">(</span><span class="s">'adac'</span><span class="p">,</span><span class="n">ada_best</span><span class="p">),(</span><span class="s">'gbc'</span><span class="p">,</span><span class="n">GBC_best</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s">'soft'</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">votingC</span> <span class="o">=</span> <span class="n">votingC</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><h3 id="63-prediction">6.3 Prediction</h3><h4 id="631-predict-and-submit-results">6.3.1 Predict and Submit results</h4><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">test_Survived</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">votingC</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">"Survived"</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">IDtest</span><span class="p">,</span><span class="n">test_Survived</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">results</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"result/03.ensemble_python_voting.csv"</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kaggle/'>Kaggle</a>, <a href='/categories/titanic/'>Titanic</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kaggle-transcription/" class="post-tag no-text-decoration" >Kaggle Transcription</a> <a href="/tags/titanic/" class="post-tag no-text-decoration" >Titanic</a> <a href="/tags/eda/" class="post-tag no-text-decoration" >EDA</a> <a href="/tags/sklearn/" class="post-tag no-text-decoration" >Sklearn</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=타이타닉 탑4% 앙상블 모델링 - Data Include Me&url=https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=타이타닉 탑4% 앙상블 모델링 - Data Include Me&u=https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=타이타닉 탑4% 앙상블 모델링 - Data Include Me&url=https://datainclude.me/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%83%914_%EC%95%99%EC%83%81%EB%B8%94_%EB%AA%A8%EB%8D%B8%EB%A7%81/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Panel on right side (Desktop views) v2.3 © 2024 Your Name MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li class="recent-item"> <a href="/posts/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85_%EA%B0%80%EC%83%81%ED%99%94/">클라우드 컴퓨팅 - 가상화</a> <span class="text-muted small">2024-10-28</span></li><li class="recent-item"> <a href="/posts/gemini_api_%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0/">Gemini API 사용해보기</a> <span class="text-muted small">2024-03-12</span></li><li class="recent-item"> <a href="/posts/Ollama%EC%99%80_Python_%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC_%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC_LLaMa2%EB%A5%BC_%EB%A1%9C%EC%BB%AC%EC%97%90%EC%84%9C_%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0/">Ollama와 Python 라이브러리를 이용하여 LLaMa2를 로컬에서 사용하기</a> <span class="text-muted small">2024-02-13</span></li><li class="recent-item"> <a href="/posts/Mistral_7B_Fine_Tuning/">Mistral 7B 파인튜닝(Fine Tuning)하기</a> <span class="text-muted small">2023-10-25</span></li><li class="recent-item"> <a href="/posts/Penn_Fudan%EC%9C%BC%EB%A1%9C_%EC%95%8C%EC%95%84%EB%B3%B4%EB%8A%94_%EA%B0%9D%EC%B2%B4_%ED%83%90%EC%A7%80_%EB%B6%84%ED%95%A0/">Penn-Fudan으로 알아보는 객체 탐지(Object Detection), 분할(Segmentation) with FasterRCNN</a> <span class="text-muted small">2023-10-23</span></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div><style> .recent-item { margin-bottom: 0.5rem; } .recent-item a { color: var(--link-color); } .recent-item .small { font-size: 0.75rem; margin-left: 0.5rem; }</style></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Recommend the other 3 posts according to the tags and categories of the current post, if the number is not enough, use the other latest posts to supplement. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%ED%83%80%EC%9D%B4%ED%83%80%EB%8B%89_%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC_with_Kaggle/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Sep 19, 2020 <i class="unloaded">2020-09-19T20:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>타이타닉 튜토리얼</h3><div class="text-muted small"><p> 타이타닉 튜토리얼 만약 데이터 사이언스, 머신러닝 또는 캐글에서 어떤 것을 해야하는 지 잘 모르는 newbie 라면, 타이타닉을 하시는 게 가장 좋은 선택입니다. 타이타닉은 아시다시피, 사상 최대 해난사고로써, 1,500여명의 희생자가 생겼습니다. 우리는 이 튜토리얼에서 타이타닉에 탑승한 사람들의 신상정보를 활용하여, 승선한 사람들의 생존...</p></div></div></a></div><div class="card"> <a href="/posts/Prediction%EC%9D%84_%EC%9C%84%ED%95%9C_Titanic_EDA/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Nov 5, 2020 <i class="unloaded">2020-11-05T00:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Prediction을 위한 Titanic EDA</h3><div class="text-muted small"><p> The sinking of the Titanic is one of the most infamous shipwrecks in history. On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out...</p></div></div></a></div><div class="card"> <a href="/posts/Data_Preparation_and_Exploration/"><div class="card-body"> <!-- Date format snippet v2.4.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <span class="timeago small" > Nov 9, 2020 <i class="unloaded">2020-11-09T00:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Porto Seguro’s Safe Driver Prediction 데이터 Preparation & Exploration</h3><div class="text-muted small"><p> 1. Porto Seguro Safe Driver Prediction 1.1 Porto Seguro Safe Driver Prediction Porto Seguro는 브라질의 자동차 보험회사로, 어떤 차주가 내년에 보험을 청구할지에 대한 예측을 하는것 https://www.kaggle.com/c/porto-seguro-safe-driver-...</p></div></div></a></div></div></div><!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Prediction%EC%9D%84_%EC%9C%84%ED%95%9C_Titanic_EDA/" class="btn btn-outline-primary"><p>Prediction을 위한 Titanic EDA</p></a> <a href="/posts/Data_Preparation_and_Exploration/" class="btn btn-outline-primary"><p>Porto Seguro’s Safe Driver Prediction 데이터 Preparation & Exploration</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tensorflow/">Tensorflow</a> <a class="post-tag" href="/tags/sklearn/">Sklearn</a> <a class="post-tag" href="/tags/round/">Round</a> <a class="post-tag" href="/tags/python-lv0/">Python Lv0</a> <a class="post-tag" href="/tags/pca/">PCA</a> <a class="post-tag" href="/tags/eda/">EDA</a> <a class="post-tag" href="/tags/distinct/">Distinct</a> <a class="post-tag" href="/tags/random-forest/">Random Forest</a> <a class="post-tag" href="/tags/beautifulsoup/">Beautifulsoup</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- The GA snippet v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://datainclude.me{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
