---
title: Retrieval-Augmented Generation (RAG, 검색-증강 생성)
author: HyunMin Kim
date: 2023-10-17 00:00:00 0000
categories: [Data Science, NLP]
tags: [RAG]
image: https://github.com/hmkim312/datas/assets/60168331/8fd8286b-b2a6-43dc-830e-f08f6d8839a1
---

RAG(Retrieval-Augmented Generation)는 LLM (Large Language Model)를 더 효과적으로 활용하는 방법론이다. RAG는 사전 훈련된 LLM의 장점을 외부 지식과 결합하여 제공한다. 기본 아이디어는 특정 질문이나 주제에 대한 응답을 생성할 때, 모델이 실시간으로 외부 지식을 참조하여 더 정확하고 풍부한 정보를 제공하는 것이다. 이로 인해 RAG는 기존의 언어 모델이 가진 한계를 극복하며, 특히 최신 정보나 복잡한 주제에 대한 질문에 대한 답변을 생성하는 데 있어 뛰어난 성능을 보인다.

<img src="https://github.com/hmkim312/datas/assets/60168331/f015b2c5-1ca3-4a1b-bea3-10156174d1bd" width=auto height=auto max-width=500>

## 1.RAG란 무엇인가?
RAG(Retrieval-Augmented Generation)는 최근 자연어 처리 분야에서 주목받는 기술이다. 이 기술의 핵심은 두 가지 주요 요소를 결합하는 것에 있다. 첫 번째 요소는 LLM이다. 이러한 모델은 대량의 텍스트 데이터를 학습하여 언어의 다양한 패턴과 구조를 이해한다. 두 번째 요소는 외부의 지식 저장소나 데이터베이스에 접근하는 능력이다.
일반적인 언어 모델만 사용할 때, 모델은 훈련 데이터에 포함된 정보만을 기반으로 응답을 생성한다. 그러나 RAG는 이러한 내장된 지식 외에도 실시간으로 외부 지식을 참고하여 답변을 더 정확하게 만든다. 예를 들어, 특정 역사적 사건에 대한 질문이 제기될 경우, RAG는 외부의 신뢰할 수 있는 지식 저장소에서 관련 정보를 검색하고, 그 정보를 기반으로 더욱 정확하고 상세한 답변을 생성할 수 있다.

## 2. 왜 RAG가 필요한가?
GPR-3처럼 대부분의 사전 훈련된 언어 모델은 `할루시네이션`이라는 문제를 가지고 있다. 할루시네이션은 모델이 사실이 아닌 정보나 잘못된 답변을 그럴듯 하게 생성하는 것을 의미한다. 이러한 할루시네이션은 모델이 훈련 데이터에만 의존하고, 실시간으로 외부 지식을 참조하지 않기 때문에 발생한다.

예를 들어, "2023년의 올림픽 개최 도시는 어디인가?"라는 질문에 대해, 2020년까지의 데이터로 훈련된 언어 모델은 정확한 답변을 제공할 수 없다. 하지만 RAG는 위키 백과와 같은 외부 지식 소스를 참조하여 최신 정보를 제공할 수 있다.

## 3. RAG의 작동 원리
RAG는 **검색기 (Retriever)**와 **생성기 (Generator)**로 두 가지 주요 구성 요소로 이루어져 있다. 이 두 구성 요소는 서로 상호 작용하며, 사용자의 질문에 대한 가장 관련성 있는 답변을 생성한다.

### 3.1 검색기 (Retriever)
- **역할**: 주어진 질문이나 입력에 대한 관련 정보나 문서를 외부 지식 소스에서 검색한다.
- **작동 방식**: 검색기는 주어진 질문을 벡터 공간에 매핑하고, 이 벡터를 사용하여 외부 지식 소스(예: 위키백과)의 문서들과의 유사도를 계산한뒤 가장 유사한 문서들을 선택하여 반환한다.

### 3.2 생성기 (Generator)
- **역할**: 검색기에서 반환된 정보와 주어진 입력을 기반으로 응답을 생성한다.
- **작동 방식**: 생성기는 사전 훈련된 언어 모델(예: BERT, T5, GPT-3 등)을 사용하여 검색된 문서와 주어진 질문을 결합하여 응답을 생성한다. 이때, 검색된 문서는 문맥 정보를 제공하고 모델은 이 정보를 활용하여 더 정확하고 풍부한 응답을 생성한다.

## 4. RAG의 장점
- 정확성: 외부 지식 소스를 참조하여 더 정확하고 사실적인 정보를 제공한다.
- 유연성: 다양한 주제나 질문에 대해 적절한 응답을 생성할 수 있다.
- 지속적인 학습: 외부 지식 소스가 업데이트되면 RAG도 그 정보를 활용하여 최신의 답변을 제공할 수 있다.

## 5. 결론
RAG는 자연어 처리 분야에서 중요한 부분이다. LLM들은 매우 높은 성능을 보이고 있지만, 그럼에도 불구하고 `할루시네이션`과 같은 한계와 문제점을 가지고 있다. 

RAG는 이러한 문제를 해결하는데 도움을 준다. LLM의 훈련 지식과 외부 지식 저장소의 정보를 동시에 활용하여 답변을 생성한다. 이로 인해 질문에 대한 답변이 더욱 정확하고 풍부해진다. 특히 최신의 정보나 복잡한 주제에 대한 질문에 대해, RAG는 실시간으로 외부 지식을 참조하여 최신과 가장 정확한 답변을 제공할 수 있는 장점이 있다.

또한, RAG는 지속적인 학습의 가능성을 제공한다. 외부 지식 소스가 업데이트되면, RAG도 그 정보를 활용하여 최신의 답변을 제공할 수 있게 된다. 이러한 특성은 RAG를 지속적으로 발전하고 성장하는 모델로 만들어준다.